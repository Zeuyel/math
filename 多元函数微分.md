---
tags:
  - 考研
  - math
  - cheatsheet
  - 大题
---

# 多元函数微分学

## 一、多元函数的极限、连续、可导、可微的概念辨析

### 1.1 多元函数的极限

**定义**：设函数 $f(x,y)$ 在点 $P_0(x_0,y_0)$ 的某个去心邻域内有定义，如果存在常数 $A$，使得对于任意给定的 $\epsilon > 0$，总存在 $\delta > 0$，当 $0 < \sqrt{(x-x_0)^2 + (y-y_0)^2} < \delta$ 时，恒有：

$$
|f(x,y) - A| < \epsilon
$$

则称 $A$ 为函数 $f(x,y)$ 当 $(x,y) \to (x_0,y_0)$ 时的极限，记作：

$$
\lim_{(x,y) \to (x_0,y_0)} f(x,y) = A
$$

**重点**：
- 多元函数极限要求从**任何路径**趋近于 $(x_0,y_0)$ 时，函数值都趋于同一个常数 $A$
- 证明极限**不存在**：只需找到两条不同的路径，使得沿这两条路径的极限值不同
- 证明极限**存在**：需要用定义证明，常用方法包括：
  - 不等式放缩（利用 $|x-x_0| \le \sqrt{(x-x_0)^2 + (y-y_0)^2}$）
  - 极坐标变换
  - 夹逼定理

**例题**：证明 $\lim_{(x,y) \to (0,0)} \frac{xy}{x^2+y^2}$ 不存在。

**解**：沿直线 $y=kx$ 趋近：
$$
\lim_{x \to 0} \frac{x \cdot kx}{x^2 + (kx)^2} = \lim_{x \to 0} \frac{kx^2}{x^2(1+k^2)} = \frac{k}{1+k^2}
$$
极限值随 $k$ 的取值而变化，因此极限不存在。

### 1.2 多元函数的连续性

**定义**：函数 $f(x,y)$ 在点 $(x_0,y_0)$ 连续，当且仅当：

$$
\lim_{(x,y) \to (x_0,y_0)} f(x,y) = f(x_0,y_0)
$$

**性质**：
- 连续函数的四则运算仍连续（除数不为零）
- 连续函数的复合仍连续
- 有界闭区域上的连续函数必有最大值和最小值（最值定理）
- 有界闭区域上的连续函数必取得介于最大值和最小值之间的任何值（介值定理）

### 1.3 偏导数

**定义**：函数 $f(x,y)$ 在点 $(x_0,y_0)$ 处对 $x$ 的偏导数定义为：

$$
\frac{\partial f}{\partial x}\bigg|_{(x_0,y_0)} = \lim_{\Delta x \to 0} \frac{f(x_0+\Delta x, y_0) - f(x_0,y_0)}{\Delta x}
$$

类似地定义对 $y$ 的偏导数 $\frac{\partial f}{\partial y}$。

**注意**：
- 偏导数存在只说明函数在**某个方向**上可导
- 偏导数存在**不能**推出函数连续
- 偏导数存在**不能**推出函数可微

**反例**：函数 $f(x,y) = \begin{cases} \frac{xy}{x^2+y^2}, & (x,y) \neq (0,0) \\ 0, & (x,y) = (0,0) \end{cases}$

在 $(0,0)$ 处两个偏导数都存在且都等于 $0$，但函数在 $(0,0)$ 处不连续。

### 1.4 可微性

**定义**：函数 $f(x,y)$ 在点 $(x_0,y_0)$ 可微，如果存在常数 $A, B$ 使得：

$$
\Delta f = f(x_0+\Delta x, y_0+\Delta y) - f(x_0,y_0) = A\Delta x + B\Delta y + o(\rho)
$$

其中 $\rho = \sqrt{(\Delta x)^2 + (\Delta y)^2}$，$o(\rho)$ 表示 $\rho$ 的高阶无穷小。

此时称 $df = A\Delta x + B\Delta y$ 为函数 $f$ 在点 $(x_0,y_0)$ 的**全微分**。

**充分条件**：如果函数 $f(x,y)$ 的偏导数 $\frac{\partial f}{\partial x}$，$\frac{\partial f}{\partial y}$ 在点 $(x_0,y_0)$ 的某个邻域内存在，且在点 $(x_0,y_0)$ 处连续，则 $f$ 在该点可微。

**必要条件**：如果函数 $f(x,y)$ 在点 $(x_0,y_0)$ 可微，则：
- $f$ 在该点连续
- $f$ 在该点的偏导数存在，且 $A = \frac{\partial f}{\partial x}$，$B = \frac{\partial f}{\partial y}$
- 全微分 $df = \frac{\partial f}{\partial x}dx + \frac{\partial f}{\partial y}dy$

### 1.5 概念之间的关系

```
可微 ⟹ 连续 + 偏导数存在
可微 ⟹ 连续
偏导数连续 ⟹ 可微
偏导数存在 ⟹ 连续 (❌ 错误)
偏导数存在 ⟹ 可微 (❌ 错误)
连续 ⟹ 偏导数存在 (❌ 错误)
```

**记忆要点**：
- 可微性是最强的条件，可以推出连续和偏导数存在
- 偏导数连续是可微的充分条件（但不是必要条件）
- 连续、偏导数存在都不能单独推出可微

## 二、多元函数微分的计算方法

### 2.1 全微分的计算

对于二元函数 $z = f(x,y)$，若 $f$ 可微，则：

$$
dz = \frac{\partial f}{\partial x}dx + \frac{\partial f}{\partial y}dy
$$

**例题**：求 $z = x^2y + y^3$ 的全微分。

**解**：
$$
\frac{\partial z}{\partial x} = 2xy, \quad \frac{\partial z}{\partial y} = x^2 + 3y^2
$$
$$
dz = 2xy \, dx + (x^2 + 3y^2) dy
$$

### 2.2 复合函数求导（链式法则）

#### 情形1：$z = f(u,v)$，$u = u(x,y)$，$v = v(x,y)$

$$
\frac{\partial z}{\partial x} = \frac{\partial f}{\partial u} \frac{\partial u}{\partial x} + \frac{\partial f}{\partial v} \frac{\partial v}{\partial x}
$$

$$
\frac{\partial z}{\partial y} = \frac{\partial f}{\partial u} \frac{\partial u}{\partial y} + \frac{\partial f}{\partial v} \frac{\partial v}{\partial y}
$$

**记忆方法**：画出关系树，从 $z$ 到 $x$（或 $y$）的每条路径对应一项，每项是路径上各偏导数的乘积。

#### 情形2：$z = f(x,y)$，$y = y(x)$（全导数）

$$
\frac{dz}{dx} = \frac{\partial f}{\partial x} + \frac{\partial f}{\partial y} \frac{dy}{dx}
$$

**例题**：设 $z = e^{xy} + x^2$，$y = \sin x$，求 $\frac{dz}{dx}$。

**解**：
$$
\frac{dz}{dx} = ye^{xy} + 2x + xe^{xy} \cos x = \sin x \cdot e^{x\sin x} + 2x + x e^{x\sin x} \cos x
$$

### 2.3 隐函数求导

#### 一个方程的情形

设方程 $F(x,y) = 0$ 确定隐函数 $y = y(x)$，则：

$$
\frac{dy}{dx} = -\frac{F_x'}{F_y'}
$$

**推导**：对方程两边关于 $x$ 求导：
$$
F_x' + F_y' \frac{dy}{dx} = 0 \Rightarrow \frac{dy}{dx} = -\frac{F_x'}{F_y'}
$$

#### 方程组的情形

设方程组 $\begin{cases} F(x,y,u,v) = 0 \\ G(x,y,u,v) = 0 \end{cases}$ 确定隐函数 $u = u(x,y)$，$v = v(x,y)$，则：

$$
\frac{\partial u}{\partial x} = -\frac{1}{J} \begin{vmatrix} F_x' & F_v' \\ G_x' & G_v' \end{vmatrix}, \quad \frac{\partial v}{\partial x} = -\frac{1}{J} \begin{vmatrix} F_u' & F_x' \\ G_u' & G_x' \end{vmatrix}
$$

其中 $J = \begin{vmatrix} F_u' & F_v' \\ G_u' & G_v' \end{vmatrix}$ 称为雅可比（Jacobi）行列式。

### 2.4 高阶偏导数

对于二阶偏导数，有四种：

$$
\frac{\partial^2 f}{\partial x^2}, \quad \frac{\partial^2 f}{\partial y^2}, \quad \frac{\partial^2 f}{\partial x \partial y}, \quad \frac{\partial^2 f}{\partial y \partial x}
$$

**混合偏导数相等的条件**（Schwarz定理）：如果 $\frac{\partial^2 f}{\partial x \partial y}$ 和 $\frac{\partial^2 f}{\partial y \partial x}$ 都连续，则：

$$
\frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x}
$$

**例题**：设 $f(x,y) = x^3y + xy^3$，验证混合偏导数相等。

**解**：
$$
\frac{\partial f}{\partial x} = 3x^2y + y^3, \quad \frac{\partial^2 f}{\partial y \partial x} = 3x^2 + 3y^2
$$
$$
\frac{\partial f}{\partial y} = x^3 + 3xy^2, \quad \frac{\partial^2 f}{\partial x \partial y} = 3x^2 + 3y^2
$$
确实相等。

### 2.5 方向导数与梯度

#### 方向导数

函数 $f(x,y)$ 在点 $P_0(x_0,y_0)$ 沿方向 $\vec{l} = (\cos \alpha, \cos \beta)$ 的方向导数为：

$$
\frac{\partial f}{\partial \vec{l}}\bigg|_{P_0} = \lim_{t \to 0^+} \frac{f(x_0 + t\cos\alpha, y_0 + t\cos\beta) - f(x_0,y_0)}{t}
$$

若 $f$ 可微，则：

$$
\frac{\partial f}{\partial \vec{l}}\bigg|_{P_0} = \frac{\partial f}{\partial x}\bigg|_{P_0} \cos\alpha + \frac{\partial f}{\partial y}\bigg|_{P_0} \cos\beta
$$

#### 梯度

函数 $f(x,y)$ 在点 $P_0$ 的梯度定义为：

$$
\text{grad } f|_{P_0} = \nabla f|_{P_0} = \left(\frac{\partial f}{\partial x}\bigg|_{P_0}, \frac{\partial f}{\partial y}\bigg|_{P_0}\right)
$$

**性质**：
- 梯度方向是函数增长最快的方向
- 梯度的模就是方向导数的最大值
- 方向导数可表示为：$\frac{\partial f}{\partial \vec{l}} = \nabla f \cdot \vec{e}_l = |\nabla f| \cos \theta$

其中 $\theta$ 是梯度与方向 $\vec{l}$ 的夹角。

## 三、多元函数的极值问题

### 3.1 无条件极值

**定义**：若存在 $(x_0,y_0)$ 的某个邻域，使得对该邻域内异于 $(x_0,y_0)$ 的所有点 $(x,y)$ 都有：

$$
f(x,y) < f(x_0,y_0) \quad (\text{或} \quad f(x,y) > f(x_0,y_0))
$$

则称 $f(x_0,y_0)$ 为函数的极大值（或极小值）。

**必要条件**：若 $f(x,y)$ 在点 $(x_0,y_0)$ 可微且取得极值，则：

$$
\frac{\partial f}{\partial x}\bigg|_{(x_0,y_0)} = 0, \quad \frac{\partial f}{\partial y}\bigg|_{(x_0,y_0)} = 0
$$

满足上述条件的点称为**驻点**或**稳定点**。

**充分条件**：设 $(x_0,y_0)$ 是驻点，记：

$$
A = \frac{\partial^2 f}{\partial x^2}\bigg|_{(x_0,y_0)}, \quad B = \frac{\partial^2 f}{\partial x \partial y}\bigg|_{(x_0,y_0)}, \quad C = \frac{\partial^2 f}{\partial y^2}\bigg|_{(x_0,y_0)}
$$

令 $\Delta = AC - B^2$，则：

- 若 $\Delta > 0$ 且 $A > 0$，则 $f(x_0,y_0)$ 为**极小值**
- 若 $\Delta > 0$ 且 $A < 0$，则 $f(x_0,y_0)$ 为**极大值**
- 若 $\Delta < 0$，则 $(x_0,y_0)$ 不是极值点（鞍点）
- 若 $\Delta = 0$，无法判断（需要其他方法）

**记忆口诀**：$\Delta$ 正定看 $A$，$\Delta$ 负鞍点，$\Delta$ 零不确定。

**例题**：求 $f(x,y) = x^3 + y^3 - 3xy$ 的极值。

**解**：

第一步：求驻点
$$
\frac{\partial f}{\partial x} = 3x^2 - 3y = 0 \Rightarrow y = x^2
$$
$$
\frac{\partial f}{\partial y} = 3y^2 - 3x = 0 \Rightarrow x = y^2
$$

代入得 $x = x^4$，即 $x(x^3-1) = 0$，解得 $x = 0$ 或 $x = 1$。

驻点为 $(0,0)$ 和 $(1,1)$。

第二步：计算二阶偏导数
$$
A = \frac{\partial^2 f}{\partial x^2} = 6x, \quad B = \frac{\partial^2 f}{\partial x \partial y} = -3, \quad C = \frac{\partial^2 f}{\partial y^2} = 6y
$$

第三步：判断

在 $(0,0)$：$A = 0$，$B = -3$，$C = 0$，$\Delta = 0 \cdot 0 - (-3)^2 = -9 < 0$，鞍点。

在 $(1,1)$：$A = 6$，$B = -3$，$C = 6$，$\Delta = 6 \cdot 6 - (-3)^2 = 27 > 0$ 且 $A > 0$，极小值点。

极小值为 $f(1,1) = 1 + 1 - 3 = -1$。

### 3.2 条件极值与拉格朗日乘数法

**问题**：求函数 $z = f(x,y)$ 在约束条件 $\varphi(x,y) = 0$ 下的极值。

**方法**：构造拉格朗日函数：

$$
L(x,y,\lambda) = f(x,y) + \lambda \varphi(x,y)
$$

其中 $\lambda$ 称为拉格朗日乘数。

求解方程组：

$$
\begin{cases}
\frac{\partial L}{\partial x} = \frac{\partial f}{\partial x} + \lambda \frac{\partial \varphi}{\partial x} = 0 \\
\frac{\partial L}{\partial y} = \frac{\partial f}{\partial y} + \lambda \frac{\partial \varphi}{\partial y} = 0 \\
\varphi(x,y) = 0
\end{cases}
$$

得到的点可能是极值点，需要进一步判断或利用实际问题的意义确定。

**例题**：求函数 $f(x,y) = x + y$ 在约束条件 $x^2 + y^2 = 1$ 下的最大值和最小值。

**解**：构造拉格朗日函数：
$$
L(x,y,\lambda) = x + y + \lambda(x^2 + y^2 - 1)
$$

求解方程组：
$$
\begin{cases}
1 + 2\lambda x = 0 \\
1 + 2\lambda y = 0 \\
x^2 + y^2 = 1
\end{cases}
$$

从前两个方程得 $x = y = -\frac{1}{2\lambda}$，代入第三个方程：

$$
2 \cdot \frac{1}{4\lambda^2} = 1 \Rightarrow \lambda^2 = \frac{1}{2} \Rightarrow \lambda = \pm \frac{\sqrt{2}}{2}
$$

当 $\lambda = \frac{\sqrt{2}}{2}$ 时，$x = y = -\frac{\sqrt{2}}{2}$，$f = -\sqrt{2}$（最小值）

当 $\lambda = -\frac{\sqrt{2}}{2}$ 时，$x = y = \frac{\sqrt{2}}{2}$，$f = \sqrt{2}$（最大值）

### 3.3 最值问题的实际应用

在有界闭区域 $D$ 上求连续函数 $f(x,y)$ 的最大值和最小值：

**步骤**：
1. 求 $D$ 内部的所有驻点，计算函数值
2. 求 $D$ 边界上的最大值和最小值（转化为条件极值或一元函数极值问题）
3. 比较上述所有函数值，最大的为最大值，最小的为最小值

## 四、常见题型与技巧

### 4.1 判断极限存在性

**技巧**：
- 证明不存在：选择两条不同的路径（如 $y=kx$，$y=kx^2$），若极限值不同则不存在
- 证明存在：用极坐标 $x = r\cos\theta$，$y = r\sin\theta$，证明 $r \to 0$ 时极限与 $\theta$ 无关

### 4.2 可微性的判断

**方法**：
1. 检查偏导数是否连续（充分条件）
2. 若偏导数不连续，用定义验证：检查 $\frac{\Delta f - f_x'\Delta x - f_y'\Delta y}{\sqrt{(\Delta x)^2 + (\Delta y)^2}}$ 是否趋于 $0$

### 4.3 抽象函数求偏导

对于 $u = f(x+y, xy)$ 型：
- 令 $s = x+y$，$t = xy$，则 $u = f(s,t)$
- $\frac{\partial u}{\partial x} = \frac{\partial f}{\partial s} \cdot 1 + \frac{\partial f}{\partial t} \cdot y$

对于 $z = f\left(\frac{y}{x}\right)$ 型：
- 令 $u = \frac{y}{x}$，则 $z = f(u)$
- $\frac{\partial z}{\partial x} = f'(u) \cdot \left(-\frac{y}{x^2}\right)$
- $\frac{\partial z}{\partial y} = f'(u) \cdot \frac{1}{x}$

### 4.4 齐次函数的欧拉定理

若 $f(tx,ty) = t^n f(x,y)$（$n$ 次齐次函数），则：

$$
x\frac{\partial f}{\partial x} + y\frac{\partial f}{\partial y} = nf(x,y)
$$

这是计算偏导数的重要工具。

## 五、重要公式总结

### 全微分公式
$$
dz = \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy
$$

### 复合函数求导
$$
\frac{\partial z}{\partial x} = \frac{\partial z}{\partial u}\frac{\partial u}{\partial x} + \frac{\partial z}{\partial v}\frac{\partial v}{\partial x}
$$

### 隐函数求导
$$
\frac{dy}{dx} = -\frac{F_x'}{F_y'}, \quad (F(x,y) = 0)
$$

### 方向导数
$$
\frac{\partial f}{\partial \vec{l}} = \frac{\partial f}{\partial x}\cos\alpha + \frac{\partial f}{\partial y}\cos\beta
$$

### 梯度
$$
\nabla f = \left(\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}\right)
$$

### 极值判别
$$
\Delta = AC - B^2
$$

- $\Delta > 0, A > 0$ → 极小值
- $\Delta > 0, A < 0$ → 极大值  
- $\Delta < 0$ → 鞍点

## 六、典型例题

### 例题1：极限计算

求 $\lim_{(x,y) \to (0,0)} \frac{x^2y}{x^4+y^2}$

**解**：沿 $y = x^2$ 趋近：
$$
\lim_{x \to 0} \frac{x^2 \cdot x^2}{x^4 + x^4} = \lim_{x \to 0} \frac{x^4}{2x^4} = \frac{1}{2}
$$

沿 $y = 0$ 趋近：
$$
\lim_{x \to 0} \frac{x^2 \cdot 0}{x^4 + 0} = 0
$$

两条路径极限值不同，因此极限不存在。

### 例题2：隐函数求导

设 $z = z(x,y)$ 由方程 $x^2 + y^2 + z^2 = 3xyz$ 确定，求 $\frac{\partial z}{\partial x}$ 和 $\frac{\partial z}{\partial y}$。

**解**：令 $F(x,y,z) = x^2 + y^2 + z^2 - 3xyz = 0$

$$
F_x' = 2x - 3yz, \quad F_z' = 2z - 3xy
$$

$$
\frac{\partial z}{\partial x} = -\frac{F_x'}{F_z'} = -\frac{2x - 3yz}{2z - 3xy} = \frac{3yz - 2x}{2z - 3xy}
$$

同理：
$$
\frac{\partial z}{\partial y} = \frac{3xz - 2y}{2z - 3xy}
$$

### 例题3：条件极值

求函数 $f(x,y,z) = xyz$ 在约束条件 $x + y + z = 1$，$x, y, z > 0$ 下的最大值。

**解**：构造拉格朗日函数：
$$
L(x,y,z,\lambda) = xyz + \lambda(x + y + z - 1)
$$

求解方程组：
$$
\begin{cases}
yz + \lambda = 0 \\
xz + \lambda = 0 \\
xy + \lambda = 0 \\
x + y + z = 1
\end{cases}
$$

从前三个方程得 $yz = xz = xy$，可推出 $x = y = z$。

代入第四个方程：$3x = 1$，得 $x = y = z = \frac{1}{3}$。

最大值为 $f\left(\frac{1}{3}, \frac{1}{3}, \frac{1}{3}\right) = \frac{1}{27}$。

## 七、易错点提醒

1. **偏导数存在不等于可微**：必须检查偏导数是否连续或用定义验证
2. **混合偏导数相等需要连续性条件**：不能随意交换求导顺序
3. **隐函数求导要检查分母不为零**：即 $F_y' \neq 0$ 或 $J \neq 0$
4. **拉格朗日乘数法得到的只是可能的极值点**：需要进一步验证或利用问题的实际意义
5. **极坐标变换时要注意 $r > 0$**：不能取 $r < 0$
6. **方向导数计算时方向向量必须是单位向量**：要除以模长归一化
