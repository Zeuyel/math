# 求解参数矩阵

> [!abstract] 参数矩阵
> 1. 将参数矩阵转化为未知数，回到求解方程的形式
> 2. 相似对角化逆运算，求出所有特征向量和所有的特征值，$P\Lambda P^{-1}$ 
> 3. 非齐次要分解为 齐次和非齐次
> 4. 线性方程组的两种形式，行与列

## 齐次矩阵方程


设 $A = \begin{pmatrix} 1 & 2 & 1 \\ 0 & 1 & a \\ 1 & a & 0\end{pmatrix}$ 三阶非零矩阵B满足 $BA = \mathbf{O}$ 


显然$A$ 的第一二列不成比例的，$r(A) \ge 2$  而 $B \neq \mathbf{O} \to r(B) \ge 1$   又有：$r(B)+r(A) = 3$ 因此：

$$
r(B) = 1, r(A) =2
$$


因此 $a = 1$ 

进一步，要求解 B，我们的B是根据矩阵方程得到的：

$$
BA = \mathbf{O}
$$

这里未知的 $B$ 在 左边，而非右边，转换到我们求解 $Ax = 0$  上：

$$
BA = \mathbf{O} \to (Ba_{1} ,Ba_{2},Ba_{3}) = \mathbf{O} \tag{1}
$$
我们设 $B = (b_{1},b_{2},b_{3})$  ，根据（1）我们可以得到三个方程：

$$
\begin{cases}
b_{1} + b_{3} = 0 \\
2b_{1} + b_{2} + b_{3} = 0 \\
b_{1} + b_{2}  = 0
\end{cases}
$$

再转换到：

$$
\begin{pmatrix}
1 & 0 & 1 \\
2 & 1 & 1 \\
1 & 1 & 0
\end{pmatrix} \begin{pmatrix}
b_{1} \\
b_{2} \\
b_{3}
\end{pmatrix} = 0
$$

观察力惊人，我们应该得到：

$$
A^{T}B^{T} = 0
$$

转置操作实际是我们的矩阵方程或者说矩阵等式的常见操作。 ^dn7faq

对于 $A^{T}$ 我们化简到：

$$
\begin{pmatrix}
1 & 0 & 1 \\
0 & 1 & -1 \\
0 & 0 & 0
\end{pmatrix}
$$

基础解系为：

$$
t\begin{pmatrix}
-1 \\
1 \\
1
\end{pmatrix}
$$

那么 $B^{T}$ 就是：

$$
B = \begin{pmatrix}
-t &-u &-v &\\
 t & u & v &\\
 t & u & v &
\end{pmatrix}
$$

$t,u,v$ 为任意常数
## 非齐次矩阵方程

> 非齐次总是蕴含齐次，下面是一个很好的例子

设 $A$ 为三阶矩阵，$b = (9,18,-18)^{T}$  非齐次线性方程组 $Ax = b$ 的 通解为 

$$
k_{1}(-2,1,0)^{T} + k_{2}(2,0,1)^{T} + (1,2,-2)^{T}
$$

其中 $k_{1},k_{2}$ 为任意常数， 求 $A$ 

我们先思考齐次方程组 $Ax = 0$ 他的解空间的两个基是：

$$
\alpha_{1} = (-2,1,0),\alpha_{2} =(2,0,1)
$$

这就对应着这个同解方程：

$$
\begin{pmatrix}
1 & 2 & -2 \\
0 & 0 & 0  \\
0 & 0 & 0
\end{pmatrix} x = 0
$$

> [!tip]
> 当然，我们也可以通过求正交来得到，知道了 $\alpha_{1}$ 和 $\alpha_{2}$ ，那么 $A$ 某一行就可以算出了：
>    $$
> Ax = \begin{pmatrix}
> l_{1}^{T} x \\
> l_{2}^{T} x \\
> \dots \\
> l_{n}^{T} x
> \end{pmatrix} = \begin{pmatrix}
> 0 \\
> 0 \\
> \dots \\
> 0
> \end{pmatrix}
> $$
> 可以留着验算，其实下面的计算量也不复杂。

这个就是反号顺抄写的逆运算，实际上因为 $r(A)=1$  我们就能够得到，最后的行最简是：

$$
\begin{pmatrix}
1 & a & b \\
0 & 0 & 0 \\
0 & 0 & 0
\end{pmatrix}
$$

只要基本功扎实，这个直接就秒了。或者代入都行，$a$ 和 $b$ 就直接出来了。由于 $r(A)=1$ 设：

$$
A = \begin{pmatrix}
1 a & 2a & -2a\\
1 b & 2b & -2b\\
1 c & 2c & -2c
\end{pmatrix}
$$
或者连行最简都想象不到，那就直接设：

$$
A = \begin{pmatrix}
a & b & c \\
ma & mb & mc \\
na & nb & nc \\
\end{pmatrix}
$$

那就求解 $Ax = 0$ 

自然能够化到 :

$$
\begin{pmatrix}
a & b & c \\
0 & 0 & 0 \\
0 & 0 & 0
\end{pmatrix} \to \begin{pmatrix}
1 & \frac{b}{a} & \frac{c}{a} \\
0 & 0 & 0 \\
0 & 0 & 0
\end{pmatrix}
$$

进而得到 $b=2a,c=-2a$ 那么：

$$
A = \begin{pmatrix}
a & 2a & -2a \\
ma & 2ma & -2ma \\
na & 2na & -2na
\end{pmatrix}
$$

那么再回到非齐次 $Ax =b$ 我们随便代入一个解，$k_{1},k_{2}$ 直接取 $0$  

$$
A \begin{pmatrix}
1 \\
2 \\
-2
\end{pmatrix} = \begin{pmatrix}
9a \\
9ma \\
9na
\end{pmatrix} =  \begin{pmatrix}
9 \\
18 \\
-18
\end{pmatrix}
$$

所以 $a = 1,m = 2,n =-2$ 

那么 

$$
A = \begin{pmatrix}
1 & 2 & -2 \\
2 & 4  & -4 \\
-2 & -4 & 4
\end{pmatrix}
$$

当然，如果连分离齐次和非齐次都没有想到，那么最直觉的操作，把这个线性方程组转为矩阵方程，然后求解出系数矩阵：

$$
(Ax_{1},Ax_{2},Ax_{3}) = (b,b,b) , A(x_{1},x_{2},x_{3}) = (b,b,b)
$$

其中：

$$
(x_{1},x_{2},x_{3}) = \begin{pmatrix}
-1 & 3 & 1 \\
3 & 2 & 2 \\
-2 & -1 & -2
\end{pmatrix}
$$

> 实际上， 非齐次线性方程组有 $n -r(A) + 1$  个线性无关的解向量。

这是可逆的，那么：

$$
A = (b,b,b)(x_{1},x_{2},x_{3})^{-1}
$$

那么计算量就来到了 $x_{1},x_{2},x_{3}$ 的逆上了。 


如果不可逆，那就要回到上面齐次矩阵方程中的，转置的操作，换一下顺序，把$A$ 放到未知数上，$A$ 的每一列都是 $X^{T}a=b$    解向量，根据基础解系得到每一列的表达式，然后再根据其他信息确定了。

> [!tips]  特征值、特征向量反求矩阵

我们还有一种思路，就是思考到他的相似对角化，因为 [[秩一矩阵]]的特征向量和特征矩阵都非常容易得到。并且这里明确的说明  $Ax =0$ 的解。这一点我们在[[特征值和特征向量]]也特地提出过，对于 $Ax = 0$ 要由特征值特征向量的敏感性，即使没有秩一，我们也应该想到。

对于$0$ 特征值，对应两个线性无关的特征向量：

$$
A(-2,1,0) = 0,A(2,0,1) =0
$$

接下来是 $tr(A)$ 和 $\alpha$  这一对。我们看到非齐次线性方程组：

$$
Ax = \begin{pmatrix}
9 \\
18 \\
-18
\end{pmatrix} = 9 \begin{pmatrix}
1 \\
2 \\
-2
\end{pmatrix}
$$

显然 $\alpha = (1,2,-2)^{T}$ ，对应的特征值为 $9$ 

因此，我们可以根据对角矩阵和特征向量计算$A$ 

$$
A = P\Lambda P^{-1}
$$

我们也可以设 $\beta = (a,b,c)$ 求解三个未知数，思路是先消元然后代入 $tr(A)$ 计算（要充分利用上我们的秩一矩阵的已知信息，来简化计算）











