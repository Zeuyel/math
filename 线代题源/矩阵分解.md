---
tags:
  - 考研
  - 线代
  - math
  - cheatsheet
---
>[!abstract] 正定矩阵分解
>1. 相似对角化分解、实对称分解、可逆矩阵QR分解（施密特正交化的逆向分解）
>2. 定义
>	1. 若 $A$ 为$n$ 阶正定阵，$\forall$ 正整数 $m$ ，存在$n$ 阶正定阵 $B$ 使得 $A = B^{m}$ 
>3. 方法，以 $m = 2$ 为例 
>	1. 正定阵 $A = B^{2}$ ，也必定是实对称矩阵，可以正交相似对角化
>		1. $A = Q\Lambda Q^{T}$  
>	2. $A = Q\begin{pmatrix}\lambda_{1} &  &  \\  & \ddots &  \\  &  & \lambda _{n}\end{pmatrix}Q^{T}$ 
>	3. $B = Q\begin{pmatrix}\sqrt{\lambda_{1}} &  &  \\  & \ddots &  \\  &  &\sqrt{\lambda_{n}}\end{pmatrix}Q^{T}$ 

# 相似对角化分解

## 例题1

设3阶实对称矩阵A的各行元素之和均为3,向量$a_1 = (-1,2,-1)^T$，$a_2 = (0,-1,1)^T$是线性方程组$Ax=0$的两个解。

(1)求A的特征值与特征向量

$\lambda_{1} = 0, \alpha_{1} = (-1,2,-1)^{T},\alpha_{2} = (0,-1,1)^{T}$ 
$\lambda_{2} = 3, \alpha_{3} = (1,1,1)^{T}$

(2)求正交矩阵Q和对角矩阵$\Lambda$,使得 $Q^TAQ = \Lambda$;

首先，我们先找到单根 $\gamma_{1} \triangleq \alpha_{3} = (1,1,1)^{T}$ 那么由于实对称矩阵，不同特征值之间的特征向量正交，因此$\lambda_{1}$  对应的特征向量在和 $(1,1,1)^{T}$ 正交的平面上，我们可以直接正交化写出：

$$
\gamma_{2} = (1,0,-1)^{T}
\gamma_{3} = (1,-2,1)^{T}
$$

进而单位化后得到 $Q = \left( \frac{1}{\sqrt{ 3 }}\gamma_{1}, \frac{1}{\sqrt{ 2 }}\gamma_{2} , \frac{1}{\sqrt{ 5 }}\gamma_{3}\right)$ 

对应的 $\Lambda = diag(3,0,0)$

(3)求A及$(A-\frac{3}{2}E)^6$,其中E为3阶单位矩阵。

> 事实上，根据实对称矩阵和秩一矩阵的性质，我们可以直接写出 $A = \begin{pmatrix}1 \\ 1 \\ 1\end{pmatrix}(1,1,1)$

$$
A = Q \Lambda Q^{T}
$$

那么对于 $A - \frac{3}{2}E$ 的幂次，我们可以直接分解，应为 $A- \frac{3}{2}E$ 的特征值为 $-\frac{3}{2}, \frac{3}{2}, \frac{3}{2}$ 而对应的特征向量和 $A$ 是相同的，故而有：

$$
A - \frac{3}{2}E = Q \begin{pmatrix}
- \frac{3}{2} &  &  \\
 & \frac{3}{2} &  \\
 &  & \frac{3}{2}
\end{pmatrix} Q^{T} = \left( A-\frac{3}{2}E \right)^{6} = Q \left( \frac{3}{2} \right)^{6}E Q^{T} =  \left( \frac{3}{2} \right)^{6} QQ^{T} = \left( \frac{3}{2} \right)^{6}
$$


# 实对称矩阵分解

> 由于 $QQ^{T} = E$  实对称矩阵分解有更多的特性，最常见的就是开根号。

## 例题2

设 $A = \begin{pmatrix}5 & -3 & 3 \\ -3 & 5 & 3 \\ 3 & 3 & 5\end{pmatrix}$ 求 $A = C^{3}$

$$
A = \begin{pmatrix}
-3 & -3 & 3 \\
-3 & -3 & 3 \\
3 &  3 & -3 
\end{pmatrix} + 8E = B+8E
$$

$B$ 的特征值 $-9,0,0$ 对应特征向量 $\alpha_{1} = \begin{pmatrix}1 \\ 1 \\ -1\end{pmatrix}$ $\alpha_{2} = \begin{pmatrix}-1 \\ 1 \\ 0\end{pmatrix}$ $\alpha_{3} = \begin{pmatrix}1 \\ 1 \\ 2\end{pmatrix}$

$A$ 的特征值 $-1,8,8$ 对应特征向量 $\alpha_{1} = \begin{pmatrix}1 \\ 1 \\ -1\end{pmatrix}$ $\alpha_{2} = \begin{pmatrix}-1 \\ 1 \\ 0\end{pmatrix}$ $\alpha_{3} = \begin{pmatrix}1 \\ 1 \\ 2\end{pmatrix}$

$Q \triangleq \begin{pmatrix} \frac{1}{\sqrt{ 3 }} \alpha_{1}, \frac{1}{\sqrt{ 2 }} \alpha_{2} , \frac{1}{\sqrt{ 6 }} \alpha_{3}\end{pmatrix}$ 则 $A = Q \begin{pmatrix}-1 &  &  \\  & 8 &  \\  &  & 8\end{pmatrix}Q^{T}$

此时，我们就可以对中间的对角阵开三次根号得到 $C$ ：

$$
C = Q \begin{pmatrix}
-1 &   &  \\
 &  8 &  \\
 &  & 8
\end{pmatrix} ^{1/3} Q^{T} = Q \begin{pmatrix}
-1  &  &  \\
 & 2  &  \\
 &  & 2
\end{pmatrix} Q
$$

# 高阶正交分解：

已知矩阵 $A = \begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 2 & 1 \\ 0 & 0 & 1 & 2 \end{bmatrix}$ . 求矩阵 $\mathbf{P}$, 使($\mathbf{AP}$)$^{\text{T}}$($\mathbf{AP}$)为对角矩阵.

由于 $A^{T} = A$ ，实际上求 $P^{T} A^{2}P$ ，那么这里我们直接对 $A^{2}$ 分解还是 对 $A$ 进行分解？显然 $A^{2}$ 可能将不同的特征值合并，从而丢失直观的正交属性。具体来说

$$
|A - \lambda E | = (\lambda - 1)^{2}(\lambda+1)(\lambda -3), |A^{2} - \lambda E| = (\lambda-1)^{3}(\lambda - 9)
$$

当然由于 $4$ 阶 待定三个参数也可。下面说明两种分解的各自步骤。

对于 $A$ ，$\lambda_{1}=-1$  的 特征向量为 $\alpha_{1} = (-1,1,0,0)^{T}$ ； $\lambda_{2} = 3$ 的特征向量为 $\alpha_{2} = (0,0,1,1)^{T}$ 

对于 $\lambda_{3}=\lambda_{4} = 1$ 我们考察方程 $(A - E)x = 0$ 的系数矩阵：

$$
A-E = \begin{bmatrix}
-1 & 1 & 0 & 0 \\
1 & -1 & 0 & 0 \\
0 & 0 & 1 & 1 \\
0 & 0 & 1 & 1
\end{bmatrix} \to \begin{bmatrix}
-1 & 1 & 0 & 0 \\
0 & 0 & 1 & 1 \\
 \\
 \\
\end{bmatrix}
$$

- 首先和 $\alpha_{1},\alpha_{2}$ 正交，恰好刚刚在系数矩阵里。因此 $\alpha_{3} = (1,1,0,0)$
- 求解 $\alpha_{4}$ 我们希望直接写出正交形式，可以拓展一下系数矩阵为：

$$
\begin{bmatrix}
-1 & 1 & 0 & 0 \\
0 & 0 & 1 & 1 \\
1 & 1 & 0 & 0 \\ \\
\end{bmatrix}
\to
\begin{bmatrix}
-1 & 0 & 0 & 0 \\
0 & 0 & 1 & 1 \\
0 & 2 & 0 & 0 \\ \\
\end{bmatrix} 
\to

\begin{bmatrix}
-1 & 0 & 0 & 0 \\
0 & 2 & 0 & 0 \\
0 & 0 & 1 & 1 \\ \\
\end{bmatrix}
$$

那么 $\alpha_{4} = (0,0,1,1)$ 现在四个特征向量都正交了。进一步单位化即可。那么如果对 $A^{2}$ 分解，$\lambda_{1} = 9,\lambda_{2} = \lambda_{3} = \lambda_{4} = 1$：

- $\lambda_{1} = 9$ 得到 $\alpha_{1} = (0,0,1,1)^{T}$
- $\lambda_{2}=1$  那么约束为 $\begin{bmatrix}0,0,1,1 \\ \end{bmatrix}$ 取 $\alpha_{2} = (0,0,1,-1)^{T}$
- $\lambda_{3} = 1$ 进一步扩展约束为 $\begin{bmatrix}0,0,1,1 \\ 0,0,1,-1\end{bmatrix}$ 取 $\alpha_{3} = (1,1,0,0)^{T}$
- $\lambda_{4} = 1$ 的约束为 $\begin{bmatrix}0 &0 & 1 & 1 \\ 0 & 0 & 1 & -1 \\ 1 & 1 & 0 & 0\end{bmatrix}$ 取 $\alpha_{4} = (-1,1,0,0)^{T}$

这里说明一下这个方程：

$$
\begin{bmatrix}0 &0 & 1 & 1 \\ 0 & 0 & 1 & -1 \\ 1 & 1 & 0 & 0\end{bmatrix} \begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4}
\end{bmatrix}
\to
\begin{bmatrix}1 &1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1\end{bmatrix} \begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4}
\end{bmatrix}
$$

这里自由未知量为 $x_{2}$ ，令它为 $1$ 得到特解 $(-1,1,0,0)$ ，这里反号顺抄失效了，回归最基础的特解求法。

# 正定矩阵分解
## 例题1

设 $A = \begin{pmatrix} 20 & -2 & 4 \\ -2 & 17 & -2 \\ 4 & -2 & 20 \end{pmatrix}$ , 判定A是否正定, 并求正定矩阵B, 使得 $B^2 = A$.

关键就是对 $A$ 进行正交相似对角化。首先相似对角化， 求特征值和特征向量。最简单的就是按照一般矩阵的方式。判断是否能够转换为秩一矩阵：

$$
A = \begin{pmatrix}
4 & -2 & 4 \\
-2 & 1 & -2 \\
4 & -2 & 4
\end{pmatrix} + 16E = C + 16E
$$
> 这是 凑秩一的常见操作。

对于 $C = (2,-1,2)^{T}(2,-1,2) = \alpha\beta ^{T}$ ，实对称矩阵
- 特征值是 $\lambda_{1} = 9,\lambda_{2}=\lambda_{3}=0$ 。对应 $A$ 的特征值为 $25,16,16$  
- 我们可以直接写出 $\lambda_{1}$ 对应的特征向量 $\alpha_{1} = (2,-1,2)$ ，实对称矩阵我们直接把正交操作放在求解特征向量的过程当中。对于 $\lambda_{2} = \lambda_{3} = 0$
	- 先求一个特征向量$\alpha_{2}$ 求解 $\alpha_{1}^{T} \alpha_{2} = 0$   得到 $\alpha_{2} = (1,2,0)$ 。保留一个分量为 $0$ 
	- $\alpha_{3}$ 先和 $\alpha_{2}$ 正交，也就是 $\alpha_{3}= (-2,1,x_{3})$  
	- 还需要和 $\alpha_{1}$ 正交，得到 $x_{3} = \frac{5}{2}$ 
	- 化简得到 $\alpha_{3} = (-4,2,5)$ 

进一步我们需要单位化，

$$
\gamma_{1} = \frac{1}{3} \begin{pmatrix}
2 \\
-1 \\
2
\end{pmatrix}, \gamma_{2} = \frac{1}{\sqrt{ 5 }} \begin{pmatrix}
1 \\
2 \\
0
\end{pmatrix}, \gamma_{3} = \frac{1}{3\sqrt{ 5 }} \begin{pmatrix}
-4 \\
2 \\
5
\end{pmatrix}
$$

得到 $Q = (\gamma_{1},\gamma_{2},\gamma_{3})$ ，使得

$$
Q^{T}AQ = \begin{pmatrix}
25 &  &  \\
 & 16 &  \\
 &  & 16
\end{pmatrix} \to A = Q diag(25,16,16)Q^{T}
$$

那么对于$A$ 来说，它实际上和 $C$ 是共享特征向量，也就是$Q$ ，所以我们构造了$A$ 的正交相似对角化.

则 $B = Q \begin{pmatrix}5 &  &  \\  & 4 &   \\  &  & 4\end{pmatrix}Q^{T}$  则 $B$ 正定。 



## 例题2

已知矩阵 $A = \begin{pmatrix} a & 1 \\ 1 & a \end{pmatrix}$，正定矩阵 $C$ 满足 $C^2 = (a+2)E - A$，则 $C$ 的所有元素之和为。

所有元素的和，也就是：

$$
(1,1)C \begin{pmatrix}
1 \\
1
\end{pmatrix} \tag{1}
$$

对于 $A$ 分解得到 

$$
A = \begin{pmatrix}
1 &  1 \\
1 & 1
\end{pmatrix} + \begin{pmatrix}
a-1 &  \\
 & a-1
\end{pmatrix} = D + (a-1)E
$$

D 特征值为 $2,0,0$ 。恰好的是非零特征向量就是 $\begin{pmatrix}1 \\ 1\end{pmatrix}$  ，由于特征向量是不变的。因此我们有单位化后

$$
\sqrt{ 2 }(1,1) C \sqrt{ 2 } \begin{pmatrix}
1 \\
1
\end{pmatrix} = 2 (1,1) C \begin{pmatrix}
1 \\
1
\end{pmatrix} = 2 \lambda_{1}
$$

其中 $\lambda_{1}$ 就是 C 的 $\begin{pmatrix}1 \\ 1\end{pmatrix}$   所对应的 特征值，对应$C$ 的特征值为 2 ，那么对应 $A$ 的特征值为 $a+1$ 那对应 $C^{2}$     的特征值为 $1$ 因此对应 $C$ 的 特征值为 1 ，所以 $\lambda_{1} = 1$    

所以 （1）式的结果是 $1$ 

## 例题3

设 $A=(a_{ij})_{3 \times 3}$ 是实对称矩阵，$a_{ii} = 0(i=1,2,3)$, $\mathbf{a}=(-1,1,1)^T$ 满足 $(A+2E)\mathbf{a}=0$.

这一题的关键是我们的$A$ 如何确定，我们写出来：

$$
A = \begin{pmatrix}
0 & a & b \\
a & 0 & c \\
b & c & 0
\end{pmatrix}
$$

还有三个未知数，然后给了我们一个方程组，实际上回到了 [[线性方程组#求解参数矩阵]] 的内容，我们要由这个意识，去思考这能不能解出来。显然我们现在有三个方程，确定三个未知数：

$$
\begin{cases}
a+b  = -2*-1 \\
-a + c = -2*1 \\
-b + c = -2*1
\end{cases}
$$

所以 $a = 1,b=1,c= -1$ 那么之后的操作就简单了。

(I) 求正交矩阵Q,使得 $Q^TAQ = \Lambda$;

(II) 求正定矩阵B,使得 $A = B^2 - 3E$.

## 例题4

设二次型 $x^T Ax = \alpha(x_1^2 + x_2^2 + x_3^2) + 2x_1x_2 + 2bx_1x_3 + 2x_2x_3$，在正交变换 $x = Qy$ 下的标准形为 $y_1^2 + y_2^2 + 4y_3^2$，其中 $A^T = A$ 。

先写出 $A$ 

$$
\begin{pmatrix}
a & 1 & b \\
1 & a & 1 \\
b & 1 & a
\end{pmatrix}
$$

进一步的 $x = Qy,x^{T} = y^{T}Q^{T}$  因此，我们有：

$$
y^{T}Q^{T}AQy = y_{1}^{2}+y_{2}^{2} + 4y_{3}^{2}
$$

所以 $Q^{T}AQ = \begin{pmatrix}1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 4\end{pmatrix}$  

(I) 求 $a,b$ 的值及正交矩阵 $Q$；

我们知道 $A$ 有 特征值 $4,1,1$  并且为实对称阵。那么我们有 $A-E$ 是实对称阵，有特征值 $3,0,0$   非零特征值个数为1，因此$r(A - E) = 1$ 是秩一矩阵。我们有：

$$
A - E = \begin{pmatrix}
a-1 & 1 & b \\
1 & a-1 & 1 \\
b & 1 & a-1
\end{pmatrix} = \begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix}(1,1,1) = C
$$

所以 $a = 2$ $b = 1$  

> 当然我们还能利用实对称矩阵的性质以及特征行列式来求出。但是我们本来就要这样操作不如直接简便

对于秩一矩阵来说，C的特征值为：$3,0,0$ 进一步的我们得到：

- 单根 3 的特征向量为 $\alpha_{1} = (1,1,1)$ 
- 双根的第一个特征向量为 $\alpha_{2} = (1,-1,0)$ 
	- 第二个特征向量待定为 $(1,1,x_{3})$  
	- 再和 $\alpha_{1}$ 正交得到 $x_{3} = -2$   
	- $\alpha_{3} = (1,1,-2)$ 

单位化解得到 $Q$ 

(II) 若正定矩阵 $B$ 满足 $B^2 = A + A^*$, 其中 $A^*$ 是 $A$ 的伴随矩阵, 求 $B$。

$$r(A) = 1 \to r(A^{\star}) = 0 \to A^{\star} = \mathbf{O}$$

所以 $B^{2} = A$ 


## 例题5

A. $r(A:BA)=r(A)$
B. 设A为m×n矩阵,且r(A)=m<n,则存在可逆矩阵P,使得PA=(E:O)
C. 设A为m×n矩阵,且r(A)=n<m,则存在可逆矩阵Q,使得AQ=($\begin{matrix}E \\ O\end{matrix}$)
D. 设A为m×n矩阵,且r(A)=m<n,则存在可逆矩阵B,使得$A^TA+E=B^2$

对于 $A^{T}A$ 我们想到的是 和 $A$ 等价，以及同解方程组。进一步我们想到推导过程中的

$$
x^{T}A^{T}Ax = (Ax)^{T}Ax = ||Ax||^{2} = x^{T}(B^{2} - E) x
$$

这里的 $x$ 是任意的。 

进一步的得到：

$$
Q^{T}A^{T}AQ = Q^{T}(B^{2} -E)Q
$$

显然 $A^{T}A$ 是正定的，也必定是实对称阵因此当然能够进行这样的正交相似对角化。

# QR 分解

【例45】设 $A = \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & 0 \\ 0 & 1 & 1 \end{pmatrix}$.

> 回忆正交矩阵和施密特正交化的步骤，这里知识逆运算

(I) 求正交矩阵 $Q_1$ 和对角线元素为正数的上三角矩阵 $R$，使 $A = Q_1R$;

$$
A \triangleq (\alpha_{1},\alpha_{2},\alpha_{3})
$$

$$
\begin{align}
\beta_{1} & = \alpha_{1} , \gamma_{1} = \frac{\beta_{1}}{|\beta_{1}|} = \frac{1}{\sqrt{ 2 }} (1,1,0)^{T}\\
\beta_{2} & = \alpha_{2} - <\alpha_{2},\gamma_{1}>\gamma_{1},\gamma_{2} = \frac{\beta_{2}}{|\beta_{2}|} = (0,0,1)^{T} \\
\beta_{3}  & = \alpha_{3} - <\alpha_{3},\gamma_{1}>\gamma_{1} - <\alpha_{3},\gamma_{2}>\gamma_{2}, \gamma_{3} = \frac{\beta_{3}}{|\beta_{3}|} = \frac{1}{\sqrt{ 2 }} (1,-1,0)^{T}
\end{align}
$$

因此：

$$
A = (\alpha_{1},\alpha_{2},\alpha_{3}) = (\gamma_{1},\gamma_{2},\gamma_{3})\begin{pmatrix}
|\beta_{1}| & <\alpha_{2},\gamma_{1}> & <\alpha_{3},\gamma_{1}> \\
 & |\beta_{2}| & <\alpha_{3},\gamma_{2}> \\
 &  & |\beta_{3}|
\end{pmatrix} = Q_{1} R
$$

(II) 求正交矩阵 $Q_2$ 和对角线元素为正数的下三角矩阵 $P$，使 $A = PQ_2$.

这里则通过一次转置来说明，由于 $A^{T} = Q_{1}R$ 因此 $A = R^{T}Q_{1}^{T} = PQ_{2}$