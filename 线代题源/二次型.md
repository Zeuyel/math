---
tags:
  - cheatsheet
  - 高数
  - 线代
  - 考研
---
> [!abstract] 二次型是实对称矩阵的应用
> 0. 核心理解：二次型是一个数，一个实数！！！
> 1. 二次型的等价转换  $A_{sym} \triangleq \frac{A + A^{T}}{2}$
> 	1. $x^{T}A_{sym}x = x^{T}Ax = x^{T}A^{T}x$ ，这是由二次型数的特性决定的
> 2. 如果我们有一个矩阵 $A$ ，进而计算得到二次型 $f(x_{1},x_{2},x_{3}) \triangleq x^{T}Ax$ ，此时就可以利用二次型数的特征，进行等价转化为 $x^{T}A_{sym}x$ 其中 $A_{sym}$ 为实对称矩阵。
> 	1. 二次型并不要求 $A$ 必须为 实对称矩阵。但是转换为实对称矩阵将带来其良好性质。
> 3. 实对称矩阵分解 的多项式的化简，由于 $A = Q^{T}\Lambda Q$ 
> 	1. $f(A)$ 通常被设计成 $Q^{T}(g(\Lambda))Q$ 其中 $g(\Lambda) = kE$
> 	2. 进一步的 $A = Q^{T}\Lambda Q = Q^{T}(B + kE)Q = Q^{T}BQ + kE$
> 4. 可逆变换（即合同变换）要小心，一步一步来计算
> 5. 规范形只需确定其正、负惯性指数！由$A$ 的特征值即可得到
> 6. 可逆线性变换要关注是对 系数矩阵的还是变量上操作的
> 7. 一方面，二次型的可逆变换等作为运算被考察。但是另一方面，二次型又是一个工具，能够由其性质推广即也可通过二次型的运算来考察矩阵的特征值从而考察行列式等性质。
> 8. 相似有谱分解定理，而正定即合同$E$ 则 $\exists D$ 可逆满足 $A = D^{T}D$ ，可以简称正定分解。

# 二次型的对应矩阵

## 简单转换

设 $\alpha$,$\beta$均为3维列向量, 二次型 $f = x^T \alpha \beta^T x$, 则下列关于 $f$ 的 秩的情况。

我们所要研究的二次型秩，对象是二次型矩阵。然而我们虽然有 $f = x^{T}\alpha\beta ^{T}x$ 但显然秩一矩阵 $\alpha\beta ^{T}$ 并不一定为实对称矩阵，我们需要进行转换。

我们说明一个基本的操作，也就是二次型对应一个标量，一个表达式，故而，其转置和自身相等，我们有：

$$
\begin{align}
x^{T}A x  & = x^{T} A^{T} x   \\
 & = x^{T} \frac{A + A^{T}}{2}  x
\end{align}
$$

因此我们可以得到二次型矩阵为 $A \triangleq \frac{\alpha\beta ^{T} + \beta\alpha ^{T}}{2}$ ，对于 $r(A)$ 我们有：

$$
r(A) = r(\alpha\beta ^{T} + \beta\alpha ^{T}) \le r(\alpha\beta ^{T}) + r(\beta\alpha ^{T}) = 2
$$

## 反对称部分

> 二次型是一个工具！！！

设 $n$ 阶矩阵 $A = (a_{ij})$ 满足 $a_{ij} + a_{ji} = 0$，则 E + A 为可逆矩阵。

$A$ 是 反对称矩阵，故而 $A = -A^{T}$ 进一步对于 $B \triangleq E + A$ 有 $B + B^{T} = 2E$

故而我们有：

$$
x^{T}Bx \equiv x^{T} \frac{B + B^{T}}{2}x = x^{T}Ex > 0
$$

> 这里由于 $B$ 并不是对称矩阵，我们需要进一步加入技术性细节，使用反证法来说明：

对于任意非零向量 $x \neq \mathbf{0}$，都有：

$$xT(E+A)x=xTx=∣∣x∣∣^{2}>0$$

若 E+A 不可逆。那么齐次线性方程组 $(A+E)x$ 必存在非零解 $\eta$（即 $(E+A)\eta=0, \eta \neq 0$），因此满足：

$$
\eta ^{T}(E+A)\eta=\eta ^{T}0=0
$$

矛盾

> 对于 $B$ 这种广义正定矩阵的三个性质
> 1. $\det(B) > 0$
> 2. 主子式恒大于 0
> 3. 可逆

## 化简

设二次型$f(x_1,x_2,x_3) = \sum_{i=1}^{3}(x_i - \bar{x})^2$，其中$\bar{x} = \frac{x_1 + x_2 + x_3}{3}$，记其对应的矩阵为A，则（）

整理 $f(x_{1},x_{2},x_{3})$

$$
\begin{align}
f(x_{1},x_{2},x_{3})  & = \sum _{i=1}^{3} (x_{i}^{2} -2\bar{x}x_{i} + \bar{x}^{2}) \\
 & =\sum x_{i}^{2} -2\bar{x} \sum x_{i} + 3\bar{x}^{2} \\
 & = \sum x_{i}^{2} - 6\bar{x} \bar{x} + 3 \bar{x}^{2} \\
 & = \sum x_{i}^{2} - 3 \bar{x}^{2} \\
 & = x_{1}^{2} + x_{2}^{2}+x_{3}^{2} - \frac{1}{3}\left( x_{1}^{2} + x_{2}^{2}+x_{3}^{2} + 2x_{1}x_{2} + 2x_{1}x_{3} + 2 x_{2}x_{3} \right) 
\end{align}
$$

因此对应矩阵为：

$$
A = E - \frac{1}{3} \begin{bmatrix}
1 \\
1 \\
1
\end{bmatrix} [1,1,1]
$$

故而可得到  $A$ 的特征值为 $0,1,1$ 得到 $E -A$ 的 特征值为 $1,0,0$ $E+A$ 的特征值为 $1,2,2$

## 特征向量特征值：瑞利商

设二次型$f(x_1,x_2,x_3) = x^T Ax$，其中$A$为实对称矩阵，且$A^2 - 2A - 3E = 0$。若$f$的正惯性指数为2,且$f(1,1,1) = -3$,求$f(1,2,-3)$。

> 没思路，其实可以顺着出题的点想，首先不可能是把 $A$ 解出来，那其实就只有可能是从特征值入手，或者说，由于无法解出 $A$ 此时题干给出的 $(1,1,1)$ 和 $(1,2,-3)$ 必然是有其特殊之处。

由 $A^{2} - 2A - 3E = 0$ 得到 $A$ 的特征值只有可能为 $3,-1$ 又 $f$  的正惯性系数为 $2$ 故而 $A$ 的 特征值为 $3,3,-1$

那么这里自然的想到特征向量，标答是用的瑞利商的证明过程，那我们也就直接使用瑞利商：

令 $α=(1,1,1)^{T}$，则有 $α^{T}Aα=−3$ , $αTα=12+12+12=3$

观察瑞利商：

$$\frac{αTAα​}{\alpha ^{T}\alpha}=​−1$$

恰好等于 A 的最小特征值 $-1$。对于实对称矩阵，当且仅当向量是特征向量时，瑞利商取得特征值。故而 $\alpha$ 为 $-1$  对应的特征向量。

此时又有 $\beta \triangleq (1,2,-3)^{T}$ $\beta$ 和 $\alpha$ 是正交的，那么对于实对称矩阵而言，不同特征值的特征向量之间相互正交，而同时由于 $-1$ 恰好是单根，他对应的特征向量只有一维不可能出现与 $\alpha$ 正交的情况。因此 $\beta$必定是对应于特征值 $\lambda = 3$ 的特征向量。 即 $A\beta = 3\beta \to \beta ^{T}3\beta = 3 \times 14 = 42$。 

> 重新理解一下特征空间！！！

# 标准型

## 合同变换

设 $A = \begin{pmatrix} a_1 & a_1 & a_1 \\ a_1 & a_1+a_2 & a_1+a_2 \\ a_1 & a_1+a_2 & a_1+a_2+a_3 \end{pmatrix}$, $B = \begin{pmatrix} a_1 \\ a_2 \\ a_3 \end{pmatrix}$。若存在可逆矩阵C, 使得
$C^T A C = B$, 则 $C =$ 

由于是实对称矩阵，我们有下述变换

$$
\left(
\begin{array}{c}
A\\
\vdots\\
E
\end{array}
\right)
=
\left(
\begin{array}{ccc}
a_1 & a_1 & a_1\\
a_1 & a_1+a_2 & a_1+a_2\\
a_1 & a_1+a_2 & a_1+a_2+a_3\\
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{array}
\right)
\;\Rightarrow\;
\left(
\begin{array}{ccc}
a_1 & 0 & 0\\
0 & a_2 & a_2\\
0 & a_2 & a_2+a_3\\
1 & -1 & -1\\
0 & 1 & 0\\
0 & 0 & 1
\end{array}
\right)
\;\Rightarrow\;
\left(
\begin{array}{ccc}
a_1 & 0 & 0\\
0 & a_2 & 0\\
0 & 0 & a_3\\
1 & -1 & 0\\
0 & 1 & -1\\
0 & 0 & 1
\end{array}
\right)
$$

> 注意行变换了列也要对应变换才是 $C^{T}AC$ 的合同变换。

则 $C = \begin{bmatrix}1 & -1 & 0 \\ 0 & 1 & -1 \\ 0 & 0 & 1\end{bmatrix}$

## 缺少二次项：配方换元

设二次型 $f(x_1,x_2,x_3) = 2x_1x_2 + 3x_2x_3 + 4x_1x_3$，求可逆线性变换 $x = Pz$，使得 $f(x_1,x_2,x_3)$ 化为标准形，并求二次型的秩及正、负惯性指数。

> 特征值也不好求，同时没有 $x_{1}^{2}$ 这样的项目，需要先换一次元。

$$
\begin{cases}
x_1 = y_1 + y_2 \\
x_2 = y_1 - y_2 \\
x_3 = y_3
\end{cases}
\to
x \triangleq Cy = \begin{bmatrix}
1 & 1 & 0 \\
1 & -1 & 0 \\
0 & 0 & 1
\end{bmatrix} y
$$

则 $f(x_1, x_2, x_3) = 2y_1^2 - 2y_2^2 + 7y_1y_3 + y_2y_3$ 

此时使用做如下变换，得到标准型：$f = 2 z_{1}^{2} - 2z_{2}^{2} - 6 z_{3}^{2}$

$$
y = \begin{bmatrix}
1 & 0 & -\frac{7}{4} \\
0 & 1 & \frac{1}{4} \\
0 & 0 & 1
\end{bmatrix} z, x = \begin{pmatrix} 1 & 1 & 0 \\ 1 & -1 & 0 \\ 0 & 0 & 1 \end{pmatrix} \begin{pmatrix} 1 & 0 & -\frac{7}{4} \\ 0 & 1 & \frac{1}{4} \\ 0 & 0 & 1 \end{pmatrix} z = \begin{pmatrix} 1 & 1 & -\frac{3}{2} \\ 1 & -1 & -2 \\ 0 & 0 & 1 \end{pmatrix} z
$$


因此 二次型的秩为 $3$ 负惯性系数为 $2$ 正惯性系数为 $1$

## 复杂配方：待定系数

设二次型$f(x_1,x_2,x_3) = 2x_1^2 + 5x_2^2 + 5x_3^2 + 4x_1x_2 - 4x_1x_3 - 8x_2x_3$  利用配方法,将$f$化为标准准形.

这里的关键在于有三个混合因式，那么我们一个一个配方即可，对于$x_{1}$ 有 $4x_{1}x_{2},-4x_{1}x_{3}$ 两项，我们待定为：

$$
2(x_{1} + ax_{2} + bx_{3})^{2} = \dots + 4x_{1}x_{2} - 4x_{1}x_{3} +\dots
$$
> 这里的$2$ 是 $x_{1}^{2}$ 前的系数，要盯住目标分析，我们现在的目的就是把含有 $x_{1}$ 的混合因式吸收了。

由二次项定理易得 $a = 1,b=-1$ 此时原式还剩下：

$$
3x_{2}^{2} + 3x_{3}^{2} - 4 x_{2}x_{3} = 3\left( x_{2} - \frac{2}{3}x_{3} \right)^{2} + \frac{5}{3} x_{3}^{2}
$$

$$
\begin{cases} 
y_1 = x_1 + x_2 - x_3 \\
 y_2 = x_2 - \frac{2}{3}x_3  \\
 y_{3} = x^{3}
\end{cases}

$$


矩阵 $\begin{pmatrix} 1 & 1 & -1 \\ 0 & 1 & -\frac{2}{3} \\ 0 & 0 & 1 \end{pmatrix}$ 可逆, 则 $f = 2y_1^2 + 3y_2^2 + \frac{5}{3}y_3^2$

# 正定

## 参数范围

设二次型 $f(x_1,x_2,x_3) = x^T Ax$ 平方项的系数为 0, 满足 $A\alpha = 2\alpha$, 其中 $\alpha = (1,2,-1)^T$.

这里的 $A$ 我们默认为实对称矩阵。则得到 

$$f(x_{1},x_{2},x_{3}) = 4 x_{1}x_{2} + 4x_{1}x_{3}- 4x_{2}x_{3}$$

计算的到特征值为 $2,2,-4$ 因此 **正交变换** 下的标准型为 

$$f = 2 y_{1}^{2} + 2y_{2}^{2} -4y_{3}^{2}$$

若 $A^3 + 2A^2 - 4A + kE$ 正定, 求k的取值范围.

显然 $A^{3} + 2A^{2} - 4A + kE$ 仍未实对称矩阵，因此我们可以直接计算其特征值：

$8+k,8+k,k-16$ 因此 $k > 16$ 时，正定

### 顺序主子式

若二次型 $f(x_1,x_2,x_3) = x_1^2 + 2x_2^2 + 2x_3^2 + 4tx_1x_2 + 2x_1x_3$ 是正定的，则 $t$ 的取值范围是 $\underline{\hspace{1cm}}$.

二次型 $f(x_1,x_2,x_3)$ 对应的对称矩阵为 $A = \begin{pmatrix} 1 & 2t & 1 \\ 2t & 2 & 0 \\ 1 & 0 & 2 \end{pmatrix}$， 此时我们可以通过各阶顺序主子式大于零来求解

一阶顺序主子式 $1 > 0$

二阶顺序主子式 $\begin{vmatrix}1 & 2t  \\ 2t & 2\end{vmatrix} = 2 - 4t^{2}$ 

三阶顺序主子式 $|A| = \begin{vmatrix} 1 & 2t & 1 \\ 2t & 2 & 0 \\ 1 & 0 & 2 \end{vmatrix} = 2- 8t^{2}$

故而解得 $-\frac{1}{2} < t \frac{1}{2}$


## 性质

> [!Note] 证明正定
> 1. 写出二次型，证明二次型大于零
> 2. 不要忘记，直接证明全部特征值大于零

> 往往还是回到 $f(x_{1},x_{2},\dots,x_{n})$ 上说明，因此也和矩阵性质一样，最好能够写出来。

1.  设$A$为$n$阶正定矩阵，$B$为$n$阶反对称矩阵，则$f(x_{1},x_{2},\dots,x_{n})= x^{T}(A-B^T)x$ 对应的矩阵为正定矩阵；

回到二次形上来思考，我们将有十分自然的结论，我们有：

$$
\begin{align}
f(x_{1},\dots,x_{n})  & = x^{T} (A - B^{T}) x = x^{T} \left[  \frac{A - B^{T} + A^{T} - B}{2} + \frac{A - B^{T} - (A^{T} - B)}{2} \right] x \\
 &  = x^{T} \frac{A - B^{T} + A^{T} - B}{2} x = x^{T} Ax
\end{align}
$$

> 反对称部分，会在计算中抵消。这也是为什么任意一个二次形都可以通过 $A = \frac{A + A^{T}}{2} + \frac{A - A^{T}}{2}$ 转换，而其中 $\frac{A - A^{T}}{2}$ 为反对称部分被抵消。而只剩下 $\frac{A + A^{T}}{2}$ 


2.  设$A$为$n$阶正定矩阵，$B$为$n$阶反对称矩阵，则$A-B^2$为正定矩阵；

$$
B^{2} = - B^{T}B \to (B^{2})^{T} = - B^{T}B, A - B^{2} = A+ BB^{T}
$$

> 那么看到 $B^{T}B$ 就应该想到模
> 我们在说明 $AA^{T}x$ 和 $Ax$ 同解的时候，使用的方法正是构造二次型来帮助我们解决线性方程组解得问题，进而说明特征值等等问题，

因此：

$$
f(x_{1},\dots,x_{n}) = x^{T}Ax + ||Bx||^{2} > 0
$$

3. 设$A,B$为$n$阶矩阵, 且$r(A+B)=n$, 则$A^T A+B^T B$为正定矩阵．

同样的结构：

$$
f(x_{1},\dots,x_{n}) = ||Ax||^{2} + ||Bx||^{2} \ge 0
$$

现在需要解决，等号的问题。断言 $||Ax||^{2} + ||Bx||^{2} > 0$ 若不然，则 $||Ax||^{2} = 0, ||Bx|| ^{2} = 0$ 即 $(A+B)x = 0$ 然而 $r(A+B) = 0$ 此时  $x$ 为零向量。

4. $A,B$ 正定 若 $AB$ 为正定矩阵，则 $AB = BA$ 

我们之前讨论过 要证明 $AB = BA$ 主要是要凑出 $\square \triangle = kE$ 或者实对称 [[线性代数字典#AB = BA]] 这里则是显然的，正定的前提是实对称矩阵。

5. $A,B$ 正定 若 $AB = BA$ ，则$AB$ 为正定矩阵。

$AB = BA$ 且 $A,B$ 都可逆，此时则有 $A,B$ 能够同时相似对角化，即存在正交矩阵 $Q$ 满足：

$$
Q^{T}AQ = \Lambda_{1}, Q^{T}BQ = \Lambda_{2} \to Q^{T}ABQ = \Lambda_{1}\Lambda_{2}
$$

则 $AB$ 合同 $\Lambda_{1}\Lambda_{2}$ ，其特征值都大于零。

6. 设 $A$ 是实对称矩阵, 证明 $A$ 可逆的充要条件是存在方阵 $B$, 使得 $AB+B^{T}A$ 为正定矩阵。

$(AB + B^{T}A)^{T} = B^{T}A^{T} + A^{T}B = B^{T}A + AB$ ，因此 $AB + B^{T}A$ 是实对称矩阵。

先说明充分性，只需取 $B = E$ 即可。对于必要性：

$$
C \triangleq AB
$$

我们有：

$$
x^{T}Cx \equiv x^{T} \frac{C+C^{T}}{2}x > 0
$$

因此 $C$ 是广义正定的，故而 $C$ 可逆，故而 $r(AB) = n \le r(A) \le n$ 故而 $A$ 可逆。

7. 设A，B为n阶正定矩阵，矩阵C为矩阵方程 $AX + XA = B$ 的唯一解。C为正定矩阵

对两边取转置：$(AX+XA)^{T}=B^{T}$ ，由$A,B$ 对称：$X^{T}A+AX^{T}=B$ 。这说明 XT 也是该方程的解。因为解的唯一性，所以 X=XT，即C 是对称矩阵。

我们有 $AC + CA = B \to AC + (AC)^{T} = B$ 故而我们有：

$$
(Ax)^{T}(Cx)= x^{T}ACx \equiv x^{T} \frac{AC +(AC)^{T}}{2} x \equiv x^{T} \frac{B}{2} x > 0
$$

故而 $r(AC) = n = r(C)$

> 这一题的背景是 Lyapunov 方程

那么为了说明正定，另一个角度就是对齐特征值进行分析：

设 

$$
Ca = \lambda a, \alpha \neq 0, \alpha^T B \alpha = \alpha^T AC \alpha + \alpha^T CA\alpha = \lambda \alpha^T A \alpha + (Ca)^T \alpha = 2 \lambda \alpha^T A \alpha
$$

因此得到

$$\lambda = \frac{\alpha^T Ba}{2\alpha^T Ac a} > 0$$

, 故C是正定矩阵。


8. 设A，B为n阶正定矩阵，矩阵C为矩阵方程 $AX + XA = B$ 的唯一解。存在n个线性无关的n维列向量 $\alpha_1, \alpha_2, ..., \alpha_n$，使得 $C = \alpha_1 \alpha_1^T + \alpha_2 \alpha_2^T + ... + \alpha_n \alpha_n^T$。

> 类似于谱分解的结构，回忆谱分解 $C = Q^{T}\Lambda Q$ 现在是  $C = D^{T}ED$  
> 继而，一个对应着正交相似对角化，一个对应着合同规范型。

显然 $C$ 合同到 $E$ 故而 $C = D^{T}D$ ，令 $D^{T}= (\alpha_{1},\alpha_{2},\dots,\alpha _{n})$  则 $\alpha_{1},\alpha_{2},\dots\alpha _{n}$ 线性无关，因此

$$
C = \alpha_{1} \alpha_{1}^{T} + \dots \alpha _{n}\alpha _{n}^{T}
$$

9. 10. 以下命题中：A是 $m \times n$ 矩阵，$B$ 是 $m$ 阶方阵，如果A列满秩，$B$ 为对称正定矩阵，则 $A^TBA$ 为正定矩阵。

 $\exists D$ 可逆 $s.t.\ B = D^{T}D$   则：

$$
x^{T}A^{T}BAx = (DAx)^{T}(DAx) = ||DAx||^{2}
$$

由于 $r(D) = n$ ，考察 $Ax = 0$ 由于 $A$ 是列满秩矩阵，故而仅有零解。

# 实对称矩阵分解 多项式

## 例题1

设三元二次型 $f(x, y, z) = x^T A x$ 经过正交变换化为标准形为 $y_1^2 - y_2^2 + 2y_3^2$，则
$A^2 - 2A^2 - A + 4E =$ 

由 $Q^T A Q = \Lambda = \begin{pmatrix} 1 \\ -1 \\ 2 \end{pmatrix}$, 得 $A = Q \Lambda Q^T$，故

$$
A^3 - 2A^2 - A + 4E = Q
\left[ 
\begin{pmatrix} 1^3 &  &  \\ &  (-1)^3 &  \\  &  & 2^3 \end{pmatrix} - 
2 \begin{pmatrix} 1^2 &  &  \\  & (-1)^2  & \\  &  &  2^2 \end{pmatrix} -
\begin{pmatrix} 1 &  &  \\  & -1  & \\  &  & 2 \end{pmatrix} + 
4 \begin{pmatrix} 1  &  & \\  & 1 & \\ &  &  1 \end{pmatrix}
\right]  Q^{T}
$$

$$=Q(2E)Q^T = 2E$$

对于选择题，我们直接特值法：令 $A = \begin{pmatrix} 1  &  & \\  & -1 &  \\  &  & 2 \end{pmatrix}$, 则 $A^3 - 2A^2 - A + 4E = 2E$.

## 例题2

设 $A = \frac{1}{3} \begin{pmatrix} a & -2 & 2 \\ -2 & 2 & b \\ 2 & c & 2 \end{pmatrix}$ ($b>0, c>0$) 是正交矩阵。

(I) 求 $a, b, c$ 的值；

先使用正交矩阵的必要条件，也就是每一列的内积为 $1$ 得到 $a,b,c$ 的取值。其中 $a = \pm 1$ 此时再使用 第一列和第二列正交解出$a$ 是较为简便的方式。

(21) 解 (I) 由正交矩阵的列(行) 向量是两两垂直的单位向量,有

$$(\frac{a}{3})^2 + (-\frac{2}{3})^2 + (\frac{2}{3})^2 = 1$$

$$(-\frac{2}{3})^2 + (\frac{2}{3})^2 + (\frac{2}{3})^2 = 1$$

$$(\frac{2}{3})^2 + (\frac{b}{3})^2 + (\frac{2}{3})^2 = 1$$


又已知 $b>0, c>0$，故可解得 $a = \pm 1, b = 1, c = 1$.

当 $a=1$ 时, 第1列为$\begin{bmatrix} 1 \\ -2 \\ 2 \end{bmatrix}$ 与第2列$\begin{bmatrix} -2 \\ 2 \\ 1 \end{bmatrix}$ 不正交,故 $a = -1$.

综上所述,$a = -1, b = 1, c = 1$.

(II) 求可逆矩阵 $P$，使得 $A^2 = P^T P$.

计算可得 $P$ 的特征值为 $1,1,-1$ 故而：

$$
A^{2} = Q \Lambda ^{2} Q^{T} = QQ^{T} = E
$$

因此可取 $P = Q, P= Q^{-1},P=E$  

## 加法分解

【例52】设3阶实对称矩阵A满足$A^T\alpha = \alpha$，其中$\alpha = (-1, -1, 1)^T$。若存在正交矩阵Q，使得

$$Q^T A Q = \Lambda = \begin{pmatrix}
-1 & 0 & 0 \\
0 & -1 & 0 \\
0 & 0 & 2
\end{pmatrix}$$

求矩阵A

特征值 $\lambda_1 = \lambda_2 = -1$ 的特征向量为 $\alpha_1 = (-1,1,0)^T$, $\alpha_2 = (1,1,2)^T$

单位化：

$$\gamma_1 = \frac{1}{\sqrt{2}} (-1,1,0)^T ,  \gamma_2 = \frac{1}{\sqrt{6}} (1,1,2)^T ,  \gamma_3 = \frac{1}{\sqrt{3}} (-1,-1,1)^T ,  O = (\gamma_1, \gamma_2, \gamma_3) $$


$$Q^T (A + E) Q = \begin{bmatrix} 0  &  &   \\ &  0  & \\  &  & 3 \end{bmatrix} $$


得 $A+E = 3 \gamma_3 \gamma_3^T = \begin{bmatrix} 1 & 1 & -1 \\ 1 & 1 & -1 \\ -1 & -1 & 1 \end{bmatrix}$, $A = \begin{bmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & -1 & 0 \end{bmatrix}$


# 等价、相似与合同

> 等价看秩，合同做尝试，相似看正交

## 合同求变换矩阵

> 最通用的思路是将两个矩阵变换到同一个规范型，即 $E = C^{T}_{1}AC_{1} = C^{T}_{2}BC_{2}$ 故而 有 $A = (C_{1}C_{2}^{-1})BC_{1}C_{2}^{-1}$  这里涉及到求 $C_{1}C_{2}^{-1}$ 应当整体求解。同时也可以考虑做正交变换这样逆就被转化为简单的转置。
> 但是有些时候对于简单的转换我们可以通过直接而不借助规范型来做到。

已知$A=\begin{pmatrix} 1 & -1 & 1 \\ -1 & 2 & -2 \\ 1 & -2 & a \end{pmatrix}$ $B=\begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & b \\ 0 & 2 & 1 \end{pmatrix}$ 其中a为小于4的正整数

若存在可逆矩阵C,使得$C^TAC=B$

(1)求a和b

$B^{T} = C^{T}A^{T}C = C^{T} AC = B$ 故而 $b = 2$ 进一步的，我们有 $A$ 与 $B$ 合同。$B$ 正定得到 $|A| > 0$ 化简得到 $a > 2$ 因此 $a = 3$

(2)求出—个矩阵C

> 将二次型作为工具，有些时候配方比合同的操作简便许多。


我们通过简单的合同变换，发现 $A$ 能够变换为 $D \triangleq \begin{pmatrix}1 & 0 & 0 \\ 0 & 1 & -1  \\ 0 & -1 & 2\end{pmatrix}$ 对应的变换为：$x = \begin{pmatrix}1  & 1 & -1 \\ 0 & 1 & 0 \\ 0 & 0 & 1\end{pmatrix} y$ 我们发现 $D$ 和 $B$ 之间非常的相似了，此时我们可以再做一次合同变换 $y = \begin{pmatrix}1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & -1\end{pmatrix}z$ ，为了避免直接写合同和做一次检查，我们可以根据合同结果写出两次对应的配方：

> 因此，合同最好是初等行变换对应的矩阵，这样写逆非常简单。

第一个变换对应的换元是 $y = \begin{pmatrix}1 & - 1 & 1 \\0 & 1 & 0  \\ 0 & 0 & 1 \end{pmatrix}x$  得到 $y^{T}Dy$故而我们换元回去得到：

$$
f(x_{1},x_{2},x_{3}) = (x_{1} - x_{2} + x_{3})^{2} + x_{2}^{2} + 2x_{3}^{2} - 2 x_{2}x_{3}
$$

同理将 $z$ 换元到 $y$ 得到第二次对应的配方方式。（当然，由于这里的矩阵比较简单我们也可以 直接对 $x = \begin{pmatrix}1 & 1 & 1   \\ 0 & 1 & 0 \\ 0 & 0 & -1\\ \end{pmatrix}z$ 做逆向换元从而直接得到。）

我们来看到 2020年数二的真题：设二次型 $f(x_1,x_2,x_3) = x_1^2 + x_2^2 + x_3^2 + 2ax_1x_2 + 2ax_2x_3+ 2a x_{1}x_{3}$，经可逆线性变换 $x = Py$。 化为二型 $g(y_1,y_2,y_3) = y_1^2 + y_2^2 + 4y_3^2 + 2y_1y_2$.

(1) 求 $a$ 的值； $a = \frac{1}{2}$

(2) 求可逆矩阵 $P$.

$$
A \triangleq \begin{pmatrix}
1 & -\frac{1}{2}  & -\frac{1}{2} \\
-\frac{1}{2} & 1 & -\frac{1}{2} \\
-\frac{1}{2} & -\frac{1}{2} & 1
\end{pmatrix}, B \triangleq \begin{pmatrix}
1 & 1 & 0  \\
1 & 1 & 0 \\
0 &  0 & 4
\end{pmatrix}
$$

> [!draft]
> 草稿上验算合同变换：
> 
> $$
> D = C_{1}^{T}AC_{1} =
> \begin{pmatrix}
> 1 & 0 & 0 \\
> 0 & \frac{3}{4} & -\frac{3}{4} \\
> 0 & -\frac{3}{4} & \frac{3}{4}
> \end{pmatrix}
> , C_{1} = \begin{pmatrix}
> 1  &  \frac{1}{2}  & \frac{1}{2} \\
> 0 & 1 & 0 \\
> 0 & 0 & 1
> \end{pmatrix}
> $$
> 
> > 我们用二次型配方的方式来表示。

考察：

$$
f(x_{1},x_{2},x_{3}) = \left( x_{1}-\frac{1}{2}x_{2} - \frac{1}{2}x_{3} \right)^{2} + \frac{3}{4}x_{2}^{2} +  \frac{3}{4} x_{3}^{2} - \frac{3}{2} x_{2}x_{3}
$$

> 这里的的系数是 $C_{1}^{-1}$ ，相当于从 $z$ 换元回 $x$ ，$z = C_{1}^{-1}x$

则有：

$$
f(x_{1},x_{2},x_{3}) \overset{x = C_{1}z}{\to} h(z_{1},z_{2},z_{3}) = z_{1}^{2} + \frac{3}{4}z_{2}^{2} + \frac{3}{4}z_{3}^{2} - \frac{2}{3} z_{2}z_{3} = z_{1}^{2} + \left(  \frac{\sqrt{ 3 }}{2} z_{2} - \frac{\sqrt{ 3 }}{2} z_{3} \right)^{2}
$$

对于$g(y_{1},y_{2},y_{3}) = y_{1}^{2} + y_{2}^{2} + 4 y_{3}^{2} + 2y_{1}y_{2} = (y_{1}+y_{2})^{2} + (2y_{3})^{2}$ 故而换元：

$$
\begin{cases}
z_{1} = 2y_{3} \\
\frac{\sqrt{ 3 }}{2} z_{2} = y_{1} \\
-\frac{\sqrt{ 3 }}{2} z_{3} = y_{2}
\end{cases} \to z =C_{2}y = \begin{pmatrix}
0 & 0 & 2 \\
\frac{2}{\sqrt{ 3 }} & 0 & 0 \\
0 & -\frac{2}{\sqrt{ 3 }} & 0
\end{pmatrix}y
$$

则有：

$$
\begin{align}
 & h(z_{1},z_{2},z_{3}) \overset{z = C_{2}y}{\to} g(y_{1},y_{2},y_{3}) \\ 
 & f(x_{1},x_{2},x_{3}) \overset{x = C_{1}C_{2}y}{\to} g(y_{1},y_{2},y_{3})
\end{align}
$$

故而取 $P = C_{1}C_{2}$

## 相似求正交矩阵

设二次型 $f(x_1, x_2) = x_1^2 - 4x_1x_2 + 4x_2^2$ 经过正交变换 $\begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = Q \begin{pmatrix} y_1 \\ y_2 \end{pmatrix}$ 化为二次型 $g(y_1, y_2) = ay_1^2 + 4y_1y_2 + by_2^2$, 其中 $a \geq b$.

(I) 求 $a, b$ 的值;
(II) 求正交矩阵 $Q$.

$A \triangleq \begin{pmatrix}1 & -2  \\ -2 & 4\end{pmatrix}$  $B \triangleq \begin{pmatrix} 4 & 2  \\ 2 & 1\end{pmatrix}$

借助 $A \sim B \to Q_{1}^{T}A Q = \Lambda =  Q_{2}^{T}B Q_{2}$ 得到$B = (Q_{1}Q_{2}^{-1})^{T}A(Q_{1}Q_{2}^{-1})$

记 $Q = Q_{1}Q_{2}^{-1} = Q_{1}Q_{2}^{T}$ 

那么 $A,B$ 的特征值为 $5,0$ 对于 $\lambda = 5$ 则有：

$$
\alpha_{1} = \begin{pmatrix}
1 \\
-2
\end{pmatrix}, \beta_{1} = \begin{pmatrix}
2 \\
1
\end{pmatrix}
$$

对于 $\lambda = 0$ 则有：

$$
\alpha_{2} = \begin{pmatrix}
2 \\
 1
\end{pmatrix}, \beta_{2} = \begin{pmatrix}
1 \\
-2
\end{pmatrix}
$$
正交化 $\gamma_{1}' = \frac{1}{\sqrt{ 5 }} \alpha_{1},\gamma_{2}' = \frac{1}{\sqrt{ 5 }} \alpha_{2}; \gamma_{1}'' = \frac{1}{\sqrt{ 5 }}\beta_{1},\gamma_{2}''= \frac{1}{\sqrt{ 5 }}\beta_{2}$后则有：

$$
Q_{1} = (\gamma_{1}',\gamma_{2}'),Q_{2} = (\gamma_{1}'',\gamma_{2}'')
$$

$Q=Q_1Q_2^{T}=\begin{pmatrix} \frac{4}{5} &  \frac{3}{5} \\  \frac{3}{5} &  \frac{4}{5} \end{pmatrix} \Rightarrow B=Q^{T}AQ$

## 惯性系数

### 线性变换

二 次 型 $f(x_1,x_2,x_3) = (x_1 + 2x_2)^2 + (2x_3 - 3x_2)^2 - (x_1 - x_3 + 2x_2)^2$ 的正惯性指数与负惯性指数依次为( )

做线性变换为

$$
\begin{cases}
y_1 = x_1 + 2x_2 \\
 y_2 = 2x_3 - 3x_2
\end{cases}
$$

此时 $x_1 - x_3 + 2x_2 = y_1 + y_2$ 

那么 取 $y_{3} = x_{3}$ 则变换为可逆性变换。在该变换下，二 次 型 $f(x_1,x_2,x_3)$ 化为

$$g(y_1,y_2,y_3) = y_1^2 + y_2^2 - (y_1 + y_2)^2 = -2y_1y_2 \overset{y = Cz}{\to} -2z_{1}^{2} + 2z_{2}^{2} $$

### 分块矩阵的合同变换

设 $A$ 为 $n$ 阶实矩阵，$A \neq A^T$, $B = \begin{pmatrix} E & A \\ A^T & O \end{pmatrix}$ , 则( )

(A) 不存在非零向量 $\alpha$, 使得 $\alpha^T A \alpha = 0$.

我们有$\alpha ^{T}A\alpha \equiv \alpha ^{T} \frac{A+A^{T}}{2}\alpha$ 而对于 $\frac{A+A^{T}}{2}$ 而言，并无充分证据说明其正定。

(B) 不存在非零向量 $\alpha$, 使得 $\alpha^T B \alpha = 0$.

$B$ 已经是实对称了，故而我们合同变换：

$$
B \to \begin{pmatrix}
\mathbf{E} & \mathbf{O} \\
\mathbf{ O} & -A^{T}A
\end{pmatrix}
$$

因此其惯性系数取决于 $-A^{T}A$

(C) 若对任意 $\mathbf{y} \neq 0$, 都有 $\mathbf{y}^T A^T A \mathbf{y} \neq 0$, 则 $B$ 的正惯性指数大于 $n$.

此时 $A^{T}A$ 正定，故而 $-A^{T}A$ 负定，因此 $B$ 的 正惯性系数和负惯性系数都等于 $n$

(D) 若非零向量 $\alpha, \beta$ 满足 $A^T \alpha = \alpha, A \beta = - \beta$, 则 $(\alpha^T, \beta^T)B \begin{pmatrix} \alpha \\ \beta \end{pmatrix} > 0$.

我们直接拆开，注意左右的顺序：

$$
(\alpha ^{T},\beta ^{T}) \begin{pmatrix}
\alpha + A\beta \\
A^{T}\alpha
\end{pmatrix} = \alpha ^{T}(\alpha + A\beta) + \beta ^{T}(A^{T}\alpha) =  \alpha ^{T}\alpha - \alpha ^{T}\beta + \beta ^{T}\alpha = \alpha ^{T}\alpha > 0
$$

### 行列式

设二元型 $f(x_1,x_2,x_3) = x_1^2 + ax_2^2 + x_3^2 + 2x_1x_2 + 2ax_1x_3 + 2x_2x_3$ 的正，负惯性指数分别为$p$、$q$，则$a = \_\_\_$,

二次型 $f(x_1, x_2, x_3)$ 对应的对称矩阵为 $A = \begin{pmatrix} 1 & 1 & a \\ 1 & a & 1 \\ a & 1 & 1 \end{pmatrix}$ 。由于 $f$ 的正、负惯性指数相同，故 $A$ 的秩可能为 0 或 2。又由 $A \neq 0$ 可得 $r(A) = 2 < 3$，于是 $|A| = 0$，即


$$\begin{vmatrix} 1 & 1 & a \\ 1 & a & 1 \\ a & 1 & 1 \end{vmatrix} = (a+2) \begin{vmatrix} 1 & a-1 & 0 \\ 1 & 0 & -1 \\ a & 1 & 0 \end{vmatrix} = -(a+2)(a-1)^2 = 0$$

解得 $a = 1$ 或 $-2$。当 $a = 1$ 时， $r(A) = 1$ 不符合要求，因此， $a = -2$.

> 1. 计算该行列式时应该把第一列和第三列调换，然后分解秩一得到答案。
> 2. 不要忽略了正负惯性指数可能为0 的情况。


## 相似合同判定

### 辨析引入

设 $A, B$ 为 $n$ 阶可逆矩阵，则存在 $n$ 阶可逆矩阵 $P$，使得
$$
PA=B, P^{-1}ABP=BA, P^{-1}AP=B, P^T A^2 P = B^2
$$
成立的个数是【 】
(A) 1 (B) 2 (C) 3 (D) 4

> 等价对于同形矩阵而言仅要求秩相等。

1. $PA$ 是满秩的，$P$ 可以把 $A$ 的 行线性组合成 $B$ 的行。换句话说，$A$ 和 $B$ 的行空间是等价的，这是由于，他们的行空间都是满秩的。
2. 取 $P = A$ 即可
3. $A$ 和 $B$ 不一定相似
4. $A^{2}$ 的特征值都是正的（因为 $A$ 可逆，$A$ 的 特征值都是正的）

### 例题

设A为3阶实对称矩阵，3阶正交矩阵 $P=(\alpha_1, \alpha_2, \alpha_3)$ 满足 $P^T AP = \begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 2 \end{pmatrix}$。

若 $Q = (\alpha_1 + \alpha_2, \alpha_2, \alpha_3)$, 

$\alpha_{1},\alpha_{2}$ 是特征值为 $1$ 的 特征向量，$\alpha_{3}$ 是特征值为 $2$ 的特征向量，又因为 $A$ 是实对称矩阵，因此 $\alpha_{1} + \alpha_{2}$ 也是$1$对应的特征向量。 

然后判断 $Q$ 的正交性质，显然并不正交，而且也不单位。故而我们有

$$
C \triangleq Q^{-1}AQ, D \triangleq Q^{T}AQ
$$

则， C 与A相似，A和D仅仅合同，故而 $C$ 和 $D$ 仅仅合同但不相似。

### 并不同时相似对角化


设 $A$ 为 $n$ 阶正定矩阵, 特征值为 $\lambda_n \ge \lambda_{n-1} \ge \dots \ge \lambda_1 > 0$, $Q$ 为正交矩阵, 则下 命题 题的 正确命题的个数是( )

① $A + Q^T A^{-1} Q$ 是正定矩阵.
② $A + Q^T A^{-1} Q$ 的最小特征值为 $\lambda_1 + \frac{1}{\lambda_1}$.
③ $A + Q^T A^{-1} Q$ 的最大特征值为 $\lambda_n + \frac{1}{\lambda_n}$.
④ 若 $\alpha$ 为 $A$ 的特征向量, 则 $Q^T \alpha$ 为 $Q^T A^{-1} Q$ 的特征向量.

对于 $1$ 来说，两个正定矩阵相加一定也是正定的。

对于$4$ 来说，我们有：

$$
P^{-1}A^{-1}P = \Lambda_{1} ^{-1} \to Q^{T}A^{-1}Q = Q^{T}P\Lambda_{1}^{-1} P^{-1}Q
$$

故而 $Q^{T}\alpha$ 是对应的特征向量。

实际上，$B = Q^{T} A^{-1}Q \sim A^{-1}$

然而对于 $2,3$ 关键在于 $A$ 和 $A^{-1}$ 是可以同时相似对角化的，也就是：

$$
P^{-1}AP = \Lambda_{1}, P^{-1}A^{-1}P = \Lambda_{2} \to P^{-1}(A+A^{-1})P = \Lambda_{1} + \Lambda_{2}
$$

然而我们已经说明 $Q^{T}A^{-1}Q$ 和 $A,A^{-1}$ 的 特征向量并不对应。故而无法相加，更无法说明最值。我们仅知道其正定。

### 分块矩阵

设 $A$ 为 $n$ 阶实矩阵，$A \neq A^T$， $B = \begin{pmatrix} E & A \\ A^T & 0 \end{pmatrix}$，则下列矩阵中，可能与 $B$ 合同的是( )

(A) $\begin{pmatrix} E_n & 0 \\ 0 & E_n \end{pmatrix}$.

(B) $\begin{pmatrix} E_n & 0 \\ 0 & -E_n \end{pmatrix}$.

(C) $\begin{pmatrix} E_p & 0 \\ 0 & -E_q \end{pmatrix}$,其中 $p > q$.

(D) $\begin{pmatrix} E_p & 0 \\ 0 & -E_q \end{pmatrix}$,其中 $p < q$.

事实上 $B$ 通过合同变换得到：

$$
\begin{pmatrix}
E & \mathbf{O } \\
\mathbf{O }  & -A^{T}A
\end{pmatrix}
$$

关键在 $A^{T}A$ ，我们有：

$$
x^{T}A^{T}Ax = ||Ax||^{2} > 0, x \neq \mathbf{0}
$$

因此 $A^{T}A$ 是正定的，故而 $B$ 正负惯性系数都是 $n$

### 具体矩阵判断

(9)设矩阵 $A=\begin{pmatrix} a & b & b \\ b & a & b \\ b & b & a \end{pmatrix}$, $B=\begin{pmatrix} b & b & a \\ b & a & b \\ a & b & b \end{pmatrix}$, $C=\begin{pmatrix} b & a & b \\ a & b & b \\ b & b & a \end{pmatrix}$ ,A,B,C 均可逆,则( )

> 都是实对称矩阵，因而，相似只要看特征多项式的根即可。

先看迹，$tr(A) = 3a,tr(B) = 2b + a, tr(C) = 2b + a$

故而$A$ 和 $B,C$ 都不相似。

$A$ 可以分解为秩一，比较容易的写出特征值为：$a+2b,a-b,a-b$

又有 $|A| = -|B| = -|C|$ 故而也不合同（若不然特征值全为零）

因此考察 $B$ 与 $C$ 

> 选择题可以直接代入 $0,1$ 求解，这里标答给了一个需要注意力惊人的合同变换然后恰好是正交的合同，故而得出相似。

首先先关注，对角线元素，$b,a,b$ 和 $b,b,a$  那么尝试 $x_{2},x_{3}$ 前面的系数互换，得到一个可逆线性变换为：

$$
P = \begin{pmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{pmatrix}
$$

对于初等变换而言是自然正交并且单位化的，故而这是一个正交变换。因此 $B,C$ 是相似的继而合同。

(A) A,B 不相似但合同.
(B) B,C 既相似又合同.
(C) A,C 不相似但合同.
(D) B,C 不相似但合同.

### $AA^{T}$

【例 6.6】设 $A$ 为 $m \times n$ 阶矩阵，且 $r(A) = m$，则下列结论
① $AA^T$ 与单位矩阵等价；

先明确形状， $AA^{T} \in \mathbb{R}^{m \times m}$

这里在说明一次 $A$ 和 $AA^{T}$ 的性质，这里的根源于两个方程组：

$$
\begin{cases}
Ax = 0 \\
A^{T}Ax = 0
\end{cases}
$$

> 要明确方程组确定空间关系，进而能够确定秩。

对于 $\forall x , s.t. Ax = 0 \implies A^{T}Ax = 0$
对于$\forall x s.t. A^{T}Ax = 0 \implies x^{T}A^{T}Ax = ||Ax||^{2}= 0 \to Ax = 0$ 

故而方程组等价，其行空间相等。进一步行秩相等，故而 $r(A^{T}A) = r(A) = m$

故而与单位矩阵等价。


② $AA^T$ 与对角矩阵相似；

$(AA^{T})^{T} = A^{T}A$ 故而为实对称矩阵，必然能够相似对角化。

③ $AA^T$ 与单位矩阵合同；
④ $AA^T$ 正定。

$x^{T}AA^{T}x = ||A^{T}x||^{2} > 0, x \neq \mathbf{0}$ 故而正定，与单位矩阵合同。

### 给出变换

设$A$是$n$阶方阵,将$A$的第$i$列与第$j$列互换,再交换第$i$行与第$j$行得到$B$,则($ )$.

将$A$的第$i$列与第$j$列互换,再交换第$i$行与第$j$行 对应同一个初等变换矩阵。互换矩阵是正交并且实对称的。也就是我们有：

$$
Q^{T}AQ = B
$$

> 一般合同所要求的转置关系比较容易满足。然而，不要忘记再做正交的检验。

A. $A$与$B$等价、相似且合同
B. $A$与$B$相似、合同但不等价
C. $A$与$B$相似但不合同
D. $A$与$B$等价但不相似
# 二次型最值

> 这里同样也可以运用瑞利商。$\lambda _{min} \le \frac{x^{T}Ax}{x^{T}x} \le \lambda _{max}$

设二次型 $f(x_1,x_2,x_3) = 3x_1^2 + 4x_2^2 + 3x_3^2 + 2x_1x_3$.

(I) 求正交变换 $x=Qy$，将二次型化为标准形；

(II) 证明 $\min_{x \neq 0} \frac{f(x)}{x^T x} = 2$.

我们有 $x = Qy, x^{T}x = y^{T}y$ 故而只需证明：

$$
\min _{x \neq 0} \frac{g(y)}{y^{T}y} = 2
$$

又有：

$$
g(y) = 2y_{1}^{2} + 4y_{2}^{2}+4y_{3}^{2} \ge 2(y_{1}^{2}+y_{2}^{2}+y_{3}^{2})= 2 y^{T}y
$$

需要说明 $2(y_{1}^{2} + y_{2}^{2}+y_{3}^{2})$ 是 $2y_{1}^{2}+4y_{2}^{2}+4y_{3}^{2}$ 的下确界，若不然，$0 > 2y_{2}^{2}+2y_{3}^{2}$ 。