---
tags:
  - 考研
  - 大题
  - math
  - cheatsheet
---
> [!abstract] 多维随机变量
> 1. 二维正态分布
> 2. 二元随机变量函数的分布
> 	1. 公式法：求得的是概率密度。[[#连续：变量替换]]
> 	2. 定义法：求得的是分布函数
> 	3. 如果是两个正态分布的随机变量的线性组合，此时直接算其期望和方差可能更加简便。
> 3. $support$ 的准确把握，画准确了才有后续的一些列操作。
> 4. 二维随机变量，对应的事件 $P\{ X \le x, Y \le y \}$ 实际上只把 $\Omega$ 划分为四个区间中的一个！！！
> 5. 边缘密度，条件密度，概率密度 和 分布函数的转换。
> 6. $Possion$ 积分
> 7. 均匀分布可以直接计算$support$ 的面积！
> 8. 后续简单抽样分布也可能考察这一部分内容。

# 概念题

设随机变量 $X_1$ 与 $X_2$ 同分布， $Y_1$ 与 $Y_2$ 同分布，则( ).

A. $X_1 + Y_1$ 与 $X_2 + Y_2$ 同分布
B. $X_1 - Y_1$ 与 $X_2 - Y_2$ 同分布
C. $(X_1, Y_1)$ 与 $(X_2, Y_2)$ 同分布

没有 $X_{1},Y_{1}$ 以及 $X_{2},Y_{2}$ 各自的联合分布！，我们只知道他们计算的到的边缘分布。显然边缘难以推定联合分布。而上面三个选项都需要，关于联合分布的关系。对于 D 则是边缘分布即可：

D. $kX_1$ 与 $kX_2$ 同分布, $kY_1$ 与 $kY_2$ 同分布 (常数 $k \neq 0$)

# 分布即事件

设随机变量 $X_1,X_2,X_3$ 相互独立, 其中 $X_1$ 与 $X_2$ 均从标准正态分布, $X_3$ 的概率分布为 $P\{X_3=0\} = P\{X_3=1\} = \frac{1}{2} , Y=X_3X_1 + (1-X_3)X_2$.

(I) 求二维随机变量 $(X_1,Y)$ 的分布函数, 结果用标准正态分布函数 $\Phi(x)$ 表示;

分布函数实则求事件，即：

$$
P\{ X_{1} \le x, Y \le y \} = \frac{1}{2}P\{ X_{1} \le x, X_{1} \le y \} + \frac{1}{2} P\{ X_{1} \le x, X_{2} \le y \}
$$

那么我们需要分 $x,y$ 大小来讨论了，当$x \le y$ 

$$
P\{ X_{1} \le x, Y \le y \} = \frac{1}{2} P\{ X_{1} \le y \} + \frac{1}{2}P\{ X_{1} \le x \} P\{ X_{2} \le y \} = \frac{1}{2} \Phi(y) + \frac{1}{2} \Phi(x)\Phi(y)
$$

当 $x > y$ 则为：

$$
P\{ X_{1} \le x, Y \le y \} = \frac{1}{2} \Phi(x) + \frac{1}{2} \Phi(x)\Phi(y)
$$

(II) 证明随机变量 Y 服从标准正态分布。

$$
P\{ Y \le y \} = \frac{1}{2}P\{ X_{1}\le y \} + \frac{1}{2} P\{ X_{2} \le y \} = \frac{1}{2} \Phi(y) + \frac{1}{2} \Phi(y) = \Phi(y)
$$



# 二元随机变量函数

## 混合

设二维随机变量(X,Y)在区域 $D = \{(x,y) \mid 0 < x < 1, x^2 < y < \sqrt{x}\}$ 上服从均匀分布，令 $U = \begin{cases} 1, & X \le Y, \\ 0, & X > Y. \end{cases}$ 

(1) 写出(X,Y)的概率密度；

均匀分布实则求积分算面积。

$$
\iint _{(x,y)\in D} 1 dxdy = \frac{1}{3}
$$

因此：

$$
f(x,y) = \begin{cases}
3,  & (x,y) \in D \\
0,  & others
\end{cases}
$$

(2) 问U与X是否相互独立？并说明理由；

> 证明独立回到定义，然而证明不独立只要举出例子即可了。因此首先应当思考一下，显然举例子是一个好的切入点。

由于是均匀分布，可以直观的几何概型计算，我们需要考察：$\{ U = u_{1} \}$, $\{ X \le x \}$, $\{ U = u_{1}, X \le x \}$ 对应的面积，这是比较简单的。事实上，我们有：

![[Pasted image 20251201163410.png]]

显然不一定有 $(a)(b) = (c)$ 的恒等，我们这里取 $u_{1} = 0, x = \frac{1}{2}$ 计算：

$$
P(U=0)=P(X>Y)=\frac{1}{2}
$$

$$
P(X \le \frac{1}{2}) = \int_{0}^{1} \sqrt{x-x^2} dx = \frac{\sqrt{2}}{2} \cdot \frac{1}{8} = \frac{1}{3}
$$

$$
P(U = 0, X \le \frac{1}{2}) = P(X > Y, X \le \frac{1}{2}) = \int_{0}^{1} (x - x^2) dx = \frac{1}{3} \cdot \frac{1}{4}
$$
因此不独立。

(3) 求$Z = U + X$的分布函数 $F(z)$.

> 先回到事件的化简上，然后在考虑公式法（或者定义法），显然我们上面已经算出了 $(X,Y)$ 的联合分布了，这指出了化简的方向。同时第二题也在为事件的化简做前提准备。

$$
\begin{align}
P\{ Z \le z \}  & = P\{ U + X \le z \}  \\
 & = P\{ U + X \le z| U = 0 \} P\{ U = 0 \} + P\{ U + X \le z|U = 1 \} P\{ U = 1 \}  \\
 & = P\{ U + X \le z, U = 0 \} + P\{ U + X \le z, U = 1 \} \\
 & = P\{ X \le z , X > Y\} + P\{ X \le z - 1, X \ge Y \}
\end{align}
$$


① 当 $z<0$ (即 $z-1<0$) 时，$F(z) = 0$;

② 当 $0 \le z < 1$ (即 $-1 \le z-1 < 0$) 时，$F(z) = \frac{\int_{0}^{z} (x-x^2)dx} {\frac{1}{3}} + 0 = -\frac{3}{2}z^2 - z^3$;

当 $1 \leq z < 2$ (即 $0 \leq z-1 < 1$) 时，$F(z) = \frac{1}{2} + \frac{\int _{0}^{z-1} \sqrt{ x } - x dx}{ \frac{1}{3}} = \frac{1}{2} + 2(z-1)^{\frac{3}{2}} - \frac{3}{2} (z-1)^2$;


当 $z \geq 2$ (即 $z-1 \geq 1$) 时，$F(z) = \frac{1}{2} + \frac{1}{2} = 1$. 

故而：

$F(z) = \begin{cases} 0, & z < 0, \\ \frac{3}{2} z^2 - z^3, & 0 \leq z < 1, \\ \frac{1}{2} + 2(z-1)^2 - \frac{3}{2} (z-1)^2, & 1 \leq z < 2, \\ 1, & z \geq 2. \end{cases}$


## 连续：变量替换

> 这里使用一次公式法，有时候公式法比较方便

(3) (07—1.3) 设二维随机变量 $(X,Y)$ 的概率密度为 

$$f(x,y) = \begin{cases}
2-x-y, & 0<x<1,0<y<1, \\
0, & \text{其他}.
\end{cases}$$

(I) 求 $P\{X>2Y\}$;
(II) 求 $Z=X+Y$ 的概率密度 $f_Z(z)$.

题目已经给出了联合分布和对应的 $support$

$$
\begin{align}
P\{ X > 2 Y \}  &  = \int _{0}^{1} \int _{0}^{x/2} f(x,y)dy  dx = \frac{7}{24}
\end{align}
$$

这里 $Z = X + Y$ 使用变量替换来做比较方便，我们 给出一个 $Z = g(X,Y)$ ，其中 $(X,Y)$的联合概率密度为 $f(x,y)$ ，实际上是确定一个$z$ 对应一条曲 **线**，然后把这条线上的所有 $(x,y)$ 对应的 $f(x,y)$ 加总（即积分）。一条线是没有质量的，我们需要计算 带有 $\Delta z$  因为：

$$
f_{Z}(z) \Delta z =  P\{ z < Z \le z + \Delta z \}
$$

![[Pasted image 20251204200057.png]]

啰嗦这么一大堆，目的是为了帮助我们定限制。也就是公式还是在同一个 $support$ 上积分，因此（以留下 $z,x$ 为例）我们只需要观察给出的 $z$ 对应的 $x$ 的边界曲线是否变化即可。

现在，support 是 正方形，此时 $Z = X+Y$ 是一条直线穿入再穿出，分界点就是 $z= 1$ ，因此我们有：

$$
\int _{-\infty} ^{+\infty} f(x,g(z,x)) \left| \frac{ \partial g(z,x) }{ \partial z }  \right| dx = \int _{-\infty}^{+\infty} (2-z) dx
$$

那么当 $0 \le z < 1$ 是：

$$f_Z(z) = \int_0^z (2-z)dx = (2-z) \cdot (z-0) = 2z - z^2$$

当 $1 \le z < 2$ 时：

$$
f_{Z}(z) = \int _{2-z}^{1} (2-z) dx = (2-z)^{2}
$$
 
# 泊松积分

设二维随机变量 $(X,Y)$ 的概率密度为 $f(x,y) = Ae^{-2x^2+2xy-y^2}$, $-\infty < x < +\infty$, $-\infty < y < +\infty$, 求常数A及条件概率密度 $f_{Y|X}(y|x)$

我们有：

$$
\int _{-\infty}^{+\infty} dx \int _{-\infty}^{+\infty} Ae^{-y^{2} + 2xy - 2x^{2}} dy = A \int _{-\infty}^{+\infty} e^{-x^{2}} dx \int _{-\infty}^{+\infty} e^{-(y- x)^{2}} dy = 1
$$

一方面我们可以通过正态函数的分布函数来推导泊松积分的结果，同时我们之前在积分运算当中业已说明了通过极坐标换元的方式来计算的方法。

因此 $A \pi = 1 \to A = \frac{1}{\pi}$

条件概率密度的公式为：

$$
\frac{f(x,y)}{f_{X}(x)} = \frac{f(x,y)}{\int _{-\infty}^{+\infty} f(x,y) dy} = \frac{1}{\sqrt{ \pi }} e^{-x^{2} + 2xy - y^{2}}
$$

# 古典概型

袋中有1个红球,2个黑球与3个白球,现有放回地从袋中取两次, 每次取一个球。以X,Y,Z 分别表示两次取球所取得的红球、黑球与白球的个数。

> 排列组合都是计算古典概型当中可能性个数的工具，故而当想不清楚需不需要排序等问题，请回到古典概型定义上思考。

(1) 求 $P(X=1|Z=0)$;

$$
P\{ X = 1| Z =  0 \} = \frac{P\{ X = 1, Z = 0 \}}{P\{ Z = 0 \}} = \frac{P\{ X= 1, Y = 1 \}}{P\{ Z = 0 \}}
$$

那么 $\{ Z = 0 \}$ 有 $3 \times 3$ 种情况，而 $\{ X = 1 , Y =1 \}$ 则有 $1 \times 2 + 2 \times 1$

故而：

$$
P\{ X = 1 | Z = 0 \} = \frac{4}{9}
$$

(2) 求二维随机变量(X,Y)的概率分布。

离散随机变量的分布律就一个一个写过去即可。

# 条件概率

设随机变量 X 在区间(0,1)上服从均匀分布，在 $X=x(0<x<1)$的条件下，随机变量 Y 在区间(0,x)上服从均匀分布，求：

(1) X 和 Y 的联合概率密度；

一般而言概率密度通过分布函数求导得到。然而这里直接将概率密度给出了，也就是在$X = x$ 的条件下，概率密度就是在一个点上的mass weight，因此实际上我们有：

$$
f_{Y|X}(y|x) = \begin{cases}
\frac{1}{x}, &  0<x < 1, 0 < y < x \\
0, 
\end{cases}
$$

故而我们得到：

$$
f(x,y) = f_{Y|X}(y|x) f_{X}(x) = \begin{cases}
\frac{1}{x},  &  0 < x < 1, 0 < y <x \\
0, & other
\end{cases}
$$

(2) Y 的概率密度；

当 $0< y < 1$ 时：

$$
f_{Y}(y) = \int _{y}^{ 1} \frac{1}{x} dx =  - \ln y
$$

(3) $P\{X+Y>1\}$

$P(X+Y>1) = \int_{1/2}^{1} dx \int_{1-x}^{1} \frac{1}{x} dy = \int_{1/2}^{1} (2-\frac{1}{x}) dx = 1 - \ln 2$

> 这里强调 并不等于 $1 - P \{ X + Y \le 1 \}$ ，另外对于连续随机变量而言，等号取不取不重要。

# 分类

> 这和上一题的强调点一致，二维随机变量会分割成四个区域，这为讨论带来了麻烦。

已知随机变量X和Y的联合概率密度为
$$\phi(x,y) = \begin{cases}
4xy, & 0 \le x \le 1, 0 \le y \le 1, \\
0, & \text{其他}.
\end{cases}$$
求X和Y联合分布函数F(x,y).

这里的积分是显然的，我们强调对于去区间的分类，$0,1$ 把 $x$ 和 $y$ 分别分为 $3$ 个区间，故而本来应该有 9 个 区间要讨论，但是 $x < 0$ 或者 $y < 0$ 可以统一，因此我们做下面讨论：

当 $x<0$ 或 $y<0$ 时，$F(x,y) = \int_{-\infty}^{x}du\int_{-\infty}^{y}\phi(u,v)dv = 0$;

当 $0 \le x \le 1$ 且 $0 \le y \le 1$ 时，$F(x,y) = \int_{-\infty}^{x}du\int_{-\infty}^{y}\phi(u,v)dv = \int_{0}^{x}du\int_{0}^{y}4uvdv = x^2y^2$;

当 $0 \le x \le 1$ 且 $y \ge 1$ 时，$F(x,y) = \int_{-\infty}^{x}du\int_{-\infty}^{y}\phi(u,v)dv = \int_{0}^{x}du\int_{0}^{1}4uvdv = x^2$;

当 $x \ge 1$ 且 $0 \le y \le 1$ 时，$F(x,y) = \int_{-\infty}^{x}du\int_{-\infty}^{y}\phi(u,v)dv = \int_{0}^{1}du\int_{0}^{y}4uvdv = y^2$;

当 $x \ge 1$ 且 $y \ge 1$ 时，$F(x,y) = \int_{-\infty}^{x}du\int_{-\infty}^{y}\phi(u,v)dv = \int_{0}^{1}du\int_{0}^{1}4uvdv = 1$.

故而：

故 

$$F(x,y)=
\begin{cases}
0, & x<0 或 y<0, \\
x^2y^2, & 0\le x \le 1, 0\le y \le 1, \\
x^2, & 0\le x \le 1, y \ge 1, \\
y^2, & x \ge 1, 0 \le y \le 1, \\
1, & x \ge 1, y \ge 1.
\end{cases}$$

# 二维的事件分割

一电子仪器由两个部件构成, 以 $X$ 和 $Y$ 分别表示两个部件的寿命 (单位: 千小时), 已知 $X$ 和 $Y$ 的联合分布函数为 $F(x,y) = \begin{cases} 1-e^{-0.5x}e^{-0.5y} + e^{-0.5(x+y)}, & x\geq0,y\geq0, \\ 0, & \text{其他.} \end{cases}$

求两个部件的寿命都超过 100 小时的概率 $\alpha$ 。

> 并不等于 $1- P\{ X \le 100,Y\le 100 \} = 1 - F(100,100)$ ，事实上一个$support$ 被分割成了四个部分。（这里选填可能会考察）

由于随机变量来连续，等号没有差异，因此：

$$
P\{ X > 100 , Y > 100 \} = \int _{100}^{+\infty} dx \int _{100}^{+\infty} f(x,y) dy
$$