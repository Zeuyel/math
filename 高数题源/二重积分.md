---
tags:
  - cheatsheet
  - 高数
  - 考研
  - math
---
> [!abstract] 二重积分重点在于计算
> - 二重积分最本质的出发点是转换成累次积分
> 	- 一方面把握住累次积分往一重定积分转换的主线
> 	- 另一方面要理解累次积分作为一重积分和变限积分复合的本质。变限积分求导，分部积分等方式依旧可以使用。
> 		- 进一步的，如果外层的一重积分也含参，那应当理解为双重的变限积分复合。
> - 思考顺序上，要先思考对称性和形心公式。这一步不要掉以轻心，由于简单的考查方式以及泛滥，是被会在函数形式，积分区域上做文章，或者干脆化简只对部分区域有意义。仍然考察进一步的运算。
> - 我们指出，对于积分上下限复杂的，而被积函数简单的，应当首先考虑直接积分，而非对称性转换以及极坐标换元
> - 交换积分次序。 这一考点有两种考察方式，第一种是给定积分求解，不可积函数需要通过交换积分次序来化简。第二种直接考察交换积分次序，注意极坐标的交换积分次序方法。
> - Wallis公式在最后求解过程中被广泛应用，因为极坐标换元的应用，看到高次幂的三角函数，要联想Wallis公式，对于积分区域不一致的，有两个技术细节：
> 	- 区间再现使得区间取半
> 	- 三角变换使得区间平移

# 二重积分计算

## 例题1 极坐标变换，非常见角

设平面有界区域D位于第一象限,由曲线$xy=\frac{1}{3}$，$xy=3$与直线$y=\frac{x}{3}$，$y=3x$围成,计算$\iint_D(1+x-y)dxdy$.

由轮换对称性得：

$$
\iint _{D} (1+x-y) dxdy = \frac{1}{2} \iint _{D} 2 dxdy = \iint _{D_{1}} 2 dx dy = I
$$

其中 $D_{1} \triangleq \{ y > x | x,y \in D \}$ 极坐标换元：

$$
\begin{cases}
x = r\cos \theta \\
y = r\sin \theta
\end{cases} \quad \theta \in\left( \frac{\pi}{4}, \theta_{1} \right)
$$

其中 $\tan\theta_{1} = 3$ 则 ：

$$
I = \int _{\frac{\pi}{4}}^{\theta_{1}}  d\theta \int _{r_{1}(\theta)}^{r_{2}(\theta)} 2 r dr= \int _{\frac{\pi}{4}}^{\theta_{1}}  d\theta \int _{r^{2}_{1}(\theta)}^{r^{2}_{2}(\theta)}  dr^{2}
$$

其中：

$$
r_{1} \cos\theta r_{1}\sin\theta = \frac{1}{3}, r_{2}\cos\theta r_{2}\sin\theta = 3 \to r^{2}_{1} = \frac{1}{3 \sin\theta \cos\theta}, r_{2}^{2} \frac{3}{\sin\theta \cos\theta}
$$

故而：

$$
I = \int _{\frac{\pi}{4}}^{\theta_{1}} \left( 3 - \frac{1}{3} \right) \frac{1}{\frac{1}{2}\sin 2\theta} d\theta = \frac{8}{3} \int ^{\theta_{1}}_{\frac{\pi}{4}} \frac{1}{\sin 2\theta} d 2\theta  = \frac{8}{3} \ln \left( \csc 2\theta - \cot 2 \theta \right) \left| _{\frac{\pi}{4}}^{\theta_{1}} \right.
$$

其中 $\int \csc 2\theta d2\theta = \ln \left| \csc 2\theta - \cot 2\theta \right|$ ，$\sin 2\theta_{1} = \frac{3}{5}, \cos 2\theta_{1} = - \frac{4}{5}, \cot 2\theta_{1} = - \frac{4}{3}$

因此原式等于：

$$
I = \frac{8}{3} \ln 3
$$

> 当然这一题，由于 $xy = \frac{1}{3}$ 和 $xy = 3$  的特殊性还有简便的做法。但是，我们指出不知道具体角度的 $\theta_{1}$ 但是知道 $\tan \theta_{1}$ 可以设而不求，进行极坐标换元。比如这一题换成 $xy = \frac{1}{4}, xy = 3$ 极坐标换元就会简单许多。

## 例题2 对称性是双刃剑

平面区域 $D = \{(x, y) \mid y-2 \le x \le \sqrt{4-y^2}, 0 \le y \le 2\}$, 计算 $I = \iint_D \frac{(x-y)^2}{x^2 + y^2} dxdy$.

区域 $D$ 有一点不规则，我们思考是否能够使用周期性，图像只有可能是按照 $y$ 轴对称（$D_{1}$ 和 $D_{2}$ 抵消），分离一下所求表达式：

$$
\iint _{D} 1 - \frac{2xy}{x^{2}+y^{2}} dxdy = S_{D} - 2 \iint _{D} \frac{xy}{x^{2}+y^{2}} = S_{D} - 2\iint _{D_{3}} \frac{xy}{x^{2} +y^{2}} = S_{D}- 2I
$$

显然，我们使用极坐标换元

$$
\begin{cases}
x = r\cos\theta \\
y = r \sin \theta

\end{cases}

$$

射线穿入相交与 $x + y = 2$ 穿出相交于圆。因此弧长下限为 $\frac{2}{\cos\theta+\sin\theta}$ 上限为 $2$

$$
I = \int _{0}^{\pi/2} d\theta \int _{\frac{2}{\cos\theta + \sin\theta}} ^{2} (\cos\theta \sin\theta) r dr = \int _{0}^{\pi/2} 2 \cos\theta \sin \theta -  \frac{2\cos\theta \sin\theta}{\cos ^{2}\theta + \sin ^{2}\theta + 2 \sin\theta \cos\theta} d\theta
$$

我们尝试分项积分

$$
\begin{align}
I  & = I_{1} - I_{2} =  \int _{0}^{\pi/2 } 2 \sin\theta d\sin\theta - \int _{0} ^{\pi/2} \frac{2\cos\theta \sin\theta}{\cos ^{2}\theta + \sin ^{2}\theta+2\sin\theta \cos\theta}d\theta \\
I_{1}  &  = \sin ^{2}\theta |^{\pi/2}_{0} = 1 \\
I_{2} & = \int \frac{2\tan\theta}{1+ \tan ^{2}\theta + 2 \tan\theta} d\theta \overset{x = \tan\theta}{=}  \int \frac{2x}{x^{2} + 2x +1} \frac{1}{1 + x^{2}} dx  \\
 & =  \int _{0}^{+\infty} \frac{1}{1 + x^{2}} dx -
\int_{0}^{+\infty} \frac{1}{(x+1)^{2}} dx  \\
 &  = \arctan x | _{0} ^{+\infty} + (x+1)^{-1}|_{0} ^{+\infty}  \\
 &  = \frac{\pi}{2} + \lim_{ x \to  +\infty }  \frac{1}{x+1} - 1  \\
 & =  \frac{\pi}{2}  - 1\\
I  &  = 2 - \frac{\pi}{2}
\end{align}
$$

> 我们首先指出，齐次的三角函数可以大胆的尝试，甚至万能代换也能得到简单的效果。

我们再计算面积：

$$
S_{D} = \frac{1}{2} 2 \times 2 + \frac{1}{4} \pi 4 = 2 + \pi, S_{D} - 2I = 2(\pi -1) 
$$

```tikz
\usepackage{tikz}

\begin{document}
\begin{tikzpicture}[scale=2]

  % Axes
  \draw[->] (-2,0) -- (3,0) node[right] {$x$};
  \draw[->] (0,-0.5) -- (0,2.5) node[above] {$y$};

  % Functions
  \draw (-1,0.5) node {D1};
  \draw (1,0.5) node {D2};
  \draw (1.2,1.2) node {D3};
  \draw[thick, ->] (0,0) -- (1,2);
  \draw[blue, thin, domain=-2:0] plot (\x, {\x+2});
  \draw[orange, thin, domain=0:2] plot (\x, { (4-\x*\x)^0.5 });
  \draw[green, thin, dashed, domain=0:2] plot (\x, {-1*\x+2});
\end{tikzpicture}
\end{document}
```

但是实际上，我们可以直接计算：

$$
\begin{align}
I  & = \int_{0}^{\pi} d\theta \int_{0}^{2} (\cos\theta - \sin\theta)^2 rdr + \int_{\pi/2}^{\pi} d\theta \int_{0}^{ \frac{2}{\sin\theta-\cos\theta}} \frac{\sin^2\theta - \cos^2\theta}{(\cos\theta - \sin\theta)^2} rdr \\
 & = 2 \int_{0}^{\pi} (\cos\theta - \sin\theta)^2 d\theta + 2 \int_{\pi/2}^{\pi} d\theta \\
 & = 2 \int_{0}^{\pi} (1 - \sin 2\theta) d\theta + \pi = 2(\pi - 1)
\end{align}
$$

一顿操作下来还不如直接积分简单，原因在于目标函数和复杂的积分限约掉了，这使得后续的积分运算被简化了。

## 例题3 极坐标换元是双刃剑

设平面区域D由曲线$y=\sqrt{3(1-x^2)}$与直线$y=\sqrt{3}x$及y轴围成,计算二重积分$\iint_D x^2drdy$.

$$
I = \int _{\frac{\pi}{3}}^{\frac{\pi}{2}} d\theta \int _{0}^{r_{1}} r^{2} \cos ^{2}\theta  r dr
$$

其中，$r_{1}^{2} = \frac{3}{\sin ^{2}\theta + 3\cos ^{2}\theta}$ 则：

$$
\int _{0}^{r_{1}} r^{3} dr = \frac{1}{4} r^{4} = \frac{1}{4} \frac{9}{(\sin ^{2}\theta + 3 \cos ^{2}\theta)^{2}}
$$

因此：

$$
I = \frac{9}{4}\int _{\frac{\pi}{3}}^{\frac{\pi}{2}} \frac{\cos ^{2}\theta}{(\sin ^{2}\theta + 3 \cos ^{2}\theta)^{2}} d\theta 
$$

其中：

$$
\begin{align}
\int \frac{\cos ^{2}x}{(\sin ^{2}x + 3 \cos ^{2}x)^{2}} dx  &  =  \int \frac{1}{\cos ^{2}x(\tan ^{2}x + 3)^{2}} dx  \\
 & =     \int \frac{1}{(\tan ^{2} + 3)^{2}} d\tan x   \\
 & \overset{t = \tan x}{ =}  \int \frac{1}{(t^{2} + 3)^{2}} dt \\
\end{align}
$$

这里的最后的积分回到[[积分的方法与技巧#配方]] 中说明的再次换元到 $t = \tan\theta$ 

然而，我们直接积分即可得到非常简单的运算：

$$
\int _{0}^{  \frac{\sqrt{ 2 }}{2}} dx \int _{\sqrt{ 3 }x} ^{\sqrt{ 3(1-x^{2}) }} x^{2} dy = \int _{0}^{\frac{\sqrt{ 2 }}{2}} x^{2} \sqrt{ 3(1-x^{2}) } dx - \int _{0}^{\frac{\sqrt{ 2 }}{2}} \sqrt{ 3 }x^{3} dx
$$

只需对前一项进行 $x = \sin t$ 的换元即可。

> 类似的，17-2 的二重积分也是一致的出题方向，并且他给出的平面区域 $D$ 是圆，应该说是显著的极坐标换元的特征，但实质上最后的次数太高，三角积分较为复杂，掌握 [[积分的方法与技巧#递推公式]] 才能够轻松应对。
## 例题4 抽象曲线

平面区域D由曲线 $(x^2+y^2)^2=x^2-y^2$ $(x \ge 0, y \ge 0)$ 与 x 轴围成,计算二重积分 $\iint_D xy dxdy$.

显然面对曲线，一时不知如何下手。通过尝试，我们得到 点 $(0,0)$ 和 点 $(\pm 1, 0)$ 


```tikz
\usepackage{tikz}

\begin{document}
\begin{tikzpicture}[scale=2]

  % Axes
  \draw[->] (-2,0) -- (2,0) node[right] {$x$};
  \draw[->] (0,-0.5) -- (0,0.5) node[above] {$y$};
  \draw[help lines,step=.3] (-2,-0.5) grid (2,0.5);
  \fill[color=black] (0,0) circle[radius=0.03] node[anchor=west] {$A$};
  \fill[color=black] (1,0) circle[radius=0.03] node[anchor=east] {$B$};
\end{tikzpicture}
\end{document}
```

我们关注第一象限，那么问题出在连接 $(0,0)$ 和 $(1,0)$ 的线段是否会到$x$ 轴下方。但是实际上，我们观察到曲线是按照 $x$ 轴对称的，因此 $A,B$ 两点之间的线段在第一象限是一直在 $x$ 轴上方的。


$$
\int_{0}^{\pi/4} d\theta \int_{0}^{\sqrt{\cos\theta}} r^3 \cos\theta \sin\theta dr = \frac{1}{8} \int_{0}^{\pi/4} \cos^2 2\theta \sin 2\theta d\theta = \frac{1}{48}
$$

> 记忆曲线边际效用非常弱，比如 19-2 的题目平面区域为 $(x^{2}+y^{2})^{3} \le y^{4}$ 不是常见曲线，但是通过对称性和稍微的取点分析，和本题一致可以得到迅速求解。因而，我们可以说，看到复杂曲线应当兴奋，这是考察处理抽象区域的能力，进一步的，我们应该思考奇偶性，对称性以及轮换对称性。

## 例题5 参数方程：从换元角度理解

设平面区域$D$由曲线 $\begin{cases} x = t - sint, & (0 \le t \le 2\pi) \\ y = 1 - cost \end{cases}$ 与 $x$轴围成，计算二重积分$\iint_D (x+2y)dxdy$.


> [!Important] 换元
> 给出参数方程确定 $y(x)$ 并且对 $x$ $y$ 积分，实际上可以理解为给出换元方案，显式要求我们换元，这考察我们对于常用的极坐标换元的掌握。
>- 然而，如果视为二重积分换元要涉及到 $dxdy$ 到 $du dv$ 之间的转换，这无疑是繁琐的。
>- 如果首先计算累次积分的内积分后得到的形式较为简易，应当采取先转换为一重积分后换元，此时只需要考虑 $dx$ 和 $dt$ 之间的关系，只需要直接代入即可。
>类似的对于积分区域不规则的就可以考虑换元，如果极坐标还不行就可以考虑进一步换元。

由于目标是对 $x$ 和 $y$ 的积分，对于参数方程确定的 $y = y(x)$ ，在直角坐标系上简单判断即可得到 $y \ge 0$ ，

$$
I = \iint _{D} (x+2y) dxdy = \int _{0}^{2\pi} dx \int _{0}^{y(x)} (x+2y) dy
$$

然后考虑换元，如果想要直接写出换元之后的微元表达是困难的。极坐标换元会使用 $rdr$ ，$d\theta$ 来分别表示底面积，严谨的推导是使用雅可比行列式计算得来的。并且需要注意的是，给出的仅仅是一条曲线的表示，如果要表示区域，还需要引入新变量 $v$。原来的笛卡尔坐标系中的每个点，才能够被一一表示。

我们类比极坐标，单位圆可以被简单的表示为 

$$
\begin{cases}
x = \cos \theta \\
y = \sin \theta
\end{cases}
$$

对应换元为：

$$
\begin{cases}
x = r\cos\theta \\
y = r\sin\theta
\end{cases}
$$

现在，我们表示表示目前的平面区域：

$$
\begin{cases}
x = u -\sin u \\
y = v(1 - \cos u)
\end{cases}
$$

其中 $1-\cos u$ 对应的是上边界。那么现在问题实际上回到了我们[[多元函数微分]]中讨论的隐函数方程组之间的关系，我们需要用 $dx dy$ 表示 $du dv$ ，我们有

$$
\begin{cases}
dx = \frac{ \partial x }{ \partial u }  du + \frac{ \partial x }{ \partial v } dv \\
dy = \frac{ \partial y }{ \partial u } du + \frac{ \partial y }{ \partial v }  dv
\end{cases} \to \begin{pmatrix}
dx \\
dy
\end{pmatrix} = \begin{pmatrix}
\frac{ \partial x }{ \partial u }  & \frac{ \partial x }{ \partial v }  \\
\frac{ \partial y }{ \partial u }  & \frac{ \partial y }{ \partial v } 
\end{pmatrix} \begin{pmatrix}
du \\
dv
\end{pmatrix}
$$

> [!note] 换元的雅可比行列式
> 通过行列式运算实际得到：
> 
>  $$
>  dxdy = \begin{vmatrix}
> \frac{ \partial x }{ \partial u }  & \frac{ \partial x }{ \partial v }  \\
> \frac{ \partial y }{ \partial u }  & \frac{ \partial y }{ \partial v } 
> \end{vmatrix} dudv
> $$

解出 $du$ 和 $dv$  得到 $dxdy = (1-\cos u)^{2}dudv$ 那么我们有

$$
\iint_D (x+2y)dxdy = \iint_{D_{uv}} [(u-\sin u) + 2v(1-\cos u)](1-\cos u)^2 du dv
$$

$$
I = \int_0^{2\pi} \int_0^1 [(u-\sin u) + 2v(1-\cos u)](1-\cos u)^2 dv du
$$

我们指出先计算内部积分之后再换元会简单许多：

$$
I = \int _{0}^{2\pi} xy(x)dx + \int _{0}^{2\pi} y^{2}(x) dx
$$

此时再换元，相当于一重积分的变量替换，这无疑是简易的：

$$
I = \int _{0}^{2\pi} (t-\sin t)(1-\cos t) d(t-\sin t) + \int _{0}^{2\pi} (1-\cos t)^{2} d(1-\cos t)
$$


## 例题6 未知部分求解


设 $D = \{(x,y) | x^2 + y^2 \le 1, y \ge 0\}$, 连续函数 $f(x,y)$ 满足 $f(x,y) = y \sqrt{1-x^2} + x \iint_D f(x,y) dxdy$,求 $\iint_D x f(x,y) dxdy$.

记 $a \triangleq \iint _{D}f(x,y)dxdy$ 我们有：

$$
f(x,y) = y\sqrt{ 1-x^{2} } + x\iint _{ D } f(x,y) dxdy \implies f(x,y) = y\sqrt{ 1-x^{2} } + x a
$$

两边取二重积分得到：

$$
a = \iint _{D} y\sqrt{ 1- x^{2} } + xa dxdy = \iint _{D} y\sqrt{ 1-x^{2} } dxdy + a \iint _{D} x dxdy
$$

由对称性可知 $\iint _{D} x dxdy = 0$ 故而得到：

$$
a = \iint _{D} y \sqrt{ 1 - x^{2} } dxdy
$$

极坐标不好化简，并且$\sqrt{ 1-x^{2} }$ 也在给我们提示。视为$x$ 形区域，刚好得到这样的积分上限：

$$
a = \int _{-1}^{1} \sqrt{ 1-x^{2} } dx \int _{0}^{\sqrt{ 1-x^{2} }}  y dy = \frac{1}{2}\int _{-1}^{1} \left( \sqrt{ 1-x^{2} } \right) ^{3} dx \overset{\sin t = x}{=} \int _{0}^{\pi/2} \cos ^{4} t dt  = \frac{3}{4} \frac{1}{2} \frac{\pi}{2} = \frac{3\pi}{16}
$$

因此：

$$
f(x,y) = y \sqrt{ 1-x^{2} } + \frac{3\pi}{16} x
$$

故而：

$$
\iint _{D} x f(x,y) dxdy = \iint _{D} xy \sqrt{ 1-x^{2} } dxdy + \iint _{D} \frac{3\pi}{16} x^{2} dxdy = \iint _{D} \frac{3\pi}{16} x^{2} dxdy
$$

这一次同样得到了一个奇偶性表达式，而遗留下来的部分则异常简单，积分上下限和被积函数都非常整齐。考虑极坐标换元得到：

$$
\frac{3\pi}{16} \int _{0}^{\pi} d\theta \int _{0}^{1} r^{2} \cos\theta r dr = \frac{3\pi ^{2}}{128}
$$
## 例题7 极点移动

计算二重积分$\iint_D (x-y)dxdy$,其中$D= \{(x, y) | (x-1)^2 + (y-1)^2 \le 2, y \ge x\}$.

$$
I = \int _{\frac{\pi}{4}}^{ \frac{3\pi}{4}} d\theta \int _{0}^{2\sqrt{ 2 }\cos(\theta - \pi/4)} r^{2}(\cos\theta - \sin\theta) dr
$$

化简得到：

$$
\begin{align}
I  &  = \int _{\frac{\pi}{4}}^{ \frac{3\pi}{4}} d\theta \int _{0}^{2\sqrt{ 2 }\cos(\theta - \pi/4)} r^{2}(\cos\theta - \sin\theta) dr \\
I  &  = \int _{\frac{\pi}{4}}^{ \frac{3\pi}{4}} d\theta \int _{0}^{2\sqrt{ 2 }\cos(\theta - \pi/4)} r^{2}(\cos\theta - \sin\theta) dr \\
\end{align}
$$

次数并不高，也非常容易的积分。此处，我们想说明极坐标常用的操作，极点的平移。

令 $u=x-1$, $v=y-1$，则D变为 $D' = \{ (u,v) | u^2 + v^2 \le 2, v \ge u \}$, 

且 $J = \begin{vmatrix} \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\ \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} \end{vmatrix} = \begin{vmatrix} 1 & 0 \\ 0 & 1 \end{vmatrix} = 1$,


于是原式 

$$
\iint_{D'} (u-v)dudv = \int_{\frac{\pi}{4}}^{\frac{5\pi}{4}} d\theta \int_{0}^{\sqrt{2}} (r\cos\theta - r\sin\theta)rdr = \frac{2\sqrt{2}}{3} \int_{\frac{\pi}{4}}^\frac{5\pi}{4} (\cos\theta - \sin\theta)d\theta = \frac{8}{3}
$$

## 例题8 Poisson 积分

计算 $I = \int _{-\infty}^{+\infty} \int _{-\infty}^{+\infty} \min \{ x,y \}e^{-(x^{2}+y^{2})}$ 

> 我们已经研究过了Poisson积分，我们这里说明遇到了复合结构的处理细节。Possion积分是否没有原函数，因此解决他的关键在于积分区间，需要给他 $(-\infty,+\infty)$ 或者 $(-\infty,0)$ 之类的范围，参见 [[积分与积分计算#欧拉积分]] 中的说明，其原理是利用三角函数换元积分。

内部积分是变上限的，而外层积分符合要求，因此我们应该尽可能的求出内层的积分，那就是要凑 $xdx$ 和 $ydy$ 我们有：

$$
I = \int _{-\infty} ^{+\infty} dy \int _{-\infty} ^{y} x e^{-(x^{2}+ y^{2})} dx + \int _{-\infty}^{+\infty} dx \int _{-\infty}^{x}  y e^{-(x^{2}+y^{2})} dy 
$$

实际上，定积分与变量无关，这两项是相等的，我们计算其中一项，记为 $I_{0}$：

$$
I_{0} = - \frac{1}{2} \int _{-\infty} ^{+\infty} dy  \int _{-\infty} ^{y} e ^{-(x^{2}+y^{2})} d -(x^{2}+y^{2}) = - \frac{1}{2} \int _{-\infty}^{+\infty} e^{-2 y^{2}} dy
$$

其中：

$$
\begin{align}
\left[ \int _{-\infty}^{+\infty} e^{-2y^{2}} dy  \right]^{2}   &  = \int _{-\infty} ^{+\infty} e^{-2x^{2}} dx \times \int _{-\infty}^{+\infty} e^{-2y^{2}} dy  \\
 & = \int _{-\infty}^{+\infty} e^{-2(x^{2} + y^{2}) } dxdy  \\
 &  = \int _{0} ^{2\pi} d\theta \int _{0}^{+\infty} r e^{-2r^{2}} dr \\
 &  = -\frac{1}{4} \int _{0}^{2\pi} -1 d\theta \\
 &  = \frac{\pi}{2}
\end{align}
$$

 因此

$$
I = -I_{0} = - \sqrt{ \frac{\pi}{2} }
$$

# 积分次序转换

## 例题1 化为一重积分

已知函数 $f(t) = \int_{1}^{t^{2}} dx \int_{\sqrt{ x }}^{t} \sin\frac{x}{y} dy$, 则 $f'(\frac{\pi}{2}) =$

这是一重变上限积分求导的扩展，因此我们只需要转换为一重积分即可，但此时  $\sin \frac{x}{y}dy$  显然不可求积。因此需要换顺序，此时应当把 $t$ 作为常数。作为大题，需要讨论 $t$ 的范围，然后写出全部的 $f(t)$ 表达式，然后再求导函数，再说明其导函数值。小题只询问一点出的导函数值，显然我们只要考虑 $t > 1$ 的情况即可。

我们有：

$$
f(t) = \int _{1}^{t} dy \int _{1}^{y^{2}} \sin \frac{x}{y} dx = \int _{1}^{t} -y\left( \cos y - \cos \frac{1}{y} \right)dy, (t \ge 1)
$$

再对等式两边关于$t$ 求导即可。

## 例题3 极坐标换序



# 分部积分

> 我们仍然指出，遇事不决分部积分。

## 例题1 乘法凑微分

 计算$I = \int_0^1 dx \int_{x - x^{3}}^{1} (3x^2-1)e^{y^{2}} dy$ 

首先的想法就是换序，因为 $e^{y^{2}}$ 是不可积的，但是这个积分区域确比较复杂。

那么如果观察到 $-(3x^{2} - 1) = (x-x^{3})'$ ，我们可以使用凑微分得到

$$
I = - \int _{0}^{1} d(x - x^{3}) \int_{x - x^{3}} ^{1} e^{y^{2}} dy = - \int _{0}^{1} \left[  \int _{\phi(x)}^{1} e^{y^{2}} dy \right]  d \phi(x)
$$

现在问题来到了，$x - x^{3}$ 在 $0,1$ 并不是单调的，能不能换元？参见 [[积分与积分计算#定积分的换元积分法]]  显然直接变量替代是没有根据的。但是考察不定积分：

$$
G(x) \triangleq - \int \int _{\phi(x)} ^{1} e^{y^{2}} dy \ d\phi(x) 
$$

虽然不好求积，但是显然是存在的。因此由牛顿莱布尼茨公式得到：

$$
I = G(\phi(0)) - G(\phi(1))  = G(0) - G(0) = 0
$$

同时这一题也可以使用分部积分方法，通过对内部的变限积分求导消掉不可求积的 $e^{y^{2}}$

$$
\begin{align}
I   & = - \int _{0}^{1} d(x - x^{3}) \int_{x - x^{3}} ^{1} e^{y^{2}} dy  \\
 & = - \left\{ \left. (x - x^{3}) \int _{x-x^{3}}^{1} e^{y^{2}} dy \right|_{0}^{1} - \int _{0}^{1} (x - x^{3}) d \left[ \int _{x - x^{3}} ^{1} e^{y^{2}} dy \right] \right\} \\
 &  = - \int _{0}^{1} (1- 3x^{2})(x - x^{3}) e^{(x - x^{3})^{2}}  dx
\end{align}
$$

同样也是可以通过先不定积分然后再代入求得，不过略显繁琐。但是综上，分部积分的方法通常比换序简单，可以有限考虑。

## 例题3 加法分项

$\int_{0}^{1}dy\int_{y}^{1}(\frac{e^{x^2}}{x}-e^{y^2})dx=$

首先分项：

$$
\int _{0}^{1} dy \int _{y}^{1} \frac{e^{x^{2}}}{x} dx - \int _{0}^{1} dy \int _{y}^{1} e^{y^{2}} dx = I_{1} + I_{2}
$$

其中：

$$
\begin{align}
I_{1}  & = \left.   y \times \int _{y}^{1} \frac{e^{x^{2}}}{x} dx  \right|_{0}^{1} + \int _{0}^{1} y \times \frac{e^{y^{2}}}{y} dy = \int _{0}^{1} e^{y^{2}} dy \\
I_{2}  & = \int _{0}^{1}(y - 1) e^{y^{2}} dy \\
I_{1} + I_{2}  & = \int _{0}^{1} y e^{y} dy =\frac{1}{2} (e - 1)
\end{align}
$$ 
# 变限积分


> [!important] 抽象问题想到变限积分
> 变限积分与定积分和不定积分的既有关系。
> 一个函数可以背表示为其原函数的变限积分，研究抽象问题变限积分是一个很好的桥梁
> 进一步的，灵活运用分部积分是转换的关键。

## 例题1

已知函数 $f(x,y)$ 具有二阶连续偏导数，且 $f(1,y) = f(x,1) = 0$, $\iint_D f(x,y)dxdy = a$, 其中 $D = \{(x,y)|0 \le x \le 1, 0 \le y \le 1\}$, 计算二重积分 $I = \iint_D xyf_{xy}^{\prime\prime}(x,y)dxdy$.

由 $f(x,1)=0$ 知 $f'(x,1)=0$

$$
I = \int_{0}^{1}dx\int_{0}^{1}xyf_{xy}''(x,y)dy = \int_{0}^{1} x dx[\int_{0}^{1}y df_{x}'(x,y)]
$$

分布积分得到：

$$
\int_{0}^{1}x \left\{\left[ y f'(x,y) \right]|_{0}^{1} -  [\int_{0}^{1} f_{x}'(x,y)dy] \right\}dx 
$$

化简得到：

$$
= - \int _{0}^{1} x \int _{0}^{1} f'_{x}(x,y) dy dx  = - \iint _{D} x f'_{x}(x,y) dxdy = -\int_{0}^{1}dy\int_{0}^{1}xf_{x}'(x,y)dx
$$ 
再一次分部积分得到

$$
= - \int _{0}^{1} \left\{ x f(x,y)|_{0}^{1} - \int _{0}^{1} f(x,y) dx \right\}  dy = \int _{0}^{1}\int _{0}^{1} f(x,y) dxdy = a
$$

## 例题2

设函数 $f(x)$ 在区间 $[0,1]$ 上连续, 并设 $\int_{0}^{1} f(x) dx = A$, 求 $\int_{0}^{1} dx \int_{x}^{1} f(x)f(y)dy$.

我们有：

$$
\frac{d}{dx}  \int _{1}^{x} f(y) dy = f(x), I(x) \triangleq \int _{1} ^{x} f(y) dy
$$

因此：

$$
\int _{0}^{1} f(x) \left\{  \int _{x}^{1} f(y) dy \right\}  dx = -  \int _{0}^{1} I(x) dI(x) = -  \frac{1}{2} I^{2}(x) |_{0}^{1} = \frac{1}{2} \left[ I^{2}(1) - I^{2}(0) \right]  = \frac{1}{2} a
$$

## 例题3

设函数 $f(t)$ 在$[0, +\infty)$ 上连续, 且满足方程 $f(t) = e^{4\pi^2} + \iint_{x^2+y^2\le 4t^2} f(\frac{1}{2}\sqrt{x^2+y^2}) dxdy$, 求 $f(t)$

考察：

$$
\begin{align}
\iint _{x^{2}+y^{2} \le 4t^{2}} f\left( \frac{1}{2} \sqrt{ x^{2} + y^{2} } \right) dxdy  & = \int _{0}^{2\pi} d\theta \int _{0}^{2t} f\left( \frac{1}{2}r \right) r dr = \int _{0}^{2t} dt \int _{0} ^{2\pi} f\left( \frac{1}{2}r \right)r d\theta  \\
 & = 2\pi\int _{0}^{2t} f\left( \frac{1}{2} r \right)  r d r 
\end{align}
$$

> 首先要明确 与 [[#例题6 未知部分求解]] 的区别，这里是一个函数，面积为自变量。我们可转换其为变限积分。同时二重积分的变限积分应当自然转换为一重积分的变限积分函数。

进而回到 [[微分方程与差分方程]] 的内容，首先是初值 $f(0) = 1$。进而代入原式两边求导：

$$
f'(t) - 2\pi 2t f(t) \times 2 = 8\pi t e^{4\pi t^{2}}
$$

这是一阶线性非齐次方程，通解为：

$$
f(t) = \left[ \int e^{- \int 8 \pi t dt} 8\pi t e^{4 \pi t^{2}} dt + C \right]  e^{ \int 8 \pi t dt} = \left( \int 8 \pi t dt + C \right) e ^{ 4 \pi t^{2}} = (4 \pi t^{2} + C) e^{4\pi t^{2}}
$$

代入初值得到：

$$
f(t) = ( 4 \pi t^{2} + 1 ) e^{4 \pi t^{2}}
$$
## 例题4

设函数 $f(x)$ 在区间 $[0,1]$ 上具有连续导数，$f(0) = 1$, 且满足 $\iint_D f'(x+y) dxdy = \iint_D f(t) dt$, 其中 $D_t = \{(x,y) | 0 \le y \le t-x, 0 \le x \le t\}$ ($0 < t \le 1$), 求 $f(x)$ 的表达式。

化为累次积分得到：

$$
\int _{0}^{t} dx \int _{0}^{t-x} f'(x+y) dy = \int _{0}^{t} dx \int _{0}^{t-x} f(t) dy
$$

分别计算左右两边：

$$
LHS = \int _{0}^{t} f(t) - f(x) dx =  f(t) - \int _{0}^{t} f(x) dx
$$

$$
RHS = \int _{0}^{t} (t- x) f(t) dx = t^{2} f(t) - \frac{1}{2} t^{2}f(t) = \frac{1}{2} t^{2} f(t)
$$

整理得到微分方程：

$$
y' - \frac{x}{2} y' = y \to \frac{1}{y} dy = \frac{1}{1 - \frac{x}{2}} dx \to y = \frac{C}{(2 - t)^{2}} 
$$

代入初值条件得到 $f(x) = \frac{4}{(2 - x)^{2}}$

