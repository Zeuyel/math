---
tags:
  - cheatsheet
  - math
  - 高数
  - 考研
---
> [!abstract] 积分方法
> 首先将经典的稍显复杂的初等函数的积分结果进行了阐述，看到了相关的部分，应当兴奋。具体来说是 三角函数的高次幂、对数函数的有理多项式。以及 $u^{\alpha},e^{u}$ 对于积分的题目，最重要的积累是，知道什么样的能够积分。积分的最终目标是统一，按着这个方向做，进行式子的恒等变换，一般都能够得到结果，真题上没有考察过太强的技巧性，而是专注于几大基本技术的掌握。
>
> - 分项积分
> 	- 真分式化简（长除法）
> 	- 根据根
> 		- 无实根，实数域无法因式分解，采用凑微分目标来分项。
> 		- 有实根，通过待定系数，分项求解。
> - 分部积分（有理分式）
> 	- 把握分部积分对于阶的操作，这要大体了解方向。
> 	- 积累常见的分部积分的典型元素
> - 凑微分（换元），需要说明凑微分本质是换元积分法，简单的凑微分可以不需另设变量，复杂建议另设变化。
> - 五大换元
> 	- 三角换元
> 	- 倒代换
> 	- 根式换元
> 	- 万能换元
> 	- 欧拉换元（整体换元）
> - 定积分
> 	- 几何意义
> 		- 奇偶性、周期性、对称性
> 	- 积分限
> 	- 四条常用法则

# 分式结构

分式结构比较灵活，主要三个考察方向：配方、凑微分对数化、分项。其中分项方法作为技术细节，帮助我们分离出简单的几个部分。这里详细说明分项级数

## 例题1

$$
\int \frac{1}{x^{2} - a^{2}}dx = \frac{1}{2a} \int \frac{1}{x-a} - \frac{1}{x+a}dx
$$

这是最基础的分项操作，可以直接观察出裂项的结构。得到了比较熟悉的对数化结构，因此原式等于：

$$
\frac{1}{2a} \left( \int \frac{dx}{x-a} - \int \frac{dx}{x+a} \right)  =  \frac{1}{2a} \ln \left|  \frac{x-a}{x+a} \right| + C 
$$

但更一般的，分子分母都是高次的多项式。

## 例题2

一般而言分式结构为：

$$
\int  \frac{mx + n}{x^{2} + px + q} dx
$$

这里的技术细节是，分项为两个部分，第一个部分凑微分对数化，第二个部分配方。比如我们看到：

$$
\int \frac{x+1}{x^{2}+x+1}dx
$$

那么目标应该是：

$$
\begin{align}
  & \frac{A(2x + 1)}{x^{2} + x + 1} + \frac{B}{x^{2}+x+1} \implies \\
origin  & = A \int \frac{(x^{2}+x+1)'}{x^{2}+ x + 1} dx + B \int \frac{1}{x^{2}+x+1}dx  \\
 & = A \int \frac{1}{x^{2} + x + 1} d(x^{2} +x +1) + B \int \frac{1}{\left( x + \frac{1}{2} \right)^{2} + \left(  \frac{\sqrt{ 3 }}{2} \right)^{2}  } \\
 & = A \ln |x^{2}+ x + 1| +  B \frac{1}{\frac{\sqrt{ 3 }}{2}} \arctan \frac{x + \frac{1}{2}}{ \frac{\sqrt{ 3 }}{2}}
\end{align}
$$

实际上我们看到第二个部分，如果配方之后的 减去一个常数，积分结果又是另一个形式。

## 例题3

$$
\int \frac{5x + 6}{x^{2} + 3x + 1} dx
$$

显然：

$$
\frac{5}{2} \ln|x^{2} + 3x + 1| - \frac{3}{2}\int \frac{1}{ \left( x + \frac{3}{2} \right)^{2} - \frac{5}{4}} dx
$$

这里第二个部分变为裂项的结构，因此结果为：

$$
\frac{5}{2} \ln | x^{2} + 3x + 1| - \frac{3}{2} \cdot \frac{1}{ 2 \cdot \frac{\sqrt{ 5 }}{2}} \ln \left|  \frac{2x + 3 - \sqrt{ 5 }}{2x + 3 + \sqrt{ 5 }}\right|  +  C
$$

## 例题5

分母大于二次幂，我们就需要使用待定系数法进一步的分项：

$$
\int \frac{4 x ^{2} + 4x - 11}{(2x-1)(2x + 3)(2x + 5)} dx 
$$

断言存在：

$$
\frac{4 x^{2} + 4x - 11}{ (2x - 1)(2x + 3)( 2x -5)} = \frac{A}{2x - 1} + \frac{B}{2x + 3} + \frac{C}{2x - 5} \tag{1}
$$

> 分子的阶数要小于分母。

首先列出方程

$$
\begin{cases}
A + B +C = 1 \\
-A - 3B + C = 1 \\
-15A + 5B -3 C = 11
\end{cases}
$$

有一些式子，在 （1）赋值（取极限也可以），能够简化参数计算，比如先算出一个参数这样会更加方便当然，直接计算三元方程可以。

比如对（1）同乘上$2x-1$  得到：

$$
\frac{4x^{2} + 4x - 11}{(2x + 3)(2x -5)} = A +(2x-1)(\dots + \dots)
$$

此时，令 $x = \frac{1}{2}$ 得到：

$$
A = \frac{1}{2}
$$

同样的操作计算得到：

$$
B = - \frac{1}{4}, C = \frac{3}{4}
$$

剩下的操作是简单的。

## 例题6

有时候需要一些因式分解技巧。最常见的就是猜出一个根做长除法：

$$
\int \frac{3x + 5}{x^{3} - x^{2} - x + 1} dx
$$

三次因式比较复杂，但是显然 $x = 1$ 是 分母的根，那么我们尝试分母长除 $(x-1)$ ，的到 $x^{2} -1$ 因此：

$$
 x^{3} - x^{2} -x + 1 = (x-1)(x^{2}- 1) = (x-1)^{2} (x + 1)
$$

那么这个时候，由于 $(x-1)$ 这个因子出现了两次，我们应该设为：

$$
\frac{3x + 5}{x^{3} - x^{2} - x + 1} = \frac{A}{x+1}  + \frac{B}{x-1} + \frac{C}{(x-1)^{2}}
$$

同样的，我们有：

$$
\frac{x + 1}{ x^{3}(x -2)^{2}} = \frac{A}{x} + \frac{B}{x^{2}} + \frac{C}{x^{3}} + \frac{D}{x -2} + \frac{E}{(x-2)^{2}}
$$

## 例题7

如果分母主要是一个高次的因式，比如：

$$
\int \frac{x^{2}}{(x-1)^{3}(x+1)}
$$

此时，我们以重复因子为主题：令 $x -1 = y$ 则原式变为：

$$
\frac{x^{2}}{(x-1)^{3}(x+1)} = \frac{(1+y^{2})}{y^{3}(2+y)}
$$

然后计算 $\frac{1+y^{2}}{2 + y}$ 的长除结果：

$$
\frac{1}{2} + \frac{3y}{4} + \frac{y^{2}}{8} \cdots - \frac{y^{3}}{8}
$$

因此：

$$
\frac{x^{2}}{(x-1)^{3}(x+1)} = \frac{1}{y^{3}} \left[ \frac{1}{2} + \frac{3y}{4} + \frac{y^{2}}{8} - \frac{y^{3}}{8(2+ y)} \right ]
$$

这样计算更为简便。

## 例题8

先使用长除法，化到即约真分式：

$$
\int \frac{x^{3}}{(x-a)(x -b)} dx = \int  x + (a+b) + \frac{[(a+b)^{2} - ab]x - ab(a+b)}{(x-a)(x-b)} dx
$$

## 例题9

如果遇到了质因式，我们就需要手动的匹配阶：

$$
\int \frac{x^{2} + 1}{x^{4} + 1} dx = \int \frac{1 + \frac{1}{x^{2}}}{x^{2} + \frac{1}{x^{2}}} dx = \int \frac{1 + \frac{1}{x^{2}}}{\left( x+ \frac{1}{x}^{2} \right) - \frac{1}{4}}
$$

配方计算。

当然还会遇到加一项减一项：

$$
\int \frac{1}{x^{4}+1} dx = \frac{1}{2} \int \frac{1-x^{2}+x^{2} +1}{x^{4}+1} dx
$$

但是，我们在[[积分与积分计算#部分因式分解]] 已经提到了这是稍显复杂的分解，实际上回到配方法的因式分解即可解决，我们更加喜欢这种偏于技术分析的方法。

# 凑微分

凑微分是最基础的，考察最频繁的积分方法。具体来说是识别出：

$$
\int f(u(x)) u'(x) dx
$$

$u$ 的函数，$u$ 的导数。这一部分首先需要积累，对常见的初等函数的导数要敏感。特别是三角函数，指数函数、幂函数

凑微分的技巧性比较强。但是，题目中一般有明显的特征提示我们应该往哪个方向凑。此时，我们应该先凑出一个单独的 $u$ 的导数，再看剩下来的式子是否能够变形或者分离为 $u$ 的函数即可。

凑微分一定要多尝试，多凑一凑，对于隐藏较深的微分关系，只有这样才能被挖掘。

## 例题1 三角函数

$$
\int \sin ^{3}x \cos x dx  = \int \sin ^{3} x d \sin x = \frac{1}{4} \sin ^{4} x + C, 
$$

然而，由于三角函数之间的恒等变换过于灵活，有些时候可以使用万能法对三角有理式换元。

### 统一为多项式

$$
\int \frac{dx}{\sin 2x + 2 \sin x} = \int \frac{1}{2\sin x \cos x + 2\sin x} dx = \frac{1}{2} \int \frac{1}{\sin x(\cos x + 1)}dx
$$

这里凑微分肯定往 $\cos x$ 方向凑。那么为此，我们等式上下乘 $\sin x$ 得到

$$
\frac{1}{2} \int \frac{\sin x}{\sin ^{2}x(\cos x + 1) } dx = - \frac{1}{2} \int \frac{1}{(1-\cos ^{2}x)(\cos x + 1)} d\cos x
$$

> 这一题虽然技巧性较强，但是只要我们清楚凑微分的目标，根据题目的特征来尝试凑微分，是可以自然得到的。

### 平方和

$$
\int \frac{1}{3 \cos ^{2}x + \sin ^{2}x} dx = \int \sec ^{2}x \frac{1}{3+\tan ^{2}x} dx = \int \frac{1}{3+\tan ^{2}x} d \tan x
$$

## 例题2 幂函数

### 二次方

$$
\int x e^{x^{2}} dx = \frac{1}{2} \int e^{x^{2}} dx^{2}
$$

$$
\int \frac{x}{1+x^{4}}dx = \frac{1}{2} \int \frac{1}{1+x^{4}} dx^{2}
$$

### 分母的根式

$$
\int \frac{1}{\sqrt{ x(4-x) }} dx = 2 \int \frac{1}{ \sqrt{4-  \sqrt{ x }^{2} }} d\sqrt{ x } = 2 \arcsin \frac{x}{2} + C
$$

> 这里有更一般的方法：[[积分与积分计算#根式相积]] 

$$
\int \frac{1}{\sqrt{ x }(1 + \sqrt[3]{x})} dx = \int \frac{6t ^{5}}{t^{3}(1+ t ^{ 2})}dt = 6 \int \frac{t^{2}}{1+ t^{2}} dt = 6\left( \int 1 - \frac{1}{1+t^{2}}dt \right) = 6(\sqrt[6]{x} - \arctan \sqrt[6]{ x }) + c
$$

这里的幂次太小了，我们可以 $t = x^{6}, \sqrt{ x } = x^{3}. \sqrt[3]{ x } = x^{2}$

## 例题3 导数和本身

我们有：

$$
\frac{d}{dx} e^{ax}f(x) = e^{ax} ( f'(x) + af(x))
$$

因此遇到 $f'(x) + f(x)$ 这个结构的式子要有一点警惕。

比如我们在[[积分的方法与技巧#例题4 分部积分余项处理]] 中讨论的积分：

$$
\int e^{2x} (\tan x + 1)^{2} dx = \int e^{2x}( \sec ^{2}x + 2\tan x) = \int [e^{2x}\tan x]' dx = e^{2x} \tan x + C
$$

## 例题4 指数函数多项式

指数函数多项式都是可以凑微分的，这是由于任意常数都能被 $e^{\ln c}$ 表示，因此是关于$e^{x}$ 的齐次多项式。对于积分

$$
\int _{0} ^{+\infty} \frac{x e^{-x}}{(1 + e^{-x})^{2}} dx
$$

这只能，分部积分来解决，借由多项式 $x$。因此我们思考下式：

$$
\int \frac{e^{-x}}{(1+ e^{-x})^{2}} dx  = - \int \frac{1}{(1+e^{-x}）^{2}} d e^{-x} + 1 =  \frac{1}{1 + e^{-x}} dx
$$

一阶积分是简单的，凑微分的结构非常明显，但是再一次积分有难度：

$$
\int \frac{1}{1 + e^{-x}} dx = \int \frac{e^{x}}{e^{x} + 1} dx = \int \frac{1}{1+ e^{x}} d e^{x} = \ln (1+ e^{x})
$$

分子分母同乘来提供一个凑微分的元素。这种技巧在三角函数当中也适用，但是对阶的要求比较高。
# 三角函数

>[!important] 三角积分关乎到二重积分的大题计算
>- 由于二重积分当中常用极坐标换元，12分大题，最后的6分在积分计算，因此务必重视对于三角函数积分的多种技巧。以往对于Wallis公式的考察较为频繁，但是请谨慎对待积分上下限！！！如若不行，就回到最基础的高次幂求解。
>- 对于高次幂
>	- 正余弦，奇次幂凑微分，偶次方倍角公式
>	- 正余割，奇次幂分部找递推，偶次幂凑微分
>	- 正余切，记住有递推。
>- 对于三角有理式，我们总可以使用替换来达到统一成多项式的方法。但是往往可能比较复杂，我们期望积累一些三角变换方式和经验更快速的求得统一的形式。

##  有理式换元

> 我们说明 菲赫金哥尔茨 的 微积分学教程上给出的进一步分析。
> 更加深入的三角函数的二项式递推公式技术，收益较小了，这能够保底计算出。

> [!Lemma]
> 
> 如果 $R(u,v)$ 在变更它的一个自变量，例如， $u$ 的符号时，它的值不改变，即是，如果
> 
> $$R(-u,v) = R(u,v)$$
> 
> 则这个函数可以化成只包含有 $u$ 的偶次幂的形状
> 
> $$R(u,v) = R_1(u^2,v)$$
> 
> 相应地，如果在变更 $u$ 的符号时函数 $R(u,v)$ 也改变符号，即是，如果
> 
> $$R(-u,v) = -R(u,v)$$
> 
> 则对于函数 $\frac{R(u,v)}{u}$ 可以化为只包含有 $u$ 的偶次幂的形状：
> 
> $$R(u,v) = R_2(u^2,v)u$$

故而，对于三角有理式 $R(\sin x, \cos x)$ ，如果 $R(u,v)$ 在 $u$ 改变符号时，改变符号：

$$
R(\sin x,\cos x)dx = R_{0} (\sin ^{2}x, \cos x) \sin x dx = -R_{0}(1- \cos ^{2}x, \cos x) d \cos x
$$

此时我们采用 $t =\cos x$ 的替换

> $R(u,v)$ 的符号随着 $v = \cos x$  的符号变动则是类似的，相差一个负号。这里显然采用 $t= \sin x$ 的替换。

那么，当 $u$ 和 $v$ 的符号同时改变，函数 $R(u,v)$ 不变更自己的值：

$$
R(-u,-v) = R(u,v) \to R\left( \frac{u}{v}v , v\right) = R^{\star} \left( \frac{u}{v},v \right)
$$

我们可以用上述变换来统一到我们引理中说明两种情况，具体来说，变更 $u$ 与 $v$ 的符号 （比值 $\frac{u}{v}$ 在此并不改变），

$$
R^{\star} \left( \frac{u}{v},v \right) = R^{\star} \left(  \frac{u}{v}, -v \right)
$$

因此得到：

$$
R^{\star}\left( \frac{u}{v},v \right) = R_{1}^{\star} \left(  \frac{u}{v},v^{2} \right)
$$

故而：

$$
R(\sin x, \cos x) = R_{1}^{\star}(\tan x,\cos ^{2}x) = R_{1}^{\star}\left( \tan x, \frac{1}{1 + \tan ^{2}x} \right)
$$

此时做 $t = \tan x$ 的变换。

事实上，任何有理式， $R(u,v)$ 可做如下分解：

$$
R(u,v) = \frac{R(u,v) - R(-u,v)}{2} + \frac{R(-u,v)-R(-u,-v)}{2} + \frac{R(-u,-v)+R(u,v)}{2}
$$

我们给出几个例子来更好的说明，有目标的情况下换元或者说凑微分是简单的：

### 例题1

$\int \sin^2 x \cos^3 xdx$. 被积表达式在以 $-\cos x$ 代替 $\cos x$ 时改变符号。作替换 $t = \sin x$ 。这是则是告诉我们统一到 $\sin x$ 因此，对于这个表达式较为简单的，我们凑微分来表达：

$$
\int \sin ^{2}x \cos ^{3} x dx = \int \sin ^{2}x \cos ^{2} x d\sin x = \int \sin ^{2x}(1-\sin ^{2}x) d\sin x
$$

### 例题2


$$
\int \frac{dx}{\sin x \sin 2x}  = \int \frac{dx}{2\sin ^{2}x \cos x}
$$

> 首先要变形成 $R(\sin x,\cos x)$的形式。由于$\cos x$ 改变正负，因此统一到 $\sin x$ ，首先同时乘 $\cos x$ 满足凑微分的需求。

$$
\frac{1}{2} \int \frac{1}{\sin ^{2}x(1-\sin ^{2}x)} d\sin x \overset{t =\sin x}{=} \frac{1}{2} \int \frac{1}{t^{2}(1-t^{2})} dt 
$$

然后有理分式分解即可。这一题使用递推公式(2)会更加简易，但是递推公式记忆比较复杂，容易出错。

## 递推公式

主要为了解决形如 $\int \sin ^{v}x \cos ^{\mu}x dx$ 的积分问题，我们给出一种可以接受的妥协方法：

- 对于 $u,v$ 其中一个等于 $-1$  应该说是符合我们上面讨论的统一到 $\sin x$ 或者 $\cos x$ 的情况，并且较为简易。
- 对于高次幂相乘：
	- 如果都是偶次幂，比如 $\int \sin ^{2}x \cos ^{4}xdx$ 应当首先考虑 $\cos 2x$ 的二倍角公式降幂。
	- 对于 $R(\sin x,\cos x) = -R(-\sin x,\cos x)$ 以及 $R(\sin x,\cos x) = - R(\sin x,-\cos x)$的情况考虑使用递推公式。

我们有：
 
 $$
 \frac{d}{dx} \sin ^{v+1}x \cos ^{u+1}x = (v+1) \sin ^{v}x \cos ^{u+2} - (u+1)\sin ^{v+2} x \cos ^{u} x
 $$

进而得到升幂公式，对分母升幂

(I) $\int \sin^\nu x \cos^\mu x dx = - \frac{\sin^{\nu + 1} x \cos^{\mu + 1} x}{\mu + 1} + \frac{\nu + \mu + 2}{ \mu + 1} \int \sin^\nu x \cos^{\mu + 2} x dx \ (\mu \neq -1)$,
(II) $\int \sin^\nu x \cos^\mu x dx = \frac{\sin^{\nu + 1} x \cos^{\mu + 1} x}{\nu + 1} + \frac{\nu + \mu + 2}{\nu + 1} \int \sin^{\nu + 2} x \cos^\mu x dx \ (\nu \neq -1)$,

菲赫金哥尔茨的微积分学教程还给出了降幂公式，我们可以进一步的降低分子的幂次。我们从分部积分来说明，分部积分的一个技巧是分离出 $dv$ 易积分 #tool_idea 

我们有：

$$
I_{u,v} \triangleq \int \sin ^{u}x \cos ^{v}x dx = \int \cos ^{v -1} x \sin ^{u} x \cos x dx
$$

此时，我们凑出了 $\sin ^{u}x \cos x dx$ 这个易于积分的。因此根据分部积分公式得到：

$$
I_{u,v} = \cos ^{v-1} \times \frac{1}{u+1} \sin ^{u+1}x - \int \frac{1}{u+1} \sin ^{u+1}x d \cos ^{v-1}x
$$

化简得到：

$$
I_{u,v} = \frac{\cos ^{v-1} \sin ^{u+1}}{u+1} + \frac{v-1}{u+1} \int \sin ^{u+2} x \cos ^{v-2} x dx
$$

其中：

$$
\int \sin ^{u+2}x \cos ^{v-2}x dx = \int \sin ^{u}x \cos ^{v-2} x dx - \int \sin ^{u} x \cos ^{v} x dx = I_{u,v-2} - I_{u,v}
$$

代入得到：

$$
I_{u,v} = \frac{\cos ^{v-1} x \sin ^{u+1}x}{u+v} + \frac{v-1}{u+v}
$$

> 这里重要的是学习此处分部积分的思想。由于 $\sin x$ 和 $\cos x$ 导数是互相转换的，因此分部积分往往能够得到递推关系。

(III) $\int \sin^\nu x \cos^\mu x dx = \frac{\sin^{\nu+1} x \cos^{\mu-1} x}{\nu + \mu} + \frac{\mu - 1}{\nu + \mu} \int \sin^\nu x \cos^{\mu - 2} x dx \ (\nu + \mu \neq 0)$,
(IV) $\int \sin^\nu x \cos^\mu x dx = - \frac{\sin^{\nu-1} x \cos^{\mu + 1} x}{\nu + \mu} - \frac{\nu - 1}{\nu + \mu} \int \sin^{\nu - 2} x \cos^\mu x dx \ (\nu + \mu \neq 0)$.
## 高次幂
### 正余弦

>[!tips] 高次想倍角
>  完整的倍角公式，涉及到棣莫弗公式，我们仅仅做简要说明。我们指出，思路为：
>  - 高次幂三角函数转化为一次幂的倍角三角函数积分：
>  - 奇次幂直接凑微分
>  - 偶次幂使用二倍角

$$
\int \sin ^{3} dx = \int (1- \cos ^{2}) \sin x dx = \int \cos 2x -1  d \cos x
$$

> 凑微分是为了统一，统一到 $u$ 。那么对于三角函数，他们之间有着 恒等变换。需要把握住我们的目标和题干所提供的信息。进一步的，对于三角函数有理式，我们也可以使用万能代换来化简和统一。

更一般的，我们指出：

$$
\begin{align}
\int \sin ^{2n+1}x dx  & = \int \sin ^{2n}  x(-d\cos x) = - \int (1 - \cos ^{2}x)^{n} d \cos x \\
\int \cos ^{2n+1} x dx  &=  \int \cos ^{2n} xd \sin x = \int (1 - \sin ^{2}x)^{n} d\sin x
\end{align}
$$
将括号打开即可，这是套路化的。偶数次方也是一样的。尝试打开即可：

$$
\int \sqrt{ a^{2} - x^{2} } dx 
$$

这一题，定积分在一定程度上是简单的，因为他有着非常直观的几何意义。那么对于不定积分，首先我们应该想到换元：

$$
x = a\sin t \to a^{2} \int  \cos t d \sin t = a^{2} \int \cos ^{2} t dt
$$

那么这一步之后就需要用到一点，三角恒等变换了。这个方向的直觉是，三角函数的次数统一。也就是二倍角：

$$
a^{2} \int \frac{1+ \cos 2t}{2} dt
$$

> 这里是不定积分，换元之后还需要变换回去，因此使用万能代换虽然公式化，但是稍显繁琐

进一步的：

$$
\int \cos ^{4}x dx = \int \left(  \frac{1+ \cos 2x}{2} \right)^{2} dx = \frac{1}{4} \int (1 + 2\cos 2x + \cos ^{2}2x) dx
$$

> 对于积分而言，我们期望多项式以及底次幂！这样可以拆分。故而倍角公式非常有用

同理，对于：

$$
\int \sin ^{2} x dx = \int \frac{1 - \cos 2x}{2} dx = \frac{x}{2} - \frac{\sin 2x}{4} + C
$$


### 正余割

> [!凑微分和分部]
> - 如果是偶数次方，由于 $(\tan x)' = \sec ^{2}x$ 容易凑出微分
> - 如果是奇数次方，我们使用分部积分法，可以找到规律。关键在 $(\tan x \sec x)$ 的导数。

首先是 偶数：

$$
\begin{align}
\int \sec ^{2} x dx = \tan x + C, \int \sec ^{4} x dx =\int \sec ^{2} x \sec ^{2} x dx = \int (1+ \tan x) d \tan x \\
\int \csc ^{2} x dx = - \cot x + C, \int \csc ^{4} x dx = \int \csc ^{2} x \csc ^{2} x dx= -\int (1 + \cot ^{2}x) d \cot x
\end{align}
$$

关键在于 导数之间的关系

$$
\frac{d}{dx} \tan x \sec ^{n}x = (n+1)\sec ^{n+2}x - n\sec ^{n}x
$$

那么我们有：

$$
\sec ^{n+2} x = \frac{1}{n+1} \frac{d}{dx} \tan x \sec ^{n} x - \frac{n}{n+1}\sec ^{n}x
$$

取积分得到：

$$
\int \sec ^{n+2} x dx = \frac{1}{n+1} \tan x \sec ^{n}x + \frac{n}{n+1} \int \sec ^{n} x 
$$

我们又有：

$$
\int \sec x dx = \int \frac{\sec x(\sec x + \tan x)}{\sec x + \tan x}dx = \ln | \sec x + \tan x| + C
$$

对于 $\cot x$ ，我们也相似的对应导数关系：

$$
\frac{d}{dx}(\cot x \csc ^{n}x) = -(n+1)\csc ^{n+2}x + n \csc ^{n}x
$$

进一步的，我们指出，我们可以用分部积分法处理幂次较低的情况：

$$
\begin{align}
\int \sec ^{3} x dx &  = \int \sec x d\tan x = \sec x \tan x - \int \tan x d\sec x = \sec x \tan x - \int \tan ^{2}x \sec x dx \\
 & = \sec x \tan x - \int (\sec ^{2}x - 1) \sec x dx
\end{align}
$$

> 我们难以将 $\sec x$ 表示为 $f(\tan x)$ ，变为独立的 $u,v$ 。此时，我们回到我们最初提出的导数关系式，就天然适合分部积分操作。

### 正余切

$$
\int \tan ^{n} x dx = \int \tan ^{n-2}x (1- \sec ^{2} x) dx = \int \tan ^{n-2} x d\tan x - \int \tan ^{n-2}x d x
$$

> 这里也可以回想我们在换元中确定的原则，使用 $t = \tan x$ 的代换然后同样得到递推式。

因此 $\int \tan ^{n}x dx = \frac{\tan ^{n-1}x}{(n-1)} -\int \tan ^{n-2}x dx$ 。进一步的我们知道：

$$
\int \tan x dx = \ln |\cos x| + C, \int \tan ^{2}x dx = \tan x - x + C
$$
那么 $\cot x$ 也是类似的有:

$$
\int \cot ^{n}x dx = \int \cot ^{n-2}(\csc ^{2}x -1) dx = -\int \cot ^{n-2}x d\cot x - \int \cot ^{n-2}x dx
$$

# 配方

[[基础函数导数和积分]]中涵盖了可能的平方。对于二次多项式而言，我们可以通过配方凑出不同的组合。

主要是：

$$
\frac{1}{1+ x^{2}}, \frac{1}{1-x^{2}}, \frac{1}{\sqrt{ 1 -x^{2} }}, \frac{1}{\sqrt{ x \pm a^{2} }}
$$

最理想的结果是得到比较干净的分离结果，但是如果依然复杂，那我们就要进一步的考虑换元。这时候就是，[[三角换元]] 和 我们下面说到的欧拉替代法。

## 定积分

有一些题目会利用圆的几何意义来计算定积分，这时候通过配方然后换元可以减少思考，更加套路化：

$$
\int _{0}^{2} x \sqrt{ 2x - x^{2} }dx = \int _{0}^{2} x \sqrt{ 1 - (1 -x)^{2} } = \int_{-1}^{1} u\sqrt{1-u^2}du + \int_{-1}^{1} \sqrt{1-u^2}du
$$

第一部分是一个奇函数，对称区间定积分为$0$ ，第二部分代表上圆的面积。

这一题也给我们一个启发，还原到原点对称的区间有时候也非常的不错，换元之前肯可能没有想到的替换，换元之后可能更新加的通畅。

## 不止分式

在熟知的分式结构之外，我们指出下列几个积分同样可以直接积分。（当然我们可以通过三角换元欧拉替代法等方式计算得到）

$$
\int \sqrt{ a^{2} - x^{2} } dx = \frac{x^{2}}{2}\sqrt{ a^{2} - x^{2} } + \frac{a^{2}}{2} \arcsin \frac{x}{a} + C
$$

$$
\int \sqrt{ x^{2} + a^{2} } dx = \frac{x^{2}}{2} \sqrt{ a^{2} + x^{2} } + \frac{a^{2}}{2} \ln|x + \sqrt{ x^{2}+ a^{2} }| + C
$$

$$
\int \sqrt{ x^{2} - a^{2} } dx = \frac{x^{2}}{2} \sqrt{ x^{2} - a^{2} } - \frac{a^{2}}{2}  \ln |x+ \sqrt{ x^{2} - a^{2} }| + C
$$

## 不止二次方

$$
\int \frac{1}{x^{4}+1} dx = \int \frac{1}{(x^{4} + 2x^{2}+1) - 2x^{2}} dx
$$

通过平方差公式，我们就能够降低到标准的 $\arctan x$ 和 $\arcsin x$ 格式。

## 欧拉替代法

对于

$$
\int \frac{1}{\sqrt{ x^{2} + a }} dx 
$$

我们要说明简单的欧拉替代法，设：

$$
\sqrt{ x^{2} + a } = t - x \implies x^{2} + a = t^{2} + x^{2} - 2tx
$$

> [!tips] 欧拉替代法
> 核心在于消掉二次项，分离 $x,t$
> - $a > 0$ ，我们可以直接消$x^{2}$
> 	- $\sqrt{ ax^{2} + bx + c } = t - \sqrt{ a } \times x$
> - c > 0 ，消掉常数，然后除以$x$ 
> 	- $\sqrt{ ax^{2} + bx + c } = xt - \sqrt{ c }$ 

因此：$x = \frac{t^{2} - a}{2t}$

$$
\sqrt{ x^{2} + a } = \frac{t^{2} + a}{2t}
$$
$$
dx = \frac{t^{2} + a}{2t^{2}}dt
$$

因此，原式等于：

$$
\int \frac{ 1}{\sqrt{ x^{2} + a }} dx = \int \frac{1}{t} dt = \ln|t| + C = \ln | x + \sqrt{ x^{2} + a }| + C
$$



## 三角换元

$$\int \frac{dx}{(2x^2+1)\sqrt{x^2+1}}$$

> 指出，这里的 $x$ 有一般性，要善于配方。

当然这里也是欧拉替代法可以处理的范围，但是三角换元显然特征更加明显。我们设

令 $x = \tan t$，则 $dx = \sec^2 t dt$， $\sqrt{x^2+1} = \sec t$

$$\int \frac{\sec^2 t}{(2\tan^2 t + 1)\sec t} dt = \int \frac{\sec t}{2\tan^2 t + 1} dt = \int \frac{\cos t}{2\sin ^{2}t + \cos ^{2}t} dt = \int \frac{1}{1 + \sin ^{2}t}d \sin t$$ 
最后还需要还原到 $x$ 。

# 分部积分法

分部积分要把握住他调整阶的方向，也就是一个积分，一个导数。

$$
\int u v^{'} dx = uv - \int u'v dx
$$
进一步推广为：

$$
\int u v^{(n+1)} dx = uv^{(n)} - u' v^{(n-1)} + u'' v^{(n-2)} - \dots +  ( -1)^{n} u^{(n)} v + (-1)^{n+1} \int u^{(n+1)}v dx
$$

> [!tips] 分部积分法
> 我们指出，分部积分法的关键在于处理最后剩余的积分余项，因此我们有
> - 如果存在多项式，我们将其作为 $u$， 他的 高次幂将变为零，这样就可以消掉后续的所有。同时 $v$ 的积分最好不太复杂。
> - 等式两边的积分项，是倍数关系，或者相关。
> - $u,v$ 之间能够通过导数或者求积分转换到统一类型。比如 $\ln x, \arctan x,\arcsin x$ 都可以转化为多项式。 
## 例题1 多项式化0

$$
 \int( 2x^{3} + 3 x^{2} + 4x + 5) e^{x} dx
$$

$$
\begin{matrix}
u = 2x^{3} + 3x^{2}  + 4, &  v^{(n)} = e^{x} \\
u' = 6x^{2} + 6x, & v^{(n-1)} = e^{x} \\
u'' = 12 x + 6, & v^{(n-2)} = e^{x} \\
u''' = 12, & v^{(n-1)} = e^{x}
\end{matrix}
$$

> 这里的 $e^{x}$ 可以换为 $\sin x,\cos x$ 等等。即被推广为：
> $\int P(x) e^{ax} dx$ , $\int P(x) \sin bx dx,$ $\int P(x)\cos bx dx$

最简单的是：

$$
\int x e^{ax}  dx = \frac{1}{a} x e^{ax}  - \frac{1}{a^{2}} x e^{ax} + C
$$

## 例题2 反对幂三指（指三）

进一步的，对于积分并不规整的（其实这里的顺序和凑微分一样，都是决定谁应该是 $v'$，反对幂三指数），比如对数和幂函数，我们就要对 $x$ 积分而非 $\ln x$ 。那么这样的话，我们是没有办法通过多次导数消掉积分号，还是要看最后的积分是否可行：

$$
\int x \ln x dx =  \frac{1}{2} x^{2} \ln x - \int \frac{1}{2} x^{2} \frac{1}{x} dx = \frac{x^{2}}{2} \ln x - \frac{x^{2}}{4} + C
$$
进一步的我们有：

$$
\int x^{2} \ln x dx = \frac{1}{3}x^{3} \ln x - \int \frac{1}{3} x^{3} \frac{1}{x} dx = \frac{1}{3} x^{3} \ln x - \frac{1}{9} x^{3} + C
$$

## 例题3 “1”

这里指出，下列几个初等函数都是可以直接积分的，思考的时候应该把他们也当作平凡的可积分结果。

$$
\int \ln x dx = \ln x \cdot x - \int x d\ln x = \ln x \cdot x - \int 1dx = \ln x \cdot x - x + C
$$

$$
\begin{align}
\int \arctan x dx  & = \arctan x \cdot x - \int x d \arctan x = \arctan x \cdot x - \int x \frac{1}{ 1 + x^{2}} dx  \\
 &  = \arctan x \cdot x - \frac{1}{2} \int \frac{1}{ 1 +x^{2}} dx^{2} \\
 &  = \arctan x \cdot x - \frac{1}{2} \ln(x^{2} + 1) + C
\end{align}
$$

## 例题4 分部积分余项处理

我们指出，分部积分的关键在于处理余项。比较隐秘的余项处理，就是能够观察到分部积分之后等式两边的积分部分不存在关系。比如

$$
\int e^{x} \sin x dx
$$

这里 的 $e^{x}$ 有着积分不变性，而 $\sin x$ 则能够通过两次导数回到自身：

$$
\int e^{x} \sin x dx = e^{x} \sin x - e^{x} \cos x - \int e^{x} \sin x dx
$$

进一步的我们讨论：

$$
\int e^{2x} (\tan x + 1)^{2} dx
$$

拿到这个式子，首先没有任何思路，也不是分式，也不能换元，也没有明显特征的凑微分。因此只能考虑我们的分部积分。分部积分，我们期望对 $(\tan x + 1)^{2}$ 求积分然后分开，但是显然徒劳。因此，我们先最简单的分项：

$$
\int e^{2x} \tan ^{2} x dx + \int e^{2x} 2 \tan x dx + \int e^{2x} dx
$$

那么此时，我们应该了然，对于 $\int e^{2x} \tan ^{2}x dx$ 这些 也没有办法积分，分部积分到最后还是有积分号，并且依然是 $e^{x}$ 乘上复杂的三角函数结构。那么回想我们的 $\int e^{x} \sin x dx$ 我们实际利用了 $e^{x}$ 的 积分和导数不变性，通过两次分部积分使得 等式左右的积分部分能够统一。

我们知道 $\tan ^{2} x$ , $\tan x$是可积的，并且我们可以直接把 $\tan ^{2} x  + 1 = \sec ^{2}x$ 合起来处理。

那对于：

$$
\int e^{2x} \sec ^{2} x dx = e^{2x} \tan x - 2 \int e^{2x} \tan x dx
$$

刚好和我们的 $\int e^{2x} 2 \tan x dx$  抵销。因此原式等于：

$$
e^{2x} \tan x
$$

# 定积分

## 定积分 Wallis 公式

$$
\int_{0}^{\pi/2} \sin^{n} xdx = \int_{0}^{\pi/2} \cos^{n} xdx = \begin{cases}
\frac{n-1}{n} \cdot \frac{n-3}{n-2} \cdot \frac{1}{2} \cdot \frac{\pi}{2}, & n为偶数 \\
\frac{n-1}{n} \cdot \frac{n-3}{n-2} \cdot \frac{2}{3}, & n为奇数
\end{cases}
$$

> 如果被积区间为 $(0,\pi)$ 可以尝试区间再现，可达到区间对半的效果。
## [[区间再现恒等式]]

> 主要针对，我们无法统一到多项式的积分问题。这时候我们通过区间再现，寻找同一区间中的另一种表示方式，得到恒等式算出结果。
> 对于一些难以下手，无法求出初等原函数的，我们也应该首先考虑区间再现恒等式


$$
\int_{-\frac{\pi}{4}}^{\frac{\pi}{4}} \frac{cos^2 x}{1+e^{-x}}dx = \int _{- \frac{\pi}{4}} ^{0} \frac{\cos ^{2}x}{1 + e^{-x}} + \frac{\cos ^{2}(-x)}{1+ e^{x}}dx = \int _{-\frac{\pi}{4}}^{0} \cos ^{2}x dx
$$

## 平移变换

> 对于三角函数非常有用

求曲线$y=e^{-x}\sin x(x\geq0)$与$x$轴之间图形的面积。

这里的技术难点在于如何对正负交替的三角函数去掉绝对值，实际上面积表示为：

$$
\sum _{n=0}^{\infty} \int _{n\pi}^{(n+1)\pi} e^{-x}|\sin x| dx
$$

我们可以平移换元 $t = x -n\pi$ ,原式变为：

$$
\sum _{n_{0}}^{\infty} \int _{0}^{\pi} e^{-(n\pi + t)} \sin t dt =
$$

通过三角函数的换元和恒等变换，我们成功去掉了绝对值。

















