---
tags:
  - 高数
  - 考研
  - math
  - cheatsheet
  - 大题
---
> [!abstract] 偏导数（偏积分）、全微分、极限以及概念问题
> - 首先主要考察从一元向多元扩展的几个概念的异同。特别是关于连续、可微、偏导数连续、偏导数存在之间的辨析。
> - 对于偏导数，应该理解为固定另一个变量的取值后得到的一元函数的导数。求解时应当事先代入无关变量的值，得到表达式后再求解。
> - 通常而言，对于多元函数的可微性判断不使用其充分条件即偏导数连续，而是回归定义，即存在 $A,B, s.t.$
> 	- $dz = Adx + B dy + o(\rho)$ 其中 $\rho = \sqrt{(x-x_{0})^{2} + (y-y_{0})^{2} }$
> - 要把握住可微的两个必要条件之间并无充分关联。可微的充分条件即偏导数连续，并不具有必要性。唯一的充要条件是定义，通常概念题在此考察
> - 二重极限关注路径无关，使用放缩技巧+夹逼，给出统一的上下界。（极坐标换元也应当如此）
> - 多元微分概念题通常能够举出较为建议的特值，要训练这种技能
> - 偏导数、全微分首先在于运算。大题通常是二阶运算，要把握住微分形式不变这一规律。同时，如果有嵌套存在，要写清楚内部的结构。而运算大题，也要有主观的化简的动机。
> 	- 隐函数函数组利用线性方程组求解
> 	- 混合偏导数换序
> 	- 复杂结构考虑携带运算
> 	- 具体点需要代入求解，零值交乘项不必展开
> 	- 微分形式不变
> 	- 先考察清楚求导结构树再运算
> 	- 关注对称性简化运算
> - 要熟练掌握偏积分的使用，这是偏导数的逆运算。关键在于对于“任意常数”的扩展以及确定。
> - 极值问题是重点同时也是容易忽略的点。
> 	- 无条件极值，先求出驻点，再考察各个驻点的二阶导数情况。进一步的，出现 $AC - B^{2} = 0$ 要回归定义。一方面，为了说明满足定义，即邻域内的最小（大）值可以使用极限的保号性；另一方面，为了说明不满足，只需取不同路径得到不同领域的不同大小状况。
> 	- 条件极值问题。
> 		- 求解边界条件，转换为无条件极值。如果是极坐标，可以使用极坐标代换之后代入方程当中。
> 		- 拉格朗日乘数法（重点）
> 		- 柯西方程
> 		- 均值不等式

# 概念

## 例题1

已知函数 $f(x,y) = \begin{cases} (x^2+y^2)\sin\frac{1}{xy}, & xy\neq 0, \\ 0, & xy=0.\end{cases}$ , 则在点(0,0)处( )

(A) $\frac{\partial f(x,y)}{\partial x}$ 连续, $f(x,y)$ 可微.
(B) $\frac{\partial f(x,y)}{\partial x}$ 连续, $f(x,y)$ 不可微.
(C) $\frac{\partial f(x,y)}{\partial x}$ 不连续, $f(x,y)$ 可微. 
(D) $\frac{\partial f(x,y)}{\partial x}$ 不连续, $f(x,y)$ 不可微.

> 多元函数可微的充分条件即偏导数连续过强。这里也非常好的展现了，存在偏导数不连续的可微函数。概念题中，我们一般使用全微分定义来说明可微。

对于偏导数连续，我们同样使用极限值等于函数值。进一步要再次辨析，导函数的极限和导数的左极限和右极限。

当导数左极限等于右极限时，我们有这一点的导数值。导函数是函数表达式求导所得。回到偏导数定义,我们应该查看$y =0$ 时候，关于 $x$ 的左右邻域内的导数：

$$\left.\frac{\partial f(x,y)}{\partial x}\right|_{(0,0)} = \lim_{\Delta x \to 0} \frac{f(\Delta x,0)-f(0,0)}{\Delta x} = \lim_{\Delta x \to 0} \frac{0-0}{\Delta x} = 0$$

即：
$$
\lim_{ x \to 0,y = 0 } \frac{ x ^{2} \sin \frac{1}{0}}{x} = 0
$$

因此偏导数为 $0$

当 $xy \neq 0$ 时 偏导数为：

$$
\frac{ \partial (x^{2}+ y^{2}) \sin \frac{1}{xy} }{ \partial x }  = 2x \sin \frac{1}{xy} + (x^{2}+ y^{2}) \cos \frac{1}{xy} \times\left(  -\frac{1}{x^{2}y} \right)
$$

事实上，导函数的 $x \to 0, y \to 0$ 的极限并不存在（任取路径，但注意不要取 $y = 0$）。进而，我们考虑使用全微分判断，函数在 $0,0$ 是否可微，即是否存在：

$$
df = A dx + B dy + o(\rho) \to \lim_{ dx \to 0, dy \to 0 }  \frac{df - A dx - B dy}{\rho} = \lim \frac{o(\rho)}{\rho} = 0
$$

其中 $df = f(dx,dy) - f(0,0), \rho = \sqrt{ (dx)^{2} + (dy)^{2} }$ 实际上，取 $A = B = 0$ 即可：

$$\lim_{\Delta x \to 0} \lim_{\Delta y \to 0} \frac{f(\Delta x, \Delta y)-f(0,0)-0 \cdot \Delta x - 0 \cdot \Delta y}{\sqrt{(\Delta x)^2 + (\Delta y)^2}} =$$

$$\lim_{\Delta x \to 0} \lim_{\Delta y \to 0} \sqrt{(\Delta x)^2 + (\Delta y)^2} \sin \frac{1}{\Delta x \Delta y} = 0$$

## 例题2

$f(x,y) = \begin{cases} xy, & xy \neq 0, \\ x, & y = 0, \\ y, & x = 0, \end{cases}$

给出以下结论：

-  $\frac{\partial f}{\partial x}|_{(0,0)} = 1$;

考察 $y = 0$ 时，$x$ 邻域的情况，显然 $\frac{ \partial f }{ \partial x }|_{(0,0) }= \lim_{ \Delta \to 0 } \frac{ \Delta x  }{  \Delta x }= 1$ 

-  $\frac{\partial^2 f}{\partial x \partial y}|_{(0,0)} = 1$;

回到二阶导数的定义：

$$
\lim_{ \Delta y \to 0 }  \frac{ \frac{ \partial f }{ \partial x } |_{(0,\Delta y)} - \frac{ \partial f }{ \partial x } |_{(0,0)}  }{\Delta y}
$$

显然当 $\Delta y \neq 0, \frac{ \partial f }{ \partial x }|_{(0,\Delta y)}$ 不存在。


显然，从不同路径，趋向于 $(0,0)$ 极限都是 $0$  ，回到极限定义来说明。事实上，为了蕴含从不同路径，我们只需要找到一个 $g(x)$ 控制住所有情况下 的 $|f(x,y)|$ 即可。最简单就是：

$$
0 \le |f(x,y)| \le |xy + x + y| \le |x| + |y| + | xy| = 0, x\to 0, y \to 0
$$

得证。

-  $\lim_{(x,y) \rightarrow (0,0)} f(x,y) = 0$;
-  $\lim_{x \rightarrow 0} \lim_{ y \to 0 } f(x,y) = 0$.

## 例题3

1. (12-1) 如果函数 $f(x,y)$ 在点 $(0,0)$ 处连续, 那么下列命题正确的是( )

同样考察全微分定义。这里有一些技术细节，首先是根据分母为零推出分子极限：

$$
\lim_{ x \to 0,y\to 0 } f(x,y) = 0 = f(0,0)
$$

我们直接说明 $B$ ，我们有：$f(x,y) = O(x^{2}+ y ^{2}) , x \to 0, y\to 0$ 从而：

$$
\lim_{ x \to 0, y \to 0 } \frac{f(x,y) - f(0,0) - 0x - 0y}{\sqrt{ x^{2} + y^{2} }}  = \lim_{ \Delta x,\Delta y \to (0,0) }  \frac{f(\Delta x,\Delta y) - f(0,0) - 0 \Delta x - \Delta y}{\sqrt{ (\Delta x)^{2} + (\Delta y)^{2} }} = 0
$$

因此可微。并且 $\frac{ \partial f }{ \partial x }= 0, \frac{ \partial f }{ \partial y } = 0$. 进一步的对于A，$|x|+|y|$ 的 阶太小了，因此 仅仅存在还不够需要极限为 0 才行。

(A) 若极限 $\lim_{x \to 0, y \to 0} \frac{f(x,y)}{|x|+|y|}$ 存在, 则 $f(x,y)$ 在点 $(0,0)$ 处可微。
(B) 若极限 $\lim_{x \to 0, y \to 0} \frac{f(x,y)}{x^2+y^2}$ 存在, 则 $f(x,y)$ 在点 $(0,0)$ 处可微。

可微显然说明不了$f(x,y)$ 的阶

(C) 若 $f(x,y)$ 在点 $(0,0)$ 处可微, 则极限 $\lim_{x \to 0, y \to 0} \frac{f(x,y)}{|x|+|y|}$ 存在。
(D) 若 $f(x,y)$ 在点 $(0,0)$ 处可微, 则极限 $\lim_{x \to 0, y \to 0} \frac{f(x,y)}{x^2+y^2}$ 存在。

## 例题4

设连续函数 $z=f(x,y)$满足 $\lim_{x\to0,y\to1} \frac{f(x,y)-2x+y-2}{\sqrt{x^2+(y-1)^2}}=0$ 则 $dz|(0,1)=$。

这一题同样考察全微分定义，但是在考场上，不妨举出特指：

$$
f(x,y) : = 2x - y + 2
$$

则 

$$
dz|_{(0,1)} = 2 dx - dy
$$
# 偏导数和全微分

## 例题1

设置函数 $f(x,y) = \int_0^{xy} e^{xt^{2}}dt$, 则 $\frac{\partial^2 f}{\partial x \partial y}|_{(1,1)}$ =

> 调换偏导顺序，初等函数显然是连续的。这和我们看到重积分下意识思考交换积分顺序一致。这里看到 $x$ 在被积函数内部。因此交换。

$$
\frac{ \partial ^{2}f }{ \partial  x \partial y } = \frac{ \partial ^{2} f }{ \partial y \partial x} = \frac{ \partial  }{ \partial x } x e^{x^{3}y^{2}}  = e^{x^{3}y^{2}}(1 + x \times 3x^{2}y^{2}) 
$$

## 例题2

设函数 $f(u,v)$ 具有 2 阶连续偏导数，$y=f(e^x,cosx)$，求 $\frac{dy}{dx}|_{x=0}$，$\frac{d^2y}{dx^2}|_{x=0}$。

> 主要要说明，我们通常计算会忽略函数内部形式。

$$
\begin{align}
 & \frac{dy}{dx} = f'_{1}e^{x} - f'_{2} \sin x = f'_{1}(1,1) \\
 & \frac{d}{dx} \left( \frac{dy}{dx} \right) = e^{x}( f'_{1} + f''_{11}e^{x} - f''_{12}\sin x) - (f''_{21} e^{x} - f''_{22}\sin x)\sin x -f'_{2} \cos x  \\
 & = f'_{1}(1,1) + f''_{11} - f'_{2}
\end{align}
$$

最后的答案应该代入点。同时计算的时候也要关注，比如 $\sin x$ 前面的项就没有必要展开。

## 例题3

函数$f(u,v)$由关系式$f[xg(y),y]=x+g(y)$确定,其中函数$g(y)$可微,且$g(y)\neq 0$,则$\frac{\partial^2 f}{\partial u \partial v} =$ 

> 这一题并不求 $x,y$ 的偏导数，而是求 $u,v$ 因此直接换元即可。

令 $u = xg(y),v = y$ 则：

$$
f(u,v) = \frac{u}{g(v)} + g(v)
$$

因此：

$$
\begin{align}
\frac{ \partial f }{ \partial u }  = \frac{1}{g(v)} \\
\frac{ \partial ^{2}f }{ \partial u \partial v}  = - \frac{g'(v)}{g^{2}(v)}
\end{align}
$$

## 例题4

已知函数$f(u,v)$具有二阶连续偏导数, $f(1,1)=2$ 是$f(u,v)$的极值, $z=f[x+y,f(x,y)]$, 求$\frac{\partial^2 z}{\partial x \partial y}|_{(1,1)}$。

> 由于现在的$f$ 内部结构不同了，我们需要运用微分形式不变，以及最后求出具体的值，因此，我们需要携带内部结构运算。

$x,y$ 地位一致，没有换序必要

通过极值必要条件得到 $f_{1}(1,1) = f_{2}(1,1) = 0$ 

> 在计算中，他们的交乘项不需要打开。写符号即可

$$
\begin{align}
\frac{ \partial z }{ \partial x }  & = f_{1}(x+y,f(x,y)) + f_{2}(x+y,f(x,y))[f_{1}(x,y)] \\
\frac{ \partial  }{ \partial y } \left( \frac{ \partial z }{ \partial x }  \right)   & = \left[  f_{11}(x+y,f(x,y)) + f_{12}(x+y,f(x,y)) [f_{2}(x,y)] \right] +   \\
 & \frac{ \partial  f_{2}(x+y,f(x,y)) }{ \partial y }  f_{1}(x,y) + f_{2}(x+y,f(x,y))[f_{12}(x,y)] \\
 & = f_{11}(2,2) +f_{2}(2,2)f_{12}(1,1) 
\end{align} 
$$

## 例题5

设 $u=f(x,y,z)$ , $\varphi(x^2,e^y,z)=0$ , $y=\sin x$，其中$f$,$\varphi$ 都具有一阶连续偏导数, 且 $\frac{\partial \varphi}{\partial x} \neq 0$，求 $\frac{du}{dx}$

自变量只有一个，现在是 $x$ ，求导数要把 $y,z$ 都视为关于 $x$ 的函数。

$$
\frac{du}{dx} = f'_{x} + f'_{y} \frac{dy}{dx} + f'_{z} \frac{dz}{dx}
$$

其中，$y$ 是显式确定的，因此导数为

$$
\frac{dy}{dx} = \cos x
$$

$z$ 则有隐函数 $\varphi$ 确定，因此，两边对$x$ 求导得到：

$$
\varphi'_{1} 2x + \varphi'_{2} e^{y} \frac{dy}{dx} + \varphi'_{3} \frac{dz}{dx} = 0 \to \frac{dz}{dx} = - \frac{ \varphi'_{1}2x + \varphi _{2}' e^{\sin x} \cos x}{ \varphi'_{3}}
$$

## 例题6

设$z=z(x,y)$是由方程$x^2+y^2-z = \varphi(x+y+z)$ 所确定的函数,其中$\varphi$具有2阶导数且$\varphi' \neq -1$.

(1) 求$dz$;

$$
F(x,y,z) \triangleq x^{2} + y^{2} - z = \varphi(x+y+z)
$$

先求出对应各自的偏导数：

$$
\frac{ \partial z }{ \partial x } = - \frac{F'_{x}}{F'_{z}} = \frac{2x - \varphi'}{1+\varphi'}
$$

由对称性得到：

$$
\frac{ \partial z }{ \partial y }  = \frac{2y - \varphi'}{1+\varphi'}
$$


(2) 记$u(x,y) = \frac{1}{x-y}(\frac{\partial z}{\partial x} - \frac{\partial z}{\partial y})$,求$\frac{\partial u}{\partial x}$.

之际算会异常复杂，尝试将第一问求出的代入先进行化简在求导：

$$
u(x,y) = \frac{2}{ 1+ \varphi'} \to \frac{ \partial  }{ \partial x } \left( \frac{2}{1+ \varphi'} \right)  = - \frac{2}{(1+\varphi')^{2}} \frac{ \partial \varphi' }{ \partial x } 
$$

其中：

$$
\frac{ \partial \varphi' }{ \partial x }  = \frac{ \partial \varphi'(x+y+z) }{ \partial x }  = \frac{ \partial \varphi(x+y+z) }{ \partial (x+y+z) }  \frac{ \partial (x+y+z) }{ \partial x }  = \varphi'' \left( 1+ \frac{ \partial z }{ \partial x }  \right)
$$


# 已知偏导数求原函数

> [!tips] 偏积分或者微分方程
> - 微分方程
> 	- 注意整体化简，化简的思路主要是凑微分。
> 	- 把握住对谁积分的，这关系到求解。
> - 偏积分主要任意常数的扩展和确定

## 例题1

设函数 $f(u)$ 具有 2 阶连续导数, $z=f(e^x cos y)$ 满足

$$\frac{\partial^2 z}{\partial x^2} + \frac{\partial^2 z}{\partial y^2} = (4z + e^x cos y)e^{2x}$$

若 $f(0)=0, f'(0)=0$，求 $f(u)$ 的表达式。

首先依旧是化简计算的基本功：

$$
\begin{align}
\frac{ \partial z }{ \partial x }  = f' \cos y e^{x} & , \frac{ \partial ^{2}z }{ \partial x^{2} }  = \cos y e^{x}( f'' \cos ye^{x} + f') \\
\frac{ \partial z }{ \partial y } - f' \sin x e^{x} & , \frac{ \partial ^{2}y }{ \partial x^{2} }  = -e^{x}(f'' (-\sin y)e^{x} \sin y + f' \cos y)
\end{align}
$$

因此我们有：

$$
f'' e^{2x}\cos ^{2}y +  \cos y e^{x} f' + e^{2x} \sin ^{2} y f'' - \cos y e^{x} f' =(4z + e^{x}\cos y)e^{2x}
$$

化简得到：

$$
f''(e^{x}\cos y) = 4 f(e^{x}\cos y) + e^{x}\cos y
$$

这里显然是一个常微分方程，我们求出 $f(u)$ 。但这里也显然是一个陷阱，如果没有将导数内部写完全很容易写成：

$$
y'' - 4y = e^{x}\cos y
$$

然后按照 $e^{x}\cos y$ 作为非齐次的 $Q(x)$ 。但实际上我们得到的微分方程为（令 $u = e^{x}\cos y$ ）

$$
y'' - 4y = t
$$

## 例题2

已知函数 $f(x,y)$ 满足 $\frac{\partial f}{\partial y} = 2(y+1)$, 且 $f(y,y) = (y+1)^2 - (2-y)lny$ , 求曲线 $f(x,y) = 0$ 所围图形绕直线 $y=-1$ 旋转所成旋转体的体积。

首先我们通过偏积分：

$$
f(x,y) = \int \frac{ \partial f }{ \partial y } dy = \int 2(y+ 1)dy = y^{2} + 2y +c(x)
$$

那么有：

$$
f(y,y) = y^{2}+ 2y + c(x(y)) = (y+1)^{2} - (2-y)\ln y
$$

因此 $c(x) = 1 - (2-x)\ln x$ 因此 $f(x,y) = y^{2} + 2y + 1 + (x-2)\ln x$

这里的关键点在于如何理解 $f(x,y)=0$ 。这应该是一个隐函数，表示了一个 $y(x)$ 或者 $x(y)$ 
$$
(y+1)^{2} - (2-x)\ln x \to y+1 = \sqrt{ (2-x)\ln x }, 1<x<2
$$

这个表达式对应的图像关于$y=-1$ 旋转，那么我们可向上平移一个单位 得到：

$$
y = \sqrt{ (2-x)\ln x } - 1+ 1 \to y = \sqrt{ (2-x)\ln x } 
$$

所求体积为这个表达式绕 $x$ 轴旋转：

$$
\int _{1}^{2} \pi (2-x)\ln x dx
$$

## 例题3

设函数 $f(u,v)$ 具有 2 阶连续偏导数, 且函数 $g(x,y) = f(2x+y, 3x-y)$ 满足 $\frac{\partial^2 g}{\partial x^2} + \frac{\partial^2 g}{\partial x \partial y} - 6\frac{\partial^2 g}{\partial y^2} = 1$.

(1) 求 $\frac{\partial^2 f}{\partial u \partial v}$;

求出为 $\frac{ \partial ^{2} f }{ \partial x \partial y } = \frac{1}{25}$ 

(2) 若 $\frac{\partial f(u,0)}{\partial u} = ue^{-u}$, $f(0,v) = \frac{1}{50}v^2 - 1$, 求 $f(u,v)$ 的表达式。

> 实在没有思路想想第一问能够提供什么？当然这一题还是偏积分回去。

$$
\frac{ \partial f }{ \partial x }  = \int  \frac{ \partial ^{2}f }{ \partial  x \partial y }  dy = \frac{1}{25} y + c(x)
$$

因此：

$$
\frac{ \partial f(x,0) }{ \partial x } = xe^{-x} = c(x) \to \frac{ \partial f }{ \partial x } = \frac{1}{25}y + x e^{-x}
$$

再一次偏积分：

$$
f(x,y) = \frac{1}{25} xy + (-e^{-x}x - e^{-x}) + c(y)
$$

> 这里的  “任意常数”仍然应当待定为 $y$ 的函数。

又有：

$$
f(0,y) = -1 + c(y) = \frac{1}{50}y^{2} - 1 \to c(y) = \frac{1}{50} y^{2}
$$

因此我们有：

$$
f(x,y) = \frac{1}{25}xy + \frac{1}{50}y^{2} -e^{-x}(x+1)
$$

## 例题4

$f(u)$ 具有连续导数，且 $z=f(x^2+y^2)$ 满足 $x\frac{\partial z}{\partial x} + y \frac{\partial z}{\partial y} = z(x^2+y^2)^{2}$. 若 $f(0)=1$, 求 $f(u)$

由于 $\frac{\partial z}{\partial x} = 2xf'(x^2+y^2)$, $\frac{\partial z}{\partial y} = 2yf'(x^2+y^2)$.

故由 $\frac{\partial z}{\partial x} + y \frac{\partial z}{\partial y} = z(x^2+y^2)$ 知 $2(x^2+y^2)f'(x^2+y^2)=(x^2+y^2)f(x^2+y^2)$.

> 这里实际上除了 $x^{2}+y^{2}$ ，需要假定其不为零，但是由于原函数是连续的，因此缺少有限点是无关的，函数值依旧，表达也可统一
> 另外关键要知道 $f'(x^{2}+y^{2})$ 是关于 $(x^{2}+y^{2})$ 的导数，进而可以换元化简。

即 $2f'(u)=uf(u)$. 解此微分方程，得 $f(u) = Ce^{\frac{1}{2}u^2}$.

由于 $f(0)=1$ 得 $C=1$, 故 $f(u)=e^{\frac{1}{2}u^2}$.

# 隐函数

 > 对于一个函数方程确定的隐函数比较简单，代入求解或者使用公式即可解决。但是不乏有方程组确定的隐函数关系，这是值得注意的。[[多元函数微分学#方程组的情形]]

## 例题1

设 $y=y(x)$, $z=z(x)$ 由方程 $z=x f(x+y)$ 与 $F(x, y, z) = 0$ 确定, 其中 $f$  有二阶连续导数, $F$ 有二阶连续偏导数, 求 $\frac{dz}{dx}$。

> 注意符号和所求，这也暗示着这个系统中仅仅有一个自变量也就是 $x$

盯住目标，那么我们对两式求关于 $x$ 的导数：

$$
\begin{cases}
F_x' + F_y' \frac{dy}{dx} + F_z' \frac{dz}{dx} = 0 \\
\frac{dz}{dx} = f + x f' \left( 1+ \frac{dy}{dx} \right)
\end{cases}
$$

直接消元有点麻烦，我们可以转化为求解线性方程组：

$$\begin{cases}
-xf'\frac{dy}{dx}+\frac{dz}{dx}=f+xf', \\
F'\frac{dy}{dx}+F'\frac{dz}{dx}=-F'_{x}.
\end{cases}$$

根据克拉默法则，当有意义时（分母不为零）

$$\frac{dz}{dx} = \left| \begin{matrix} -xf' & f+xf' \\ F'_y & -F'_x \end{matrix} \right| / \left| \begin{matrix} -xf' & 1 \\ F'_y & F'_z \end{matrix} \right| = \frac{F'_y(f+xf')-xf'F'_x}{xf'F'_z+F'_y}$$

> 实际就是隐函数方程组公式的推导。掌握解方程组的思想即可。
## 例题2

设函数 $u=f(x,y)$ 具有二阶连续偏导数,且满足等式 $4\frac{\partial^2 u}{\partial x^2} + 12\frac{\partial^2 u}{\partial x \partial y} + 5\frac{\partial^2 u}{\partial y^2} = 0$,确定 $a,b$ 的值,使等式在变换 $\zeta = x+ay, \eta = x+by$ 下简化为 $\frac{\partial^2 u}{\partial \zeta \partial \eta}=0$.

> [!warning]- 典型错误，求导不完全
> 对于 
> 
> $$\frac{\partial u}{\partial x} = \frac{\partial u}{\partial \zeta} \frac{\partial \zeta}{\partial x} = \frac{\partial u}{\partial \zeta}$$
> 
> 进一步的，我们有：
> 
> $$
> \frac{\partial ^{2}u}{\partial x^{2}} = \frac{\partial \frac{\partial u}{\partial \zeta}}{\partial \eta} \frac{\partial \eta}{\partial x} = \frac{\partial ^{2}u}{\partial \zeta \partial \eta}
> $$
> 
> 同理我们有：
> 
> $$
> \frac{\partial ^{2}u}{\partial x \partial y} = a \frac{\partial ^{2} u}{\partial \zeta  \partial \eta} = \frac{ \partial u }{ \partial y \partial x }  = b \frac{ \partial ^{2}u }{ \partial \zeta \partial \eta } 
> $$
> 
> 二阶连续偏导数说明其相等，因此我们得到 $a = b$ 同时：
> 
> $$
> \frac{ \partial ^{2}u }{ \partial y^{2} }  = ab\frac{ \partial ^{2}u }{ \partial \zeta \partial \eta }
> $$
> 
> 因此有：
> 
> $$
> (5 ab + 12 a + 4) \frac{\partial ^{2}u}{\partial \zeta \partial \eta} = 0
> $$
> 
> 因此，当$5ab + 12a + 4 \neq 0$ 时即可。

我们有$u(x,y)$ ，同时有 $\zeta = x + ay， \eta = x + by$ 因此，树状图为：

$$
f \begin{cases}
\zeta \begin{cases}
x \\
y
\end{cases} \\
\eta \begin{cases}
x \\
y
\end{cases}
\end{cases}
$$

这是典型的有一个隐函数方程组确定的函数关系的求导问题。我们常见的都是给定了 $\zeta,\eta$ 的偏导数进一步求关于$x,y$ 的，但这里反过来了。因此我们有：

$$
\frac{ \partial u }{ \partial x }  = \frac{ \partial u }{ \partial \zeta } \frac{ \partial \zeta }{ \partial x } + \frac{ \partial u }{ \partial \eta } \frac{ \partial \eta }{ \partial x } = \frac{ \partial u }{ \partial \zeta } + \frac{ \partial u }{ \partial \eta } 
$$

进一步的：

$$
\begin{align}
\frac{ \partial  }{ \partial x } \left( \frac{ \partial u }{ \partial x }   \right)   & = \frac{ \partial  }{ \partial x } \left( \frac{ \partial u }{ \partial \eta } + \frac{ \partial u }{ \partial \zeta }  \right)  \\
 & =  \left( \frac{ \partial  }{ \partial \zeta } + \frac{ \partial  }{ \partial \eta }  \right) \left( \frac{ \partial u }{ \partial \eta } + \frac{ \partial u }{ \partial \zeta } \right)   \\
 & = \frac{ \partial ^{2}u }{ \partial \zeta ^{2} }  + 2 \frac{ \partial ^{2}u }{ \partial \zeta \partial \eta}  + \frac{ \partial ^{2}u }{ \partial \eta ^{2} } 
\end{align}
$$

要抓住对$x$ 和 对 $y$ 的偏导要分解。即：

$$
\frac{ \partial  }{ \partial x }  = \frac{ \partial  }{ \partial \zeta } + \frac{ \partial  }{ \partial \zeta } , \frac{ \partial  }{ \partial y } = a \frac{ \partial  }{ \partial \zeta } + b \frac{ \partial  }{ \partial \eta } 
$$

因此我们得到：

$$\frac{\partial^2 u}{\partial x \partial y} = a \frac{\partial^2 u}{\partial x^2} + (a+b) \frac{\partial^2 u}{\partial x \partial y} + b \frac{\partial^2 u}{\partial y^2}$$

$$\frac{\partial u}{\partial y} = a \frac{\partial u}{\partial x} + b \frac{\partial u}{\partial y}$$

$$\frac{\partial^2 u}{\partial y \partial x} = a \frac{\partial^2 u}{\partial x^2} + 2ab \frac{\partial^2 u}{\partial x \partial y} + b^2 \frac{\partial^2 u}{\partial y^2}$$

代入 $4 \frac{\partial^2 u}{\partial x^2} + 12 \frac{\partial^2 u}{\partial x \partial y} + 5 \frac{\partial^2 u}{\partial y^2} = 0$:

$$(5a^2 + 12a + 4) \frac{\partial^2 u}{\partial x^2} + [10ab + 12(a+b) + 8] \frac{\partial^2 u}{\partial x \partial y} + (5b^2 + 12b + 4) \frac{\partial^2 u}{\partial y^2} = 0$$

由：

$$
\begin{cases}
5a^2+12a+4=0, \\
5b^2+12b+4=0, \\
10ab+12(a+b)+8\neq0
\end{cases}
$$

得：

$\begin{cases} a = -2, \\ b = - \frac{2}{5} \end{cases}$ 或 $\begin{cases} a = -\frac{2}{5}, \\ b = 2\end{cases}$.


# 无条件极值

> [!attention] 细节
> 这里最大的运算首先是 求出驻点，也就是求解方程组，求解方程组最大的危险就是消去了零根，这一点要尤为注意。

## 例题1

设某产品的产量 $Q$ 由资本投入量 $x$ 和 劳动投入量 $y$ 决定, 生产函数为 $Q=12x^{\frac{1}{2}}y^{\frac{1}{6}}$. 该产品的 销售单价 $p$ 与 $Q$ 的关系为 $p=1160-1.5Q$. 若单位资本 投入和单位劳动投入的价格分别为 6 和 8,求利润最大时产量。

> 这一题的求解思路是显然的，但是有一些计算和求解上的思路需要说明，备用。

无条件极值的第一步是先求出驻点，那么也就是求解下列方程组：

$$
\begin{align}
\frac{ \partial pQ  }{ \partial x } = 6 \to \frac{ \partial \left( 1160 - \frac{3}{2}Q \right) Q }{ \partial x } = 6  \\
\frac{ \partial pQ }{ \partial y }  = 8 \to \frac{ \partial (1160 - \frac{3}{2}Q)Q }{ \partial x } = 8
\end{align} \tag{2.1.1}
$$

首先，那么关键在于求解$\frac{ \partial Q }{ \partial x },\frac{ \partial Q }{ \partial y }$。对于生产函数 $Q = 12 x^{1/2}y^{1/6}$ 我们可以化为隐函数，然后两边求对数（这是对柯布道格拉斯生产函数的常规操作）：

$$
\ln Q - \frac{1}{2} \ln x - \frac{1}{6} \ln y = 0 
$$

那么我们有：

$$
\begin{cases}
\frac{1}{Q} \frac{ \partial Q }{ \partial x }  = \frac{1}{2x} \\
\frac{1}{Q} \frac{ \partial Q }{ \partial y }  = \frac{1}{6y}
\end{cases}
$$

代入 （2.1.1）得到：

$$
\begin{cases}
1160 \frac{Q}{2x} - \frac{3Q^{2}}{2x} = 6 \\
1160 \frac{Q}{6y} - \frac{3Q^{2}}{6y} = 8
\end{cases} \to 
\begin{cases} \tag{2.1.2}
1160 Q - 3Q^{2} = 12x   \\
1160 Q - 3Q^{2} = 48y 
\end{cases}
$$

那么首先得到 $12x = 48y \to x = 4y$  这个关系。然后代入会（2,1,2）当中展开得到：

$$
1160 \times 12 x^{1/2}y^{1/6} - 3 \times 12 \times 12 x y ^{1/3} = 12 x
$$

看指数，我们应该把$x$ 替换为 $y$ 平方根相较于六次根和三次根号更为简单：

$$
1160 (4y) ^{-1/2}y^{1/6} - 36 y^{1/3} = 1 \to 580 y^{-1/3} - 36y^{1/3} = 1
$$

我们负的指数当然消掉，我们得到：

$$
36 y^{2/3} + y^{1/3}  - 580=0
$$

因此是一个关于 $t = y ^{\frac{1}{3}}$ 的二次方程：

$$
36 t^{2} + t - 580 = 0
$$

因式分解是不简单的。幸好$580 = 4 \times 5 \times 29$ 的因数较少。$36= 2 \times 2\times 3 \times 3$ 我们首先分析一下根的情况。对称轴为 $t= - \frac{1}{72}$  也就是两个根几乎是按 $y$ 轴对称的。估计一下根的大小 $(4,5)$  

尝试十字相乘，那我们首先尝试 $-580 = - (20 \times 29)$ 差不多 $4$ 倍 的话，$36$ 分解应该为 $4 \times 9$ 显然不行。那继续 尝试 $-580 = -( 5 \times 116)$ 那此时 $4$ 倍 $36$ 只能分解为 $1\times 36$ 仍然不行。那就尝试 $-580 = - ( 4 \times 145), 36 = 1 \times 36$  此时成功。

>  这里是求解十字相乘法的技术细节需要掌握。按照质因子少先取，然后根据根的大小确定另一个的分解情况。

那么 我们得到：

$$
(t - 4)(36t + 145) = 0
$$

由于，要素投入应该为正，因此 取 $y^{1/3} = 4 \to \begin{cases} x = 256 \\ y=64\end{cases}$ 此为唯一驻点。

## 例题2

求函数 $f(x, y) = (y-x^2)(y-x^3)$ 的极值

> 充分条件判断不了就从定义去说明

求驻点：

$$
\begin{cases}
\frac{ \partial f }{ \partial y } = 2y - x^{2} - x^{3} \\
\frac{ \partial f }{ \partial x } = -2xy - 3x^{2}y + 5 x^{4}
\end{cases}
$$

化简得到：

$$
\begin{cases}
2y = x^{2} + x^{3} \\
x^{3}(x-1)(3x-2) = 0
\end{cases} \to \begin{cases}
 x = 0 \\
y =0
\end{cases}, \begin{cases}
x = \frac{2}{3} \\
y = \frac{10}{27}
\end{cases}, \begin{cases}
x = 1 \\
y = 1
\end{cases}
$$

三个驻点，其中点 $(0,0)$ 在求解方程组中会无意中丢失，务必小心。

进一步：

$$
\begin{cases}
A = \frac{ \partial ^{2}y }{ \partial x^{2} }  = -2y - 6xy + 20 x^{3} \\
B = \frac{ \partial ^{2}y }{ \partial x \partial y } = -2x -3x^{2} \\
C = \frac{ \partial ^{2}y }{ \partial y^{2} }  = 2
\end{cases}
$$

对于点 （0,0）来说， $AC - B^{2} = 0$ ，$f(0,0) = 0$ ，因此从定义出发考察$U(0,0)$ 邻域内的$f(x,y)- 0$ 的正负情况，取$y = 0 \to f(x,y) = x^{5}$, 显然当 $f(x,y)\begin{cases} > 0,x >0 \\ <0,x<0\end{cases}$ 因此不是极值点。

对于点 $\left( 1,1 \right)$ 来说 $AC - B^{2} = -1$ 因此不是极值点。

对于点 $\left( \frac{2}{3}, \frac{10}{27} \right)$ 来说，$AC-B^{2} = \frac{8}{27}>0,A = \frac{100}{27} > 0$ 因此为极小值点。

故综上，$f(x,y)$ 有极小值，$- \frac{4}{729}$

## 例题3

已知函数$f(x,y)$在点(0,0)的某个邻域内连续,且 $\lim_{x \to 0， y\to 0} \frac{f(x,y)-xy}{(x^2+y^2)^2} = 1$, 说明 点（0,0）是否是极值点。

只能回到定义说明，即邻域内 $f(x,y) - f(0,0)$ 的正负情况。首先有极限存在得到 $\lim_{ x \to 0,y \to 0 }f(x,y) = 0 = f(0,0)$

当 $x,y > 0, x,y <0$  有极限的保号性得到 $f(x,y) - xy > 0 \to f(x,y) > 0$

只剩下二四象限了，由于 $xy$ 是负的，此时 保号性，$f(x,y) - xy > 0$  需要进一步渐近分析，


事实上 $U(0,0)$ 中 ，我们有

$$
f(x,y) = xy + o( (x^{2}+ y^{2})^{2}) = xy \left(  1 + \frac{o((x^{2}+y^{2})^{2})}{xy}  \right) = xy ( 1 + o(1))
$$

因此，$f(x,y)$ 的符号就取决于 $xy$。

# 条件极值问题

> [!attention] 关键点
> - 拉格朗日
> 	- 非封闭边界曲线的端点
> 	- 除非负因子消 $\lambda$
> 	- 多元方程组的消解要熟练
> 	- 目标函数的转换（转化为通解目标函数）
> - 柯西不等式
> 	- $\frac{x_1^2}{a_1} + \frac{x_2^2}{a_2} + \cdots + \frac{x_n^2}{a_n} \geq \frac{(x_1 + x_2 + \cdots + x_n)^2}{a_1 + a_2 + \cdots + a_n}$
> - 平均值不等式
> 	- $\sqrt{\frac{\sum x_i^2}{n}} \ge \frac{\sum x_i}{n} \ge \sqrt[n]{\prod x_i} \ge \frac{n}{\sum \frac{1}{x_i}}$

## 例题1

将长为 $2$ m 的铁丝分成三段, 依次围成圆, 正方形与正三角形, 三个图形的面积之和是否存在最小值？若存在, 求出最小值。

> 一般而言，变量是斜体的 $m$ 正体的 m 表示 米。

$$
L(x,y,z,\lambda) \triangleq \frac{1}{4\pi} x^{2} + \frac{1}{16} y^{2} + \frac{\sqrt{ 3 }}{36} z^{2} + \lambda(x+y+z- 2)
$$

求导得到

$$
\begin{cases}
\frac{\partial L}{\partial x} = \frac{2x}{4\pi} + \lambda = \frac{x}{2\pi} + \lambda = 0 \Rightarrow x = -2\pi \lambda
\\
\frac{\partial L}{\partial y} = \frac{2y}{16} + \lambda = \frac{y}{8} + \lambda = 0 \Rightarrow y = -8\lambda
\\
\frac{\partial L}{\partial z} = \frac{2z\sqrt{3}}{36} + \lambda = \frac{\sqrt{3}}{18}z + \lambda = 0 \Rightarrow z = -\frac{18}{\sqrt{3}}\lambda = -6\sqrt{3}\lambda \\
\frac{ \partial L }{ \partial \lambda } = x+y+z - 2 = 0 
\end{cases}
$$

> 也可以保留 $\lambda$ 消去其余的，统一到一个变量计算面积等先化简在代入。

解得：

$$
\lambda_{0} = \frac{1}{4 + \pi + 3\sqrt{ 3 }}
$$

因此拉格朗日边界曲线上的极值为：

$$
f\left( -2\pi\lambda_{0},-8\pi\lambda_{0},-6\sqrt{ 3 }\lambda_{0} \right)  =  \frac{1}{\pi + 4 + \sqrt{ 3 }}
$$

求最值，还要考虑边界点，即

$$
L'_{x} \neq 0, L'_{y} \neq 0, L'_{z} \neq 0, xyz = 0 , x + y +z = 2
$$

只能分类讨论了。

当$x,y,,z$ 仅有一个为零，由于 $x = y =z$ 时， $\frac{1}{4\pi}x^{2} > \frac{1}{16}y^{2}> \frac{3\sqrt{ 3 }}{36}z^{2}$ 因此此时最小值为 $x = y = 0, z = 2$ 此时 $f(0,0,2) = \frac{\sqrt{ 3 }}{9}$

当 $x+ y =2$ 时 $f(x,y,0) = \frac{x^{2}}{4\pi}+\frac{y^{2}}{16} \ge \frac{(x+y)^{2}}{4\pi + 16} = \frac{1}{\pi+4}$

当 $x+ z =2$ 时 $f(x,0,z) = \frac{x^{2}}{4\pi}+\frac{z^{2}}{12\sqrt{ 3 }} \ge \frac{(x+z)^{2}}{4\pi + 12\sqrt{ 3 }} = \frac{1}{\pi+3\sqrt{ 3 }}$

当 $y+ z =2$ 时 $f(0,y,z) = \frac{6^{2}}{16}+\frac{z^{2}}{12\sqrt{ 3 }} \ge \frac{(y+z)^{2}}{16 + 12\sqrt{ 3 }} = \frac{1}{4+3\sqrt{ 3 }}$

因此最小值为：

$$
\min \left\{  \frac{1}{\pi + 4 + \sqrt{ 3 }}, \frac{1}{\pi + 4}, \frac{1}{\pi + 3\sqrt{ 3 }}, \frac{1}{4 + 3 \sqrt{ 3 }}, \frac{\sqrt{ 3 }}{9}  \right\}  = \frac{1}{\pi + 4 + \sqrt{ 3 }}
$$

## 例题2

求函数 $u=x^2+y^2+z^2$ 在约束条件 $x^2+y^2$ 和 $x+y+z=4$ 下的最大值与最小值。

> 两个约束函数，设两个未知变量

$$
L \triangleq x^{2} + y^{2} + z^{2} + \lambda(x^{2}+ y^{2}) + \mu(x+y+z - 4)
$$

$$
\begin{align}
L'_{x}  & = 2x - 2x\lambda + \mu = 0 \tag{1} \\
L'_{y}  & = 2y - 2y\lambda + \mu = 0 \tag{2}\\
L'_{z}  & = 2z + \lambda + \mu = 0 \\
L'_{\lambda}  & = z - x^2 - y^2 = 0 \tag{3}\\
L'_{\mu}  & = x + y + z - 4 = 0 \tag{4}\\
\end{align}
$$

> 能不除就不除

由 （1），（2）得， $x = y$ 代入 （3），（4）中得到：

$$
\begin{cases}
z - 2y^{2} = 0 \\
2y + z = 4
\end{cases}
$$

## 例题3

求曲线 $x^3-xy+y^3=1(x\geq0, y\geq0)$上的点到坐标原点的最长距离与最短距离。

> 这一题几乎涵盖了所有的易错点，和关键点

首先是同解方程的转换，原问题的目标函数是 $\sqrt{ x^{2}+y^{2} }$ ，他的最大值点和最小值点和 $x^{2}+y^{2}$ 是相同的。因此我们首先构造函数求出最值点，在代入原先函数当中求出值

$$
L \triangleq x^{2} + y^{2} + \lambda(x^{3}-xy -y^{3}-1)
$$

则有：

$$
\begin{cases}
L'_{x} = 2x + (3x^{2} - y)  \lambda  = 0\\
L'_{y} = 2y + (3y^{2} - x) \lambda  = 0\\
L'_{\lambda} = x^{3} - xy + y^{3} - 1 = 0 
\end{cases}
$$

如果 $3x^{2} - y = 0$  则有 $x = y = 0$ 和约束条件矛盾，因此 $3x^{2} - y \neq 0$ 同理 $3y^{2} - x \neq 0$

进而由一二式得到：

$$
\frac{2x}{3x^{2} - y } =  \frac{2y}{3y^{2} - x} \to 6xy^{2} - 2x^{2} = 6x^{2}y - 2y^{2}
$$

> 因式分解是重要的技术性细节

因式分解得到：

$$
(x-y)( 2x + 2y + 6xy) = 0
$$

其中 $2x + 2y + 6xy = 0$ 舍去。因此得到 $x = y$ 

>[!tips] 画出图像能够简化运算
> ```tikz
> \begin{document}
> \begin{tikzpicture}[scale=2.5]
>     % 1. 绘制坐标轴和网格
>     \draw[gray!50, thin, step=0.5] (0,0) grid (1.5, 1.5);
>     \draw[->, thick] (-0.2,0) -- (1.6,0) node[right] {$x$};
>     \draw[->, thick] (0,-0.2) -- (0,1.6) node[above] {$y$};
>     \node[below left] at (0,0) {0};
>     \node[below] at (1,0) {1};
>     \node[left] at (0,1) {1};
>     
>     % 2. 标记我们知道的三个精确点
>     \coordinate (p1) at (1,0);
>     \coordinate (p2) at (1,1);
>     \coordinate (p3) at (0,1);
> 
>     % 3. 使用贝塞尔曲线分两段绘制
>     % 这是通过手动调整 "controls" 点的位置来模拟曲线的形状
>     % 第一段：从 (1,0) 经过曲线下方到达 (0,1)
>     
>     % 第二段：从 (0,1) 经过曲线上方到达 (1,1) 再回到 (1,0)
>     % 为了形成一个闭环，我们将它画成两部分
>     \draw[black, thick] (p3) .. controls (0.2, 1.1) and (0.9, 1.1) .. (p2);
>     \draw[black, thick] (p2) .. controls (1.1, 0.9) .. (p1);
> 
>     % 4. 标记关键点
>     \filldraw[red] (p1) circle (1.5pt) node[below right] {$(1,0)$};
>     \filldraw[red] (p2) circle (1.5pt) node[above right] {$(1,1)$};
>     \filldraw[red] (p3) circle (1.5pt) node[above left] {$(0,1)$};
> \end{tikzpicture}
> \end{document}
> ```

$x = y$ 和 边界曲线只有一个交点 $(1,1)$

代入 FOCs 的第三个式子中得到：

$$
2x^{3} - x^{2} -1 = 0 
$$

首先尝试出 $x = 1$ 是根，因此长除法得到因式分解为：$(x-1)(2x^{2}+x+1) = 0$ 唯一实根为 $x = 1$ 因此边界曲线极值点为 $(1,1)$

由于边界曲线并不封闭，需要考虑端点，也就是$(0,1),(1,0)$ 。让我们直接代入会原目标函数 $\sqrt{ x^{2} + y^{2} }$ 

得到最大值为 $\sqrt{ 2 }$ 最小值为 $1$