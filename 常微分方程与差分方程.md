---
tags:
  - cheatsheet
  - 高数
  - 考研
  - math
---
> [!abstract] 微分方程
> - 重要的基础是对于各种类型的微分方程求解方式的掌握。并且类推到差分方程。
> - 进一步，不要忽略了对于微分方程应用的考察，要善于通过微元刻画动态过程。
> - 一些技术细节
> 	- 变量替换
> 	- 反函数
> 	- 分项

# 一阶微分方程

## 可分离变量

对于可以化简为：

$$
g(y) dy = f(x) dx
$$

我们直接两边对 $x$ 积分得到：

$$
\int g(y) dy = \int f(x) dx
$$

### $y' = f(ax + by + c)$

求 微分方程 $y' = \cos(x+y)$的通解

令 $u = x+ y \to \frac{du}{dx} = 1 + \frac{dy}{dx} = 1 + cosu$ 因此变形得到：

$$
\frac{du}{dx} = 1 + \cos u \to \int \frac{1}{1+\cos u} du = \int dx
$$

对于 $\int \frac{1}{1+ \cos u}du$ 三角代换或者三角恒等变换都可以： $1 + \cos u = 2\cos ^{2} \frac{u}{2}$ 因此 结果为 $\tan \frac{u}{2} +c$

得到:

$$
\tan \frac{u}{2} +c = x \to y = 2\arctan(x+c)  - x
$$

那么对于 $y' = f(ax + by +c)$ 类型的题目，方法是一致的。

## 齐次方程

设 $f(x)$ 连续，称 $\frac{dy}{dx} = f\left( \frac{y}{x} \right)$ 为齐次方程

此时，令 $y = u$，则 $y = xu$，得 $\frac{dy}{dx} = u + x\frac{du}{dx} = f(u)$，$\frac{du}{f(u)-u} = \frac{dx}{x}$

积分得到： $\int \frac{du}{f(u)-u} = \int \frac{dx}{x}$， 得到可分变量的微分方程。此时，积分后将 $u$ 转化为 $\frac{y}{x}$，即可得到$y= f(x)$ 的通解。

## 一阶线性微分方程

设 $P(x),Q(x)$ 连续，称 $y' + P(x)y = Q(x)$ 为一阶线性微分方程

特别的，当 $Q(x) \equiv 0$ ，称为一阶线性齐次方程

注意到 $y' + P(x)y$ 是 $e^{g(x)}y$ 求导的结构，其中 $g(x) = \int P(x)dx$ 。因此，我们有：

$$
\begin{align}
\left[ e^{\int P(x)dx} y \right]' = e^{\int P(x)dx} Q(x)  \\
e^{\int P(x)dx}y = \int e^{\int P(x)dx} Q(x) dx + C \tag{1}\\
y = e^{-\int P(x)dx} \left[ \int e^{\int P(x)dx} Q(x) dx  +C \right] 
\end{align}
$$

特别的，当 $Q(x) \equiv 0, y = Ce^{-\int P(x)dx}$

> 记忆上可以记(1)

### 反函数

微分方程 $ydx + (x-3y^{2})dy = 0$ 且初始条件 $y(0) = 1$ 求解 $y =$ 。

变形得到:

$$
\frac{dx}{dy} + \frac{1}{y} x = 3y \to x' + \frac{1}{y} x = 3y
$$

因此：

$$
x = e^{-\int 1/ydy} \int e^{\int 1/y dy} 3y +c dy  = \frac{1}{y}\left[\int 3y^{2}dy + c   \right]  = \frac{1}{y} ( y^{3} + c)
$$
# 高阶微分方程


## 线性微分方程概念

> 可以类比线性代数的方程解的性质与结构

### 解的性质

- 若 $y_{1},y_{2}$ 为齐次方程的解，则 $C_{1}y_{1}+C_{2}y_{2}$ 也是方程的解。
- $y$ 为 齐次方程的解，$y^{\star}$ 为非齐次方程的解，则 $y+y^{\star}$ 是非齐次方程的解
- 若$y_{1}^{\star},y_{2}^{\star}$ 为非齐次方程的解，则$y_{1}^{\star}-y_{2}^{\star}$ 是齐次方程的解
	- 对于 $C_{1}y_{1}^{\star}+C_{2}y_{2}^{\star}$ 来说
		- $C_{1} + C_{2} = 0$ 时为齐次方程的解
		- $C_{1} + C_{2} = 1$ 是为非齐次方程的解

### 解的结构

> 以二阶为例

$$
y'' + y'P(x) + Q(x) = f(x)
$$

- 若$y_{1},y_{2}$ 为齐次方程两个线性无关的特解，则齐次方程的通解为 $C_{1}y_{1} + C_{2}y_{2}$
-  此时我们得到 $y^{\star}$ 为对应的非齐次方程的特解，那么对应的非齐次方程的通解为$C_{1}y_{1}+C_{2}y_{2} + y^{\star}$

进一步的，对于求解非齐次方程，我们可能需要分项求解（和积分一致），与其等到积分运算时在分项，我们有：

若$y_1, y_2$分别为$y'' + p(x)y' + q(x)y = f_{1}(x)$,$y'' + p(x)y' + q(x)y = f_{2}(x)$的特解。则$y_1 + y_2$为$y'' + p(x)y' + q(x)y = f_{1}(x) + f_{2}(x)$的特解。

## 二阶常系数线性

形为 $y'' + py' + qy =0$ 的齐次微分方程的求解过程为：

- 解特征方程 $r^{2} + pr  + q = 0$ 得到 特征根 $r_{1},r_{2}$
	- 互异实根：通解为 $y =c_{1} e^{r_{1}x} + c_{2} e^{r_{2}x}$
	- 二重实根：通解为 $y = (c_{1}+c_{2}x)e^{rx}$
	- 共轭复根：$r_{1,2} = \alpha \pm \beta i$ 则通解为：$e^{\alpha x}(c_{1}\cos\beta x+c_{2}\sin\beta x)$

可能会有逆向给出通解，写出微分方程的问题。只要先得到特征方程的根然后转写到特征方程形式即可。

进一步的，考虑关于$y'' + py' + q = f(x)$ 的非齐次方程，根据解得结构，我们只需要得到其特解即可，考研考察两类，我们作如下的待定：

- $f(x) = P_{n}(x)e^{\lambda x}$ 设特解为 $y^{\star} = x^{k} Q_{n}(x)e^{\lambda x}$ 其中 $k$ 表示 $\lambda$ 为特征方程根的个数。
- $f(x) = e^{\alpha x}(P_{m}(x)\cos\beta x + P_{n}(x)\sin \beta x)$ 则设特解为 $y^{\star} = x^{k}e^{\alpha x}\left[ Q_{l}(x)\cos\beta x + R_{l}(x)\sin \beta x \right]$ 其中 $l = max\{ m,n \}$ 
	- $k =  \begin{cases} 1, \alpha,\beta 是对应的共轭复根   \\ 0, not\end{cases}$

此时通常会遇到 $f(x)$ 是 两种 类型都有，我们将拆分为两个独立的微分方程求解，最后根据解的性质得到整体的特解。比如：

微分方程 $y'' + y = x^{2}+1 + \sin x$ 

特征方程为 $r^{2} + 1 = 0$  根为 $\pm i$

$x^{2} + 1$ 对应的特解为 $y^{\star}_{1} = e^{0x}x^{0}(ax^{2}+ bx + c)$
$\sin x$ 对应的特解为 $y_{2}^{\star} = e^{0x} x^{1} \left[ A\cos x + B \sin x \right]$

## 高阶常系数线性齐次微分方程

【方法】$y^{(n)} + p_{n-1}y^{(n-1)} + \cdots + p_1y' + p_0y = 0 (n \geq 3)$.

解特征方程$r^n + p_{n-1}r^{n-1} + \cdots + p_1r + p_0 = 0$，得特征根为$r_1, r_2, \cdots, r_n$.

(1) 若$r$为单根，则方程的通解的对应项为$Ce^{rx}$;

(2) 若$r$为$k$重实根，则方程的通解的对应项为$(C_1 + C_2x + \cdots + C_kx^{k-1})e^{rx}$;

(3) 若$\alpha \pm \beta i$为共轭复根，则方程的通解的对应项为$e^{\alpha x}(C_1 \cos \beta x + C_2 \sin \beta x)$;

(4) 若$\alpha \pm \beta i$为$k$重共轭复根，则方程的通解的对应项为

$e^{\alpha x}[(C_1 + C_2x + \cdots + C_kx^{k-1})\cos \beta x + (D_1 + D_2x + \cdots + D_kx^{k-1})\sin \beta x]$.

# 差分方程

## 一阶差分

对于一阶差分方程即

$$
y_{x+1} - ay_{x} = P_{n}(x)b^{x}
$$

> 注意$a$ 前面的符号，这影响判断 $k$ 。这里的负号是为了自然表达差分之意$\Delta y = y_{x+1} - y_{x}$，同时也很好的说明了齐次通解。

首先考察其对应的齐次方程 $y_{x+1} - ay_{x} = 0$ ，得到通解 $y_{x} = Ca^{x}$

进一步，待定其特解为 $y^{\star} = x^{k}b^{x}Q_{n}(x)$ 其中 $k = \begin{cases} 0 & a\neq b \\ 1 & a=b\end{cases}$ 然后代入原式，求解系数。

故而，得到一阶差分方程的通解为 $Ca^{x} + y^{\star}$



